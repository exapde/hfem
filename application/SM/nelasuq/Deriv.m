function [P,dPdF] = Deriv(F11,F12,F21,F22,mu,kappa,wcase)
% See symb.m for the models

detF = (F11.*F22 - F12.*F21);

switch (wcase)
    case 1

    P = [F11.*mu - F22.*kappa.*(F12.*F21 - F11.*F22 + 1) - (F22.*mu)./(detF),...
         F12.*mu + F21.*kappa.*(F12.*F21 - F11.*F22 + 1) + (F21.*mu)./(detF),...
         F21.*mu + F12.*kappa.*(F12.*F21 - F11.*F22 + 1) + (F12.*mu)./(detF),...
         F22.*mu - F11.*kappa.*(F12.*F21 - F11.*F22 + 1) - (F11.*mu)./(detF)];

    dPdF = [                                                 mu + F22.^2.*kappa + (F22.^2.*mu)./(detF).^2,... 
                                                            - F21.*F22.*kappa - (F21.*F22.*mu)./(detF).^2,...
                                                            - F21.*F22.*kappa - (F21.*F22.*mu)./(detF).^2,...
                                                             mu + F21.^2.*kappa + (F21.^2.*mu)./(detF).^2,...
                                                            - F12.*F22.*kappa - (F12.*F22.*mu)./(detF).^2,...
     kappa.*(F12.*F21 - F11.*F22 + 1) + mu./(detF) + F12.*F21.*kappa + (F12.*F21.*mu)./(detF).^2,...
     F11.*F22.*kappa - mu./(detF) - kappa.*(F12.*F21 - F11.*F22 + 1) + (F11.*F22.*mu)./(detF).^2,...
                                                            - F11.*F21.*kappa - (F11.*F21.*mu)./(detF).^2,...
                                                            - F12.*F22.*kappa - (F12.*F22.*mu)./(detF).^2,...
     F11.*F22.*kappa - mu./(detF) - kappa.*(F12.*F21 - F11.*F22 + 1) + (F11.*F22.*mu)./(detF).^2,...
     kappa.*(F12.*F21 - F11.*F22 + 1) + mu./(detF) + F12.*F21.*kappa + (F12.*F21.*mu)./(detF).^2,...
                                                            - F11.*F21.*kappa - (F11.*F21.*mu)./(detF).^2,...
                                                             mu + F12.^2.*kappa + (F12.^2.*mu)./(detF).^2,...
                                                            - F11.*F12.*kappa - (F11.*F12.*mu)./(detF).^2,...
                                                            - F11.*F12.*kappa - (F11.*F12.*mu)./(detF).^2,...
                                                             mu + F11.^2.*kappa + (F11.^2.*mu)./(detF).^2];
                                                                                                          
    case 2
        
    P = [F11.*mu - (F22.*mu)./(detF) + (F22.*kappa.*log(detF))./(detF),...
         F12.*mu + (F21.*mu)./(detF) - (F21.*kappa.*log(detF))./(detF),...
         F21.*mu + (F12.*mu)./(detF) - (F12.*kappa.*log(detF))./(detF),...
         F22.*mu - (F11.*mu)./(detF) + (F11.*kappa.*log(detF))./(detF)];


    dPdF = [mu + (F22.^2.*kappa + F22.^2.*mu - F22.^2.*kappa.*log(detF))./(detF).^2,...
                 -(F21.*F22.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
                 -(F21.*F22.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
     mu + (F21.^2.*kappa + F21.^2.*mu - F21.^2.*kappa.*log(detF))./(detF).^2,...
                 -(F12.*F22.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
          (F11.*F22.*(mu - kappa.*log(detF)) + F12.*F21.*kappa)./(detF).^2,...
          (F12.*F21.*(mu - kappa.*log(detF)) + F11.*F22.*kappa)./(detF).^2,...
                 -(F11.*F21.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
                 -(F12.*F22.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
          (F12.*F21.*(mu - kappa.*log(detF)) + F11.*F22.*kappa)./(detF).^2,...
          (F11.*F22.*(mu - kappa.*log(detF)) + F12.*F21.*kappa)./(detF).^2,...
                 -(F11.*F21.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
     mu + (F12.^2.*kappa + F12.^2.*mu - F12.^2.*kappa.*log(detF))./(detF).^2,...
                 -(F11.*F12.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
                 -(F11.*F12.*(kappa + mu - kappa.*log(detF)))./(detF).^2,...
     mu + (F11.^2.*kappa + F11.^2.*mu - F11.^2.*kappa.*log(detF))./(detF).^2];

    case 3

    P =  [(mu.*((2.*F11)./(detF).^(2./3) - (2.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 - F22.*kappa.*(F12.*F21 - F11.*F22 + 1),...
          (mu.*((2.*F12)./(detF).^(2./3) + (2.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 + F21.*kappa.*(F12.*F21 - F11.*F22 + 1),...
          (mu.*((2.*F21)./(detF).^(2./3) + (2.*F12.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 + F12.*kappa.*(F12.*F21 - F11.*F22 + 1),...
          (mu.*((2.*F22)./(detF).^(2./3) - (2.*F11.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 - F11.*kappa.*(F12.*F21 - F11.*F22 + 1)];


    dPdF = [(5.*F22.^2.*mu + 5.*F22.^4.*mu + 9.*F22.^2.*kappa.*(detF).^(8./3) + 2.*F11.^2.*F22.^2.*mu + 9.*F12.^2.*F21.^2.*mu + 5.*F12.^2.*F22.^2.*mu + 5.*F21.^2.*F22.^2.*mu - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3)),...
                                                                                                       - (mu.*((4.*F12.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F21)./(3.*(detF).^(5./3)) + (10.*F21.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F21.*F22.*kappa,...
                                                                                                       - (mu.*((4.*F12.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F21)./(3.*(detF).^(5./3)) + (10.*F21.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F21.*F22.*kappa,...
                                                                                                    (5.*F21.^2.*mu + 5.*F21.^4.*mu + 9.*F21.^2.*kappa.*(detF).^(8./3) + 5.*F11.^2.*F21.^2.*mu + 9.*F11.^2.*F22.^2.*mu + 2.*F12.^2.*F21.^2.*mu + 5.*F21.^2.*F22.^2.*mu - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3)),...
                                                                                                       - (mu.*((4.*F21.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F12)./(3.*(detF).^(5./3)) + (10.*F12.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F12.*F22.*kappa,...
     kappa.*(F12.*F21 - F11.*F22 + 1) + (mu.*((4.*F12.^2)./(3.*(detF).^(5./3)) + (4.*F21.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) + (10.*F12.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 + F12.*F21.*kappa,...
     F11.*F22.*kappa - (mu.*((4.*F11.^2)./(3.*(detF).^(5./3)) + (4.*F22.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) - (10.*F11.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - kappa.*(F12.*F21 - F11.*F22 + 1),...
                                                                                                       - (mu.*((4.*F11.*F12)./(3.*(detF).^(5./3)) - (4.*F21.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F11.*F21.*kappa,...
                                                                                                       - (mu.*((4.*F21.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F12)./(3.*(detF).^(5./3)) + (10.*F12.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F12.*F22.*kappa,...
     F11.*F22.*kappa - (mu.*((4.*F11.^2)./(3.*(detF).^(5./3)) + (4.*F22.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) - (10.*F11.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - kappa.*(F12.*F21 - F11.*F22 + 1),...
     kappa.*(F12.*F21 - F11.*F22 + 1) + (mu.*((4.*F12.^2)./(3.*(detF).^(5./3)) + (4.*F21.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) + (10.*F12.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 + F12.*F21.*kappa,...
                                                                                                       - (mu.*((4.*F11.*F12)./(3.*(detF).^(5./3)) - (4.*F21.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F11.*F21.*kappa,...
                                                                                                    (5.*F12.^2.*mu + 5.*F12.^4.*mu + 9.*F12.^2.*kappa.*(detF).^(8./3) + 5.*F11.^2.*F12.^2.*mu + 9.*F11.^2.*F22.^2.*mu + 2.*F12.^2.*F21.^2.*mu + 5.*F12.^2.*F22.^2.*mu - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3)),...
                                                                                                       - (mu.*((4.*F11.*F21)./(3.*(detF).^(5./3)) - (4.*F12.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F12.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F11.*F12.*kappa,...
                                                                                                       - (mu.*((4.*F11.*F21)./(3.*(detF).^(5./3)) - (4.*F12.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F12.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - F11.*F12.*kappa,...
                                                                                                    (5.*F11.^2.*mu + 5.*F11.^4.*mu + 9.*F11.^2.*kappa.*(detF).^(8./3) + 5.*F11.^2.*F12.^2.*mu + 5.*F11.^2.*F21.^2.*mu + 2.*F11.^2.*F22.^2.*mu + 9.*F12.^2.*F21.^2.*mu - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3))];

        
    case 4


    P = [(mu.*((2.*F11)./(detF).^(2./3) - (2.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 + (F22.*kappa.*log(detF))./(detF),...
         (mu.*((2.*F12)./(detF).^(2./3) + (2.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 - (F21.*kappa.*log(detF))./(detF),...
         (mu.*((2.*F21)./(detF).^(2./3) + (2.*F12.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 - (F12.*kappa.*log(detF))./(detF),...
         (mu.*((2.*F22)./(detF).^(2./3) - (2.*F11.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3))))./2 + (F11.*kappa.*log(detF))./(detF)];


    dPdF = [(5.*F22.^2.*mu + 5.*F22.^4.*mu + 9.*F22.^2.*kappa.*(detF).^(2./3) + 2.*F11.^2.*F22.^2.*mu + 9.*F12.^2.*F21.^2.*mu + 5.*F12.^2.*F22.^2.*mu + 5.*F21.^2.*F22.^2.*mu - 9.*F22.^2.*kappa.*log(detF).*(detF).^(2./3) - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3)),...
                                                                                                                              (F21.*F22.*kappa.*log(detF))./(detF).^2 - (F21.*F22.*kappa)./(detF).^2 - (mu.*((4.*F12.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F21)./(3.*(detF).^(5./3)) + (10.*F21.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
                                                                                                                              (F21.*F22.*kappa.*log(detF))./(detF).^2 - (F21.*F22.*kappa)./(detF).^2 - (mu.*((4.*F12.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F21)./(3.*(detF).^(5./3)) + (10.*F21.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
                                                                                                                                               (5.*F21.^2.*mu + 5.*F21.^4.*mu + 9.*F21.^2.*kappa.*(detF).^(2./3) + 5.*F11.^2.*F21.^2.*mu + 9.*F11.^2.*F22.^2.*mu + 2.*F12.^2.*F21.^2.*mu + 5.*F21.^2.*F22.^2.*mu - 9.*F21.^2.*kappa.*log(detF).*(detF).^(2./3) - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3)),...
                                                                                                                              (F12.*F22.*kappa.*log(detF))./(detF).^2 - (F12.*F22.*kappa)./(detF).^2 - (mu.*((4.*F21.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F12)./(3.*(detF).^(5./3)) + (10.*F12.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
     (mu.*((4.*F12.^2)./(3.*(detF).^(5./3)) + (4.*F21.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) + (10.*F12.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - (kappa.*log(detF))./(detF) + (F12.*F21.*kappa)./(detF).^2 - (F12.*F21.*kappa.*log(detF))./(detF).^2,...
     (kappa.*log(detF))./(detF) - (mu.*((4.*F11.^2)./(3.*(detF).^(5./3)) + (4.*F22.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) - (10.*F11.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 + (F11.*F22.*kappa)./(detF).^2 - (F11.*F22.*kappa.*log(detF))./(detF).^2,...
                                                                                                                              (F11.*F21.*kappa.*log(detF))./(detF).^2 - (F11.*F21.*kappa)./(detF).^2 - (mu.*((4.*F11.*F12)./(3.*(detF).^(5./3)) - (4.*F21.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
                                                                                                                              (F12.*F22.*kappa.*log(detF))./(detF).^2 - (F12.*F22.*kappa)./(detF).^2 - (mu.*((4.*F21.*F22)./(3.*(detF).^(5./3)) - (4.*F11.*F12)./(3.*(detF).^(5./3)) + (10.*F12.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
     (kappa.*log(detF))./(detF) - (mu.*((4.*F11.^2)./(3.*(detF).^(5./3)) + (4.*F22.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) - (10.*F11.*F22.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 + (F11.*F22.*kappa)./(detF).^2 - (F11.*F22.*kappa.*log(detF))./(detF).^2,...
     (mu.*((4.*F12.^2)./(3.*(detF).^(5./3)) + (4.*F21.^2)./(3.*(detF).^(5./3)) + (2.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(3.*(detF).^(5./3)) + (10.*F12.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2 - (kappa.*log(detF))./(detF) + (F12.*F21.*kappa)./(detF).^2 - (F12.*F21.*kappa.*log(detF))./(detF).^2,...
                                                                                                                              (F11.*F21.*kappa.*log(detF))./(detF).^2 - (F11.*F21.*kappa)./(detF).^2 - (mu.*((4.*F11.*F12)./(3.*(detF).^(5./3)) - (4.*F21.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F21.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
                                                                                                                                               (5.*F12.^2.*mu + 5.*F12.^4.*mu + 9.*F12.^2.*kappa.*(detF).^(2./3) + 5.*F11.^2.*F12.^2.*mu + 9.*F11.^2.*F22.^2.*mu + 2.*F12.^2.*F21.^2.*mu + 5.*F12.^2.*F22.^2.*mu - 9.*F12.^2.*kappa.*log(detF).*(detF).^(2./3) - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3)),...
                                                                                                                              (F11.*F12.*kappa.*log(detF))./(detF).^2 - (F11.*F12.*kappa)./(detF).^2 - (mu.*((4.*F11.*F21)./(3.*(detF).^(5./3)) - (4.*F12.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F12.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
                                                                                                                              (F11.*F12.*kappa.*log(detF))./(detF).^2 - (F11.*F12.*kappa)./(detF).^2 - (mu.*((4.*F11.*F21)./(3.*(detF).^(5./3)) - (4.*F12.*F22)./(3.*(detF).^(5./3)) + (10.*F11.*F12.*(F11.^2 + F12.^2 + F21.^2 + F22.^2 + 1))./(9.*(detF).^(8./3))))./2,...
                                                                                                                                               (5.*F11.^2.*mu + 5.*F11.^4.*mu + 9.*F11.^2.*kappa.*(detF).^(2./3) + 5.*F11.^2.*F12.^2.*mu + 5.*F11.^2.*F21.^2.*mu + 2.*F11.^2.*F22.^2.*mu + 9.*F12.^2.*F21.^2.*mu - 9.*F11.^2.*kappa.*log(detF).*(detF).^(2./3) - 6.*F11.*F12.*F21.*F22.*mu)./(9.*(detF).^(8./3))];

        
    otherwise
        error('Not a valid model');
end

 