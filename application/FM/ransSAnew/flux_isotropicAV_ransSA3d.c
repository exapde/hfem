
// Written by: C. Nguyen & P. Fernandez

void flux_isotropicAV_ransSA3d(double *f, double *f_udg, double *pg, double *udg, appstruct &app, double *param,
                               double time, int ng, int nc, int ncu, int nd, int ncd, int computeJacobian)
{
	double r, ru, rv, rw, rE, rx, ry, rz, rux, rvy, rwz, u, v, w, ux, vy, wz, p, H, rH, h;
	double p_reg, D_p_reg_D_p, r_reg, H_reg, D_H_reg_D_H, D_r_reg_D_r, trash;
	double c_cr, x, ff, D_ff_D_x;

	double param1 = param[0];
	double param2 = param[1];
	double param3 = param[2];
	double param4 = param[3];
	double param5 = param[4];
	double param6 = param[5];

    double alpha = 1.0e4;
    double beta = 1.0e-2;
    double k_h = 1.5;
    double eps_v = 1.0e-8;
    double rRegMin = 1.0e-2;
    double pRegMin = 1.0e-3;
    double HregMin = 1.0e-2;
	double rampFactor = app.rampFactor;
    int porder = app.porder[0];

    for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double x3 = pg[2*ng+i];

		h = pg[3*ng+i];
		error("Need to determine the initial index of element size (h)\n");

		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];
		double u10 = udg[9*ng+i];
		double u11 = udg[10*ng+i];
		double u12 = udg[11*ng+i];
		double u13 = udg[12*ng+i];
		double u14 = udg[13*ng+i];
		double u15 = udg[14*ng+i];
		double u16 = udg[15*ng+i];
		double u17 = udg[16*ng+i];
		double u18 = udg[17*ng+i];
		double u19 = udg[18*ng+i];
		double u20 = udg[19*ng+i];
		double u21 = udg[20*ng+i];
		double u22 = udg[21*ng+i];
		double u23 = udg[22*ng+i];
		double u24 = udg[23*ng+i];

		r = u1;
        ru = u2;
        rv = u3;
        rw = u4;
        rE = u5;
        rx = u7;
        rux = u8;
        ry = u13;
        rvy = u15;
        rz = u19;
        rwz = u22;

        u = ru/r;
        v = rv/r;
        w = rw/r;
        p = (param1-1)*(rE-r*(u*u+v*v+w*w+eps_v*eps_v)/2);
        surrogateMaximum(&p_reg, &trash, &D_p_reg_D_p, pRegMin, p, alpha);
        surrogateMaximum(&r_reg, &trash, &D_r_reg_D_r, rRegMin, r, alpha);

        ux = (rux - u*rx)/r;
        vy = (rvy - v*ry)/r;
        wz = (rwz - w*rz)/r;
        rH = rE + p;
        H = rH/r;
        surrogateMaximum(&H_reg, &trash, &D_H_reg_D_H, HregMin, H, alpha);

        c_cr = sqrt((2*(param1-1)*H_reg)/(param1+1));
        x = ((k_h*h/porder)*(ux+vy+wz))/c_cr;
        surrogateMaximum(&ff, &trash, &D_ff_D_x, 0, x-beta, alpha);

		double t2 = 1.0/(u1*u1);
		double t3 = 1.0/porder;
		double t4 = 1.0/r_reg;
		double t5 = p_reg*param1*t4;
		double t6 = sqrt(t5);
		double t7 = u2*u2;
		double t8 = t2*t7;
		double t9 = u3*u3;
		double t10 = t2*t9;
		double t11 = u4*u4;
		double t12 = t2*t11;
		double t13 = eps_v*eps_v;
		double t14 = t8+t10+t12+t13;
		double t15 = sqrt(t14);
		double t16 = t6+t15;
		double t17 = 1.0/u1;
		double t18 = param1*(1.0/2.0);
		double t19 = t18-1.0/2.0;

		f[0*ng+i] += ff*h*k_h*rampFactor*t3*t16*u7;
		f[1*ng+i] += ff*h*k_h*rampFactor*t3*t16*u8;
		f[2*ng+i] += ff*h*k_h*rampFactor*t3*t16*u9;
		f[3*ng+i] += ff*h*k_h*rampFactor*t3*t16*u10;
		f[4*ng+i] += -ff*h*k_h*rampFactor*t3*t16*(t19*(t14*u7+t17*u2*(u8-t17*u2*u7)*2.0+t17*u3*(u9-t17*u3*u7)*2.0+t17*u4*(u10-t17*u4*u7)*2.0)-param1*u11);
		f[5*ng+i] += ff*h*k_h*rampFactor*t3*t16*u12;
		f[6*ng+i] += ff*h*k_h*rampFactor*t3*t16*u13;
		f[7*ng+i] += ff*h*k_h*rampFactor*t3*t16*u14;
		f[8*ng+i] += ff*h*k_h*rampFactor*t3*t16*u15;
		f[9*ng+i] += ff*h*k_h*rampFactor*t3*t16*u16;
		f[10*ng+i] += -ff*h*k_h*rampFactor*t3*t16*(t19*(t14*u13+t17*u2*(u14-t17*u2*u13)*2.0+t17*u3*(u15-t17*u3*u13)*2.0+t17*u4*(u16-t17*u4*u13)*2.0)-param1*u17);
		f[11*ng+i] += ff*h*k_h*rampFactor*t3*t16*u18;
		f[12*ng+i] += ff*h*k_h*rampFactor*t3*t16*u19;
		f[13*ng+i] += ff*h*k_h*rampFactor*t3*t16*u20;
		f[14*ng+i] += ff*h*k_h*rampFactor*t3*t16*u21;
		f[15*ng+i] += ff*h*k_h*rampFactor*t3*t16*u22;
		f[16*ng+i] += -ff*h*k_h*rampFactor*t3*t16*(t19*(t14*u19+t17*u2*(u20-t17*u2*u19)*2.0+t17*u3*(u21-t17*u3*u19)*2.0+t17*u4*(u22-t17*u4*u19)*2.0)-param1*u23);
		f[17*ng+i] += ff*h*k_h*rampFactor*t3*t16*u24;
	}

	if (computeJacobian == 1) {

		for (int i = 0; i <ng; i++) {
			double x1 = pg[0*ng+i];
			double x2 = pg[1*ng+i];
			double x3 = pg[2*ng+i];

			h = pg[3*ng+i];
			error("Need to determine the initial index of element size (h)\n");

			double u1 = udg[0*ng+i];
			double u2 = udg[1*ng+i];
			double u3 = udg[2*ng+i];
			double u4 = udg[3*ng+i];
			double u5 = udg[4*ng+i];
			double u6 = udg[5*ng+i];
			double u7 = udg[6*ng+i];
			double u8 = udg[7*ng+i];
			double u9 = udg[8*ng+i];
			double u10 = udg[9*ng+i];
			double u11 = udg[10*ng+i];
			double u12 = udg[11*ng+i];
			double u13 = udg[12*ng+i];
			double u14 = udg[13*ng+i];
			double u15 = udg[14*ng+i];
			double u16 = udg[15*ng+i];
			double u17 = udg[16*ng+i];
			double u18 = udg[17*ng+i];
			double u19 = udg[18*ng+i];
			double u20 = udg[19*ng+i];
			double u21 = udg[20*ng+i];
			double u22 = udg[21*ng+i];
			double u23 = udg[22*ng+i];
			double u24 = udg[23*ng+i];

			r = u1;
            ru = u2;
            rv = u3;
            rw = u4;
            rE = u5;
            rx = u7;
            rux = u8;
            ry = u13;
            rvy = u15;
            rz = u19;
            rwz = u22;

            u = ru/r;
            v = rv/r;
            w = rw/r;
            p = (param1-1)*(rE-r*(u*u+v*v+w*w+eps_v*eps_v)/2);
            surrogateMaximum(&p_reg, &trash, &D_p_reg_D_p, pRegMin, p, alpha);
            surrogateMaximum(&r_reg, &trash, &D_r_reg_D_r, rRegMin, r, alpha);

            ux = (rux - u*rx)/r;
            vy = (rvy - v*ry)/r;
            wz = (rwz - w*rz)/r;
            rH = rE + p;
            H = rH/r;
            surrogateMaximum(&H_reg, &trash, &D_H_reg_D_H, HregMin, H, alpha);

            c_cr = sqrt((2*(param1-1)*H_reg)/(param1+1));
            x = ((k_h*h/porder)*(ux+vy+wz))/c_cr;
            surrogateMaximum(&ff, &trash, &D_ff_D_x, 0, x-beta, alpha);

            double t2 = 1.0/(u1*u1*u1);
            double t3 = u2*u2;
            double t4 = 1.0/(u1*u1);
            double t5 = u3*u3;
            double t6 = u4*u4;
            double t7 = 1.0/porder;
            double t8 = 1.0/u1;
            double t9 = param1*2.0;
            double t10 = t9-2.0;
            double t11 = t3*t4;
            double t12 = t4*t5;
            double t13 = t4*t6;
            double t14 = eps_v*eps_v;
            double t15 = t11+t12+t13+t14;
            double t16 = param1-1.0;
            double t17 = t2*t3*2.0;
            double t18 = t2*t5*2.0;
            double t19 = t2*t6*2.0;
            double t20 = t17+t18+t19;
            double t21 = param1+1.0;
            double t22 = 1.0/t21;
            double t23 = H_reg*t10*t22;
            double t37 = t8*u2*u7;
            double t24 = -t37+u8;
            double t39 = t8*u3*u13;
            double t25 = -t39+u15;
            double t41 = t8*u4*u19;
            double t26 = -t41+u22;
            double t27 = 1.0/r_reg;
            double t28 = p_reg*param1*t27;
            double t29 = 1.0/sqrt(t28);
            double t30 = t3*t4*(1.0/2.0);
            double t31 = t4*t5*(1.0/2.0);
            double t32 = t4*t6*(1.0/2.0);
            double t33 = t14*(1.0/2.0);
            double t49 = t20*u1*(1.0/2.0);
            double t34 = t30+t31+t32+t33-t49;
            double t35 = 1.0/sqrt(t15);
            double t36 = 1.0/sqrt(t23);
            double t38 = t4*t24;
            double t40 = t4*t25;
            double t42 = t4*t26;
            double t62 = t2*u2*u7;
            double t63 = t2*u3*u13;
            double t64 = t2*u4*u19;
            double t43 = t38+t40+t42-t62-t63-t64;
            double t44 = h*k_h*t7*t36*t43;
            double t65 = t15*u1*(1.0/2.0);
            double t45 = -t65+u5;
            double t46 = t16*t45;
            double t47 = t46+u5;
            double t48 = t4*t47;
            double t50 = t8*t16*t34;
            double t51 = t48+t50;
            double t52 = 1.0/pow(t23,3.0/2.0);
            double t53 = t8*t24;
            double t54 = t8*t25;
            double t55 = t8*t26;
            double t56 = t53+t54+t55;
            double t66 = D_H_reg_D_H*h*k_h*t7*t10*t22*t51*t52*t56*(1.0/2.0);
            double t57 = t44-t66;
            double t58 = sqrt(t28);
            double t59 = sqrt(t15);
            double t60 = t58+t59;
            double t61 = 1.0/(r_reg*r_reg);
            double t67 = param1*(1.0/2.0);
            double t68 = t67-1.0/2.0;
            double t74 = t8*u3*u7;
            double t69 = -t74+u9;
            double t76 = t8*u4*u7;
            double t70 = -t76+u10;
            double t71 = param1*u11;
            double t72 = t15*u7;
            double t73 = t8*t24*u2*2.0;
            double t75 = t8*t69*u3*2.0;
            double t77 = t8*t70*u4*2.0;
            double t78 = t72+t73+t75+t77;
            double t80 = t68*t78;
            double t79 = t71-t80;
            double t85 = t8*u2*u13;
            double t81 = -t85+u14;
            double t88 = t8*u4*u13;
            double t82 = -t88+u16;
            double t83 = param1*u17;
            double t84 = t15*u13;
            double t86 = t8*t81*u2*2.0;
            double t87 = t8*t25*u3*2.0;
            double t89 = t8*t82*u4*2.0;
            double t90 = t84+t86+t87+t89;
            double t92 = t68*t90;
            double t91 = t83-t92;
            double t97 = t8*u2*u19;
            double t93 = -t97+u20;
            double t99 = t8*u3*u19;
            double t94 = -t99+u21;
            double t95 = param1*u23;
            double t96 = t15*u19;
            double t98 = t8*t93*u2*2.0;
            double t100 = t8*t94*u3*2.0;
            double t101 = t8*t26*u4*2.0;
            double t102 = t96+t98+t100+t101;
            double t104 = t68*t102;
            double t103 = t95-t104;
            double t105 = h*k_h*t4*t7*t36*u7;
            double t107 = D_H_reg_D_H*h*k_h*t4*t7*t10*t16*t22*t52*t56*u2*(1.0/2.0);
            double t106 = t105-t107;
            double t108 = h*k_h*t4*t7*t36*u13;
            double t110 = D_H_reg_D_H*h*k_h*t4*t7*t10*t16*t22*t52*t56*u3*(1.0/2.0);
            double t109 = t108-t110;
            double t111 = h*k_h*t4*t7*t36*u19;
            double t113 = D_H_reg_D_H*h*k_h*t4*t7*t10*t16*t22*t52*t56*u4*(1.0/2.0);
            double t112 = t111-t113;
            double t114 = h*h;
            double t115 = k_h*k_h;
            double t116 = 1.0/(porder*porder);
            double t117 = ff*h*k_h*rampFactor*t7*t60;
            double t118 = t11+t12+t13-t14;
            double t119 = ff*h*k_h*rampFactor*t7*t60*t68*t118;
            double t120 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u7;
            double t121 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u8;
            double t122 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u9;
            double t123 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u10;
            double t124 = D_ff_D_x*rampFactor*t8*t36*t60*t79*t114*t115*t116;
            double t125 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u12;
            double t126 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u13;
            double t127 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u14;
            double t128 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u15;
            double t129 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u16;
            double t130 = D_ff_D_x*rampFactor*t8*t36*t60*t91*t114*t115*t116;
            double t131 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u18;
            double t132 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u19;
            double t133 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u20;
            double t134 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u21;
            double t135 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u22;
            double t136 = D_ff_D_x*rampFactor*t8*t36*t60*t103*t114*t115*t116;
            double t137 = D_ff_D_x*rampFactor*t8*t36*t60*t114*t115*t116*u24;
            double t138 = ff*h*k_h*param1*rampFactor*t7*t60;

            f_udg[0*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u7-ff*h*k_h*rampFactor*t7*t20*t35*u7*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u7*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u7*(1.0/2.0);
            f_udg[1*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u8-ff*h*k_h*rampFactor*t7*t20*t35*u8*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u8*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u8*(1.0/2.0);
            f_udg[2*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u9-ff*h*k_h*rampFactor*t7*t20*t35*u9*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u9*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u9*(1.0/2.0);
            f_udg[3*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u10-ff*h*k_h*rampFactor*t7*t20*t35*u10*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u10*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u10*(1.0/2.0);
            f_udg[4*ng+i] += ff*h*k_h*rampFactor*t7*t60*t68*(t20*u7-t2*t3*u7*2.0-t2*t5*u7*2.0-t2*t6*u7*2.0+t4*t24*u2*2.0+t4*t69*u3*2.0+t4*t70*u4*2.0)-D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*t79-ff*h*k_h*rampFactor*t7*t20*t35*t79*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*t79*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*t79*(1.0/2.0);
            f_udg[5*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u12-ff*h*k_h*rampFactor*t7*t20*t35*u12*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u12*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u12*(1.0/2.0);
            f_udg[6*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u13-ff*h*k_h*rampFactor*t7*t20*t35*u13*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u13*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u13*(1.0/2.0);
            f_udg[7*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u14-ff*h*k_h*rampFactor*t7*t20*t35*u14*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u14*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u14*(1.0/2.0);
            f_udg[8*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u15-ff*h*k_h*rampFactor*t7*t20*t35*u15*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u15*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u15*(1.0/2.0);
            f_udg[9*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u16-ff*h*k_h*rampFactor*t7*t20*t35*u16*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u16*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u16*(1.0/2.0);
            f_udg[10*ng+i] += ff*h*k_h*rampFactor*t7*t60*t68*(t20*u13-t2*t3*u13*2.0-t2*t5*u13*2.0-t2*t6*u13*2.0+t4*t25*u3*2.0+t4*t81*u2*2.0+t4*t82*u4*2.0)-D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*t91-ff*h*k_h*rampFactor*t7*t20*t35*t91*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*t91*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*t91*(1.0/2.0);
            f_udg[11*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u18-ff*h*k_h*rampFactor*t7*t20*t35*u18*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u18*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u18*(1.0/2.0);
            f_udg[12*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u19-ff*h*k_h*rampFactor*t7*t20*t35*u19*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u19*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u19*(1.0/2.0);
            f_udg[13*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u20-ff*h*k_h*rampFactor*t7*t20*t35*u20*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u20*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u20*(1.0/2.0);
            f_udg[14*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u21-ff*h*k_h*rampFactor*t7*t20*t35*u21*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u21*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u21*(1.0/2.0);
            f_udg[15*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u22-ff*h*k_h*rampFactor*t7*t20*t35*u22*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u22*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u22*(1.0/2.0);
            f_udg[16*ng+i] += ff*h*k_h*rampFactor*t7*t60*t68*(t20*u19-t2*t3*u19*2.0-t2*t5*u19*2.0-t2*t6*u19*2.0+t4*t26*u4*2.0+t4*t93*u2*2.0+t4*t94*u3*2.0)-D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*t103-ff*h*k_h*rampFactor*t7*t20*t35*t103*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*t103*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*t103*(1.0/2.0);
            f_udg[17*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t57*t60*u24-ff*h*k_h*rampFactor*t7*t20*t35*u24*(1.0/2.0)-D_r_reg_D_r*ff*h*k_h*p_reg*param1*rampFactor*t7*t29*t61*u24*(1.0/2.0)-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t34*u24*(1.0/2.0);
            f_udg[18*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u7+ff*h*k_h*rampFactor*t4*t7*t35*u2*u7-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u7*(1.0/2.0);
            f_udg[19*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u8+ff*h*k_h*rampFactor*t4*t7*t35*u2*u8-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u8*(1.0/2.0);
            f_udg[20*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u9+ff*h*k_h*rampFactor*t4*t7*t35*u2*u9-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u9*(1.0/2.0);
            f_udg[21*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u10+ff*h*k_h*rampFactor*t4*t7*t35*u2*u10-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u10*(1.0/2.0);
            f_udg[22*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t79*t106-ff*h*k_h*rampFactor*t7*t8*t24*t60*t68*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t79*u2-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t79*u2*(1.0/2.0);
            f_udg[23*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u12+ff*h*k_h*rampFactor*t4*t7*t35*u2*u12-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u12*(1.0/2.0);
            f_udg[24*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u13+ff*h*k_h*rampFactor*t4*t7*t35*u2*u13-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u13*(1.0/2.0);
            f_udg[25*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u14+ff*h*k_h*rampFactor*t4*t7*t35*u2*u14-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u14*(1.0/2.0);
            f_udg[26*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u15+ff*h*k_h*rampFactor*t4*t7*t35*u2*u15-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u15*(1.0/2.0);
            f_udg[27*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u16+ff*h*k_h*rampFactor*t4*t7*t35*u2*u16-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u16*(1.0/2.0);
            f_udg[28*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t91*t106-ff*h*k_h*rampFactor*t7*t8*t60*t68*t81*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t91*u2-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t91*u2*(1.0/2.0);
            f_udg[29*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u18+ff*h*k_h*rampFactor*t4*t7*t35*u2*u18-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u18*(1.0/2.0);
            f_udg[30*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u19+ff*h*k_h*rampFactor*t4*t7*t35*u2*u19-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u19*(1.0/2.0);
            f_udg[31*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u20+ff*h*k_h*rampFactor*t4*t7*t35*u2*u20-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u20*(1.0/2.0);
            f_udg[32*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u21+ff*h*k_h*rampFactor*t4*t7*t35*u2*u21-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u21*(1.0/2.0);
            f_udg[33*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u22+ff*h*k_h*rampFactor*t4*t7*t35*u2*u22-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u22*(1.0/2.0);
            f_udg[34*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t103*t106-ff*h*k_h*rampFactor*t7*t8*t60*t68*t93*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t103*u2-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t103*u2*(1.0/2.0);
            f_udg[35*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t106*u24+ff*h*k_h*rampFactor*t4*t7*t35*u2*u24-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u2*u24*(1.0/2.0);
            f_udg[36*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u7+ff*h*k_h*rampFactor*t4*t7*t35*u3*u7-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u7*(1.0/2.0);
            f_udg[37*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u8+ff*h*k_h*rampFactor*t4*t7*t35*u3*u8-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u8*(1.0/2.0);
            f_udg[38*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u9+ff*h*k_h*rampFactor*t4*t7*t35*u3*u9-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u9*(1.0/2.0);
            f_udg[39*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u10+ff*h*k_h*rampFactor*t4*t7*t35*u3*u10-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u10*(1.0/2.0);
            f_udg[40*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t79*t109-ff*h*k_h*rampFactor*t7*t8*t60*t68*t69*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t79*u3-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t79*u3*(1.0/2.0);
            f_udg[41*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u12+ff*h*k_h*rampFactor*t4*t7*t35*u3*u12-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u12*(1.0/2.0);
            f_udg[42*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u13+ff*h*k_h*rampFactor*t4*t7*t35*u3*u13-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u13*(1.0/2.0);
            f_udg[43*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u14+ff*h*k_h*rampFactor*t4*t7*t35*u3*u14-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u14*(1.0/2.0);
            f_udg[44*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u15+ff*h*k_h*rampFactor*t4*t7*t35*u3*u15-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u15*(1.0/2.0);
            f_udg[45*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u16+ff*h*k_h*rampFactor*t4*t7*t35*u3*u16-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u16*(1.0/2.0);
            f_udg[46*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t91*t109-ff*h*k_h*rampFactor*t7*t8*t25*t60*t68*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t91*u3-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t91*u3*(1.0/2.0);
            f_udg[47*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u18+ff*h*k_h*rampFactor*t4*t7*t35*u3*u18-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u18*(1.0/2.0);
            f_udg[48*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u19+ff*h*k_h*rampFactor*t4*t7*t35*u3*u19-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u19*(1.0/2.0);
            f_udg[49*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u20+ff*h*k_h*rampFactor*t4*t7*t35*u3*u20-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u20*(1.0/2.0);
            f_udg[50*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u21+ff*h*k_h*rampFactor*t4*t7*t35*u3*u21-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u21*(1.0/2.0);
            f_udg[51*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u22+ff*h*k_h*rampFactor*t4*t7*t35*u3*u22-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u22*(1.0/2.0);
            f_udg[52*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t103*t109-ff*h*k_h*rampFactor*t7*t8*t60*t68*t94*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t103*u3-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t103*u3*(1.0/2.0);
            f_udg[53*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t109*u24+ff*h*k_h*rampFactor*t4*t7*t35*u3*u24-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u3*u24*(1.0/2.0);
            f_udg[54*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u7+ff*h*k_h*rampFactor*t4*t7*t35*u4*u7-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u7*(1.0/2.0);
            f_udg[55*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u8+ff*h*k_h*rampFactor*t4*t7*t35*u4*u8-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u8*(1.0/2.0);
            f_udg[56*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u9+ff*h*k_h*rampFactor*t4*t7*t35*u4*u9-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u9*(1.0/2.0);
            f_udg[57*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u10+ff*h*k_h*rampFactor*t4*t7*t35*u4*u10-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u10*(1.0/2.0);
            f_udg[58*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t79*t112-ff*h*k_h*rampFactor*t7*t8*t60*t68*t70*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t79*u4-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t79*u4*(1.0/2.0);
            f_udg[59*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u12+ff*h*k_h*rampFactor*t4*t7*t35*u4*u12-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u12*(1.0/2.0);
            f_udg[60*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u13+ff*h*k_h*rampFactor*t4*t7*t35*u4*u13-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u13*(1.0/2.0);
            f_udg[61*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u14+ff*h*k_h*rampFactor*t4*t7*t35*u4*u14-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u14*(1.0/2.0);
            f_udg[62*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u15+ff*h*k_h*rampFactor*t4*t7*t35*u4*u15-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u15*(1.0/2.0);
            f_udg[63*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u16+ff*h*k_h*rampFactor*t4*t7*t35*u4*u16-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u16*(1.0/2.0);
            f_udg[64*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t91*t112-ff*h*k_h*rampFactor*t7*t8*t60*t68*t82*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t91*u4-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t91*u4*(1.0/2.0);
            f_udg[65*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u18+ff*h*k_h*rampFactor*t4*t7*t35*u4*u18-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u18*(1.0/2.0);
            f_udg[66*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u19+ff*h*k_h*rampFactor*t4*t7*t35*u4*u19-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u19*(1.0/2.0);
            f_udg[67*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u20+ff*h*k_h*rampFactor*t4*t7*t35*u4*u20-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u20*(1.0/2.0);
            f_udg[68*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u21+ff*h*k_h*rampFactor*t4*t7*t35*u4*u21-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u21*(1.0/2.0);
            f_udg[69*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u22+ff*h*k_h*rampFactor*t4*t7*t35*u4*u22-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u22*(1.0/2.0);
            f_udg[70*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t103*t112-ff*h*k_h*rampFactor*t7*t8*t26*t60*t68*2.0+ff*h*k_h*rampFactor*t4*t7*t35*t103*u4-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*t103*u4*(1.0/2.0);
            f_udg[71*ng+i] += -D_ff_D_x*h*k_h*rampFactor*t7*t60*t112*u24+ff*h*k_h*rampFactor*t4*t7*t35*u4*u24-D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t8*t16*t27*t29*u4*u24*(1.0/2.0);
            f_udg[72*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u7*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u7*(1.0/2.0);
            f_udg[73*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u8*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u8*(1.0/2.0);
            f_udg[74*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u9*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u9*(1.0/2.0);
            f_udg[75*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u10*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u10*(1.0/2.0);
            f_udg[76*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t79*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t79*t114*t115*t116*(1.0/2.0);
            f_udg[77*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u12*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u12*(1.0/2.0);
            f_udg[78*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u13*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u13*(1.0/2.0);
            f_udg[79*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u14*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u14*(1.0/2.0);
            f_udg[80*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u15*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u15*(1.0/2.0);
            f_udg[81*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u16*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u16*(1.0/2.0);
            f_udg[82*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t91*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t91*t114*t115*t116*(1.0/2.0);
            f_udg[83*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u18*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u18*(1.0/2.0);
            f_udg[84*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u19*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u19*(1.0/2.0);
            f_udg[85*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u20*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u20*(1.0/2.0);
            f_udg[86*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u21*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u21*(1.0/2.0);
            f_udg[87*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u22*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u22*(1.0/2.0);
            f_udg[88*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*t103*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t103*t114*t115*t116*(1.0/2.0);
            f_udg[89*ng+i] += D_p_reg_D_p*ff*h*k_h*param1*rampFactor*t7*t16*t27*t29*u24*(1.0/2.0)-D_H_reg_D_H*D_ff_D_x*param1*rampFactor*t8*t10*t22*t52*t56*t60*t114*t115*t116*u24*(1.0/2.0);
            f_udg[90*ng+i] += 0.0;
            f_udg[91*ng+i] += 0.0;
            f_udg[92*ng+i] += 0.0;
            f_udg[93*ng+i] += 0.0;
            f_udg[94*ng+i] += 0.0;
            f_udg[95*ng+i] += 0.0;
            f_udg[96*ng+i] += 0.0;
            f_udg[97*ng+i] += 0.0;
            f_udg[98*ng+i] += 0.0;
            f_udg[99*ng+i] += 0.0;
            f_udg[100*ng+i] += 0.0;
            f_udg[101*ng+i] += 0.0;
            f_udg[102*ng+i] += 0.0;
            f_udg[103*ng+i] += 0.0;
            f_udg[104*ng+i] += 0.0;
            f_udg[105*ng+i] += 0.0;
            f_udg[106*ng+i] += 0.0;
            f_udg[107*ng+i] += 0.0;
            f_udg[108*ng+i] += t117-D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u7;
            f_udg[109*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u8;
            f_udg[110*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u9;
            f_udg[111*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u10;
            f_udg[112*ng+i] += t119-D_ff_D_x*rampFactor*t4*t36*t60*t79*t114*t115*t116*u2;
            f_udg[113*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u12;
            f_udg[114*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u13;
            f_udg[115*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u14;
            f_udg[116*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u15;
            f_udg[117*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u16;
            f_udg[118*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t91*t114*t115*t116*u2;
            f_udg[119*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u18;
            f_udg[120*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u19;
            f_udg[121*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u20;
            f_udg[122*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u21;
            f_udg[123*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u22;
            f_udg[124*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t103*t114*t115*t116*u2;
            f_udg[125*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u2*u24;
            f_udg[126*ng+i] += t120;
            f_udg[127*ng+i] += t117+t121;
            f_udg[128*ng+i] += t122;
            f_udg[129*ng+i] += t123;
            f_udg[130*ng+i] += t124-ff*h*k_h*rampFactor*t7*t8*t60*t68*u2*2.0;
            f_udg[131*ng+i] += t125;
            f_udg[132*ng+i] += t126;
            f_udg[133*ng+i] += t127;
            f_udg[134*ng+i] += t128;
            f_udg[135*ng+i] += t129;
            f_udg[136*ng+i] += t130;
            f_udg[137*ng+i] += t131;
            f_udg[138*ng+i] += t132;
            f_udg[139*ng+i] += t133;
            f_udg[140*ng+i] += t134;
            f_udg[141*ng+i] += t135;
            f_udg[142*ng+i] += t136;
            f_udg[143*ng+i] += t137;
            f_udg[144*ng+i] += 0.0;
            f_udg[145*ng+i] += 0.0;
            f_udg[146*ng+i] += t117;
            f_udg[147*ng+i] += 0.0;
            f_udg[148*ng+i] += ff*h*k_h*rampFactor*t7*t8*t60*t68*u3*-2.0;
            f_udg[149*ng+i] += 0.0;
            f_udg[150*ng+i] += 0.0;
            f_udg[151*ng+i] += 0.0;
            f_udg[152*ng+i] += 0.0;
            f_udg[153*ng+i] += 0.0;
            f_udg[154*ng+i] += 0.0;
            f_udg[155*ng+i] += 0.0;
            f_udg[156*ng+i] += 0.0;
            f_udg[157*ng+i] += 0.0;
            f_udg[158*ng+i] += 0.0;
            f_udg[159*ng+i] += 0.0;
            f_udg[160*ng+i] += 0.0;
            f_udg[161*ng+i] += 0.0;
            f_udg[162*ng+i] += 0.0;
            f_udg[163*ng+i] += 0.0;
            f_udg[164*ng+i] += 0.0;
            f_udg[165*ng+i] += t117;
            f_udg[166*ng+i] += ff*h*k_h*rampFactor*t7*t8*t60*t68*u4*-2.0;
            f_udg[167*ng+i] += 0.0;
            f_udg[168*ng+i] += 0.0;
            f_udg[169*ng+i] += 0.0;
            f_udg[170*ng+i] += 0.0;
            f_udg[171*ng+i] += 0.0;
            f_udg[172*ng+i] += 0.0;
            f_udg[173*ng+i] += 0.0;
            f_udg[174*ng+i] += 0.0;
            f_udg[175*ng+i] += 0.0;
            f_udg[176*ng+i] += 0.0;
            f_udg[177*ng+i] += 0.0;
            f_udg[178*ng+i] += 0.0;
            f_udg[179*ng+i] += 0.0;
            f_udg[180*ng+i] += 0.0;
            f_udg[181*ng+i] += 0.0;
            f_udg[182*ng+i] += 0.0;
            f_udg[183*ng+i] += 0.0;
            f_udg[184*ng+i] += t138;
            f_udg[185*ng+i] += 0.0;
            f_udg[186*ng+i] += 0.0;
            f_udg[187*ng+i] += 0.0;
            f_udg[188*ng+i] += 0.0;
            f_udg[189*ng+i] += 0.0;
            f_udg[190*ng+i] += 0.0;
            f_udg[191*ng+i] += 0.0;
            f_udg[192*ng+i] += 0.0;
            f_udg[193*ng+i] += 0.0;
            f_udg[194*ng+i] += 0.0;
            f_udg[195*ng+i] += 0.0;
            f_udg[196*ng+i] += 0.0;
            f_udg[197*ng+i] += 0.0;
            f_udg[198*ng+i] += 0.0;
            f_udg[199*ng+i] += 0.0;
            f_udg[200*ng+i] += 0.0;
            f_udg[201*ng+i] += 0.0;
            f_udg[202*ng+i] += 0.0;
            f_udg[203*ng+i] += t117;
            f_udg[204*ng+i] += 0.0;
            f_udg[205*ng+i] += 0.0;
            f_udg[206*ng+i] += 0.0;
            f_udg[207*ng+i] += 0.0;
            f_udg[208*ng+i] += 0.0;
            f_udg[209*ng+i] += 0.0;
            f_udg[210*ng+i] += 0.0;
            f_udg[211*ng+i] += 0.0;
            f_udg[212*ng+i] += 0.0;
            f_udg[213*ng+i] += 0.0;
            f_udg[214*ng+i] += 0.0;
            f_udg[215*ng+i] += 0.0;
            f_udg[216*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u7;
            f_udg[217*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u8;
            f_udg[218*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u9;
            f_udg[219*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u10;
            f_udg[220*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t79*t114*t115*t116*u3;
            f_udg[221*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u12;
            f_udg[222*ng+i] += t117-D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u13;
            f_udg[223*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u14;
            f_udg[224*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u15;
            f_udg[225*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u16;
            f_udg[226*ng+i] += t119-D_ff_D_x*rampFactor*t4*t36*t60*t91*t114*t115*t116*u3;
            f_udg[227*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u18;
            f_udg[228*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u19;
            f_udg[229*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u20;
            f_udg[230*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u21;
            f_udg[231*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u22;
            f_udg[232*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t103*t114*t115*t116*u3;
            f_udg[233*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u3*u24;
            f_udg[234*ng+i] += 0.0;
            f_udg[235*ng+i] += 0.0;
            f_udg[236*ng+i] += 0.0;
            f_udg[237*ng+i] += 0.0;
            f_udg[238*ng+i] += 0.0;
            f_udg[239*ng+i] += 0.0;
            f_udg[240*ng+i] += 0.0;
            f_udg[241*ng+i] += t117;
            f_udg[242*ng+i] += 0.0;
            f_udg[243*ng+i] += 0.0;
            f_udg[244*ng+i] += ff*h*k_h*rampFactor*t7*t8*t60*t68*u2*-2.0;
            f_udg[245*ng+i] += 0.0;
            f_udg[246*ng+i] += 0.0;
            f_udg[247*ng+i] += 0.0;
            f_udg[248*ng+i] += 0.0;
            f_udg[249*ng+i] += 0.0;
            f_udg[250*ng+i] += 0.0;
            f_udg[251*ng+i] += 0.0;
            f_udg[252*ng+i] += t120;
            f_udg[253*ng+i] += t121;
            f_udg[254*ng+i] += t122;
            f_udg[255*ng+i] += t123;
            f_udg[256*ng+i] += t124;
            f_udg[257*ng+i] += t125;
            f_udg[258*ng+i] += t126;
            f_udg[259*ng+i] += t127;
            f_udg[260*ng+i] += t117+t128;
            f_udg[261*ng+i] += t129;
            f_udg[262*ng+i] += t130-ff*h*k_h*rampFactor*t7*t8*t60*t68*u3*2.0;
            f_udg[263*ng+i] += t131;
            f_udg[264*ng+i] += t132;
            f_udg[265*ng+i] += t133;
            f_udg[266*ng+i] += t134;
            f_udg[267*ng+i] += t135;
            f_udg[268*ng+i] += t136;
            f_udg[269*ng+i] += t137;
            f_udg[270*ng+i] += 0.0;
            f_udg[271*ng+i] += 0.0;
            f_udg[272*ng+i] += 0.0;
            f_udg[273*ng+i] += 0.0;
            f_udg[274*ng+i] += 0.0;
            f_udg[275*ng+i] += 0.0;
            f_udg[276*ng+i] += 0.0;
            f_udg[277*ng+i] += 0.0;
            f_udg[278*ng+i] += 0.0;
            f_udg[279*ng+i] += t117;
            f_udg[280*ng+i] += ff*h*k_h*rampFactor*t7*t8*t60*t68*u4*-2.0;
            f_udg[281*ng+i] += 0.0;
            f_udg[282*ng+i] += 0.0;
            f_udg[283*ng+i] += 0.0;
            f_udg[284*ng+i] += 0.0;
            f_udg[285*ng+i] += 0.0;
            f_udg[286*ng+i] += 0.0;
            f_udg[287*ng+i] += 0.0;
            f_udg[288*ng+i] += 0.0;
            f_udg[289*ng+i] += 0.0;
            f_udg[290*ng+i] += 0.0;
            f_udg[291*ng+i] += 0.0;
            f_udg[292*ng+i] += 0.0;
            f_udg[293*ng+i] += 0.0;
            f_udg[294*ng+i] += 0.0;
            f_udg[295*ng+i] += 0.0;
            f_udg[296*ng+i] += 0.0;
            f_udg[297*ng+i] += 0.0;
            f_udg[298*ng+i] += t138;
            f_udg[299*ng+i] += 0.0;
            f_udg[300*ng+i] += 0.0;
            f_udg[301*ng+i] += 0.0;
            f_udg[302*ng+i] += 0.0;
            f_udg[303*ng+i] += 0.0;
            f_udg[304*ng+i] += 0.0;
            f_udg[305*ng+i] += 0.0;
            f_udg[306*ng+i] += 0.0;
            f_udg[307*ng+i] += 0.0;
            f_udg[308*ng+i] += 0.0;
            f_udg[309*ng+i] += 0.0;
            f_udg[310*ng+i] += 0.0;
            f_udg[311*ng+i] += 0.0;
            f_udg[312*ng+i] += 0.0;
            f_udg[313*ng+i] += 0.0;
            f_udg[314*ng+i] += 0.0;
            f_udg[315*ng+i] += 0.0;
            f_udg[316*ng+i] += 0.0;
            f_udg[317*ng+i] += t117;
            f_udg[318*ng+i] += 0.0;
            f_udg[319*ng+i] += 0.0;
            f_udg[320*ng+i] += 0.0;
            f_udg[321*ng+i] += 0.0;
            f_udg[322*ng+i] += 0.0;
            f_udg[323*ng+i] += 0.0;
            f_udg[324*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u7;
            f_udg[325*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u8;
            f_udg[326*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u9;
            f_udg[327*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u10;
            f_udg[328*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t79*t114*t115*t116*u4;
            f_udg[329*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u12;
            f_udg[330*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u13;
            f_udg[331*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u14;
            f_udg[332*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u15;
            f_udg[333*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u16;
            f_udg[334*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t91*t114*t115*t116*u4;
            f_udg[335*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u18;
            f_udg[336*ng+i] += t117-D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u19;
            f_udg[337*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u20;
            f_udg[338*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u21;
            f_udg[339*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u22;
            f_udg[340*ng+i] += t119-D_ff_D_x*rampFactor*t4*t36*t60*t103*t114*t115*t116*u4;
            f_udg[341*ng+i] += -D_ff_D_x*rampFactor*t4*t36*t60*t114*t115*t116*u4*u24;
            f_udg[342*ng+i] += 0.0;
            f_udg[343*ng+i] += 0.0;
            f_udg[344*ng+i] += 0.0;
            f_udg[345*ng+i] += 0.0;
            f_udg[346*ng+i] += 0.0;
            f_udg[347*ng+i] += 0.0;
            f_udg[348*ng+i] += 0.0;
            f_udg[349*ng+i] += 0.0;
            f_udg[350*ng+i] += 0.0;
            f_udg[351*ng+i] += 0.0;
            f_udg[352*ng+i] += 0.0;
            f_udg[353*ng+i] += 0.0;
            f_udg[354*ng+i] += 0.0;
            f_udg[355*ng+i] += t117;
            f_udg[356*ng+i] += 0.0;
            f_udg[357*ng+i] += 0.0;
            f_udg[358*ng+i] += ff*h*k_h*rampFactor*t7*t8*t60*t68*u2*-2.0;
            f_udg[359*ng+i] += 0.0;
            f_udg[360*ng+i] += 0.0;
            f_udg[361*ng+i] += 0.0;
            f_udg[362*ng+i] += 0.0;
            f_udg[363*ng+i] += 0.0;
            f_udg[364*ng+i] += 0.0;
            f_udg[365*ng+i] += 0.0;
            f_udg[366*ng+i] += 0.0;
            f_udg[367*ng+i] += 0.0;
            f_udg[368*ng+i] += 0.0;
            f_udg[369*ng+i] += 0.0;
            f_udg[370*ng+i] += 0.0;
            f_udg[371*ng+i] += 0.0;
            f_udg[372*ng+i] += 0.0;
            f_udg[373*ng+i] += 0.0;
            f_udg[374*ng+i] += t117;
            f_udg[375*ng+i] += 0.0;
            f_udg[376*ng+i] += ff*h*k_h*rampFactor*t7*t8*t60*t68*u3*-2.0;
            f_udg[377*ng+i] += 0.0;
            f_udg[378*ng+i] += t120;
            f_udg[379*ng+i] += t121;
            f_udg[380*ng+i] += t122;
            f_udg[381*ng+i] += t123;
            f_udg[382*ng+i] += t124;
            f_udg[383*ng+i] += t125;
            f_udg[384*ng+i] += t126;
            f_udg[385*ng+i] += t127;
            f_udg[386*ng+i] += t128;
            f_udg[387*ng+i] += t129;
            f_udg[388*ng+i] += t130;
            f_udg[389*ng+i] += t131;
            f_udg[390*ng+i] += t132;
            f_udg[391*ng+i] += t133;
            f_udg[392*ng+i] += t134;
            f_udg[393*ng+i] += t117+t135;
            f_udg[394*ng+i] += t136-ff*h*k_h*rampFactor*t7*t8*t60*t68*u4*2.0;
            f_udg[395*ng+i] += t137;
            f_udg[396*ng+i] += 0.0;
            f_udg[397*ng+i] += 0.0;
            f_udg[398*ng+i] += 0.0;
            f_udg[399*ng+i] += 0.0;
            f_udg[400*ng+i] += 0.0;
            f_udg[401*ng+i] += 0.0;
            f_udg[402*ng+i] += 0.0;
            f_udg[403*ng+i] += 0.0;
            f_udg[404*ng+i] += 0.0;
            f_udg[405*ng+i] += 0.0;
            f_udg[406*ng+i] += 0.0;
            f_udg[407*ng+i] += 0.0;
            f_udg[408*ng+i] += 0.0;
            f_udg[409*ng+i] += 0.0;
            f_udg[410*ng+i] += 0.0;
            f_udg[411*ng+i] += 0.0;
            f_udg[412*ng+i] += t138;
            f_udg[413*ng+i] += 0.0;
            f_udg[414*ng+i] += 0.0;
            f_udg[415*ng+i] += 0.0;
            f_udg[416*ng+i] += 0.0;
            f_udg[417*ng+i] += 0.0;
            f_udg[418*ng+i] += 0.0;
            f_udg[419*ng+i] += 0.0;
            f_udg[420*ng+i] += 0.0;
            f_udg[421*ng+i] += 0.0;
            f_udg[422*ng+i] += 0.0;
            f_udg[423*ng+i] += 0.0;
            f_udg[424*ng+i] += 0.0;
            f_udg[425*ng+i] += 0.0;
            f_udg[426*ng+i] += 0.0;
            f_udg[427*ng+i] += 0.0;
            f_udg[428*ng+i] += 0.0;
            f_udg[429*ng+i] += 0.0;
            f_udg[430*ng+i] += 0.0;
            f_udg[431*ng+i] += t117;
		}
	}
}
