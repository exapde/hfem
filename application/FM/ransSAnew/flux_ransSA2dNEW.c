
#define PI (3.141592653589793)

// Written by: C. Nguyen & P. Fernandez

void flux_ransSA2dNEW(double *f, double *f_udg, double *pg, double *udg, appstruct &app, double *param,
				      double time, int ng, int nc, int ncu, int nd, int ncd, int computeJacobian)
{
	double param1 = param[0];
	double param2 = param[1];
	double param3 = param[2];
	double param4 = param[3];
	double param5 = param[4];
	double param6 = param[5];

	/* Allocate dynamic memory */
	double * mu  = new double [ng];
	double * mu_udg;
	double * f_mu;
	if (computeJacobian == 1 && app.viscosityModel != 0) {
		mu_udg = new double [ng * nc];
		f_mu = new double [ng * ncu * nd];
	}

	double PrTurb = 0.9;
	double sigma = 2.0/3.0;
	double cv1 = 7.1;

	// SA regularization parameters (Ref. Hemant Chaurasia PhD Thesis):
	double b = 100.0;
	double c = 1.0/2.0 - atan(b)/PI;

	getViscosity(mu, mu_udg, pg, udg, param, app.viscosityModel, ng, nc, ncu, nd, computeJacobian);

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];

		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];
		double u10 = udg[9*ng+i];
		double u11 = udg[10*ng+i];
		double u12 = udg[11*ng+i];
		double u13 = udg[12*ng+i];
		double u14 = udg[13*ng+i];
		double u15 = udg[14*ng+i];

		double t2 = u2*u2;
		double t3 = 1.0/(u1*u1);
		double t4 = 1.0/mu[i];
		double t7 = 1.0/3.141592653589793;
		double t8 = b*t4*u5;
		double t9 = atan(t8);
		double t10 = t7*t9;
		double t11 = t10+1.0/2.0;
		double t12 = t4*t11*u5;
		double t5 = c+t12;
		double t6 = t5*t5;
		double t13 = cv1*cv1;
		double t14 = 1.0/u1;
		double t15 = 1.0/param3;
		double t16 = t6*t6;
		double t17 = cv1*t13+t5*t6;
		double t18 = 1.0/t17;
		double t19 = mu[i]*t16*t18;
		double t20 = mu[i]+t19;
		double t21 = t2*t3*(1.0/2.0);
		double t22 = u3*u3;
		double t23 = t3*t22*(1.0/2.0);
		double t24 = t21+t23;
		double t38 = t24*u1;
		double t25 = -t38+u4;
		double t26 = param1-1.0;
		double t37 = t14*u3*u6;
		double t27 = -t37+u8;
		double t28 = t14*t27;
		double t40 = t14*u2*u11;
		double t29 = -t40+u12;
		double t30 = t14*t29;
		double t31 = t28+t30;
		double t36 = t14*u2*u6;
		double t32 = -t36+u7;
		double t33 = t14*t32*(4.0/3.0);
		double t44 = t14*u3*u11;
		double t34 = -t44+u13;
		double t35 = t33-t14*t34*(2.0/3.0);
		double t39 = t14*u2*u3;
		double t41 = t15*t20*t31;
		double t42 = t39+t41;
		double t43 = t25*t26;
		double t45 = t14*u4;
		double t46 = t14*t25*t26;
		double t47 = t45+t46;
		double t48 = t14*t32*(2.0/3.0);
		double t49 = t48-t14*t34*(4.0/3.0);
		double t50 = 1.0/param4;
		double t51 = mu[i]*param1*t50;
		double t52 = 1.0/PrTurb;
		double t53 = mu[i]*param1*t16*t18*t52;
		double t54 = t51+t53;
		double t55 = 1.0/t26;
		double t56 = 1.0/sigma;
		double t57 = c+t12+1.0;

		f[0*ng+i] = u2;
		f[1*ng+i] = t43+t2*t14+t15*t20*t35;
		f[2*ng+i] = t42;
		f[3*ng+i] = t47*u2+t14*t15*t20*t31*u3+t14*t15*t20*t35*u2-t3*t15*t54*t55*(t26*u1*(-u9+t24*u6+u1*(t3*t27*u3+t3*t32*u2))+t25*t26*u6);
		f[4*ng+i] = t14*u2*u5+mu[i]*t14*t15*t56*t57*(u10-t14*u5*u6);
		f[5*ng+i] = u3;
		f[6*ng+i] = t42;
		f[7*ng+i] = t43+t14*t22-t15*t20*t49;
		f[8*ng+i] = t47*u3+t14*t15*t20*t31*u2-t14*t15*t20*t49*u3-t3*t15*t54*t55*(t26*u1*(-u14+t24*u11+u1*(t3*t29*u2+t3*t34*u3))+t25*t26*u11);
		f[9*ng+i] = t14*u3*u5+mu[i]*t14*t15*t56*t57*(u15-t14*u5*u11);
	}
    
//     for (int i = 0; i <ng*5*2; i++)
//         f[i] /= param3;

	if (computeJacobian == 1) {

		for (int i = 0; i <ng; i++) {
			double x1 = pg[0*ng+i];
			double x2 = pg[1*ng+i];

			double u1 = udg[0*ng+i];
			double u2 = udg[1*ng+i];
			double u3 = udg[2*ng+i];
			double u4 = udg[3*ng+i];
			double u5 = udg[4*ng+i];
			double u6 = udg[5*ng+i];
			double u7 = udg[6*ng+i];
			double u8 = udg[7*ng+i];
			double u9 = udg[8*ng+i];
			double u10 = udg[9*ng+i];
			double u11 = udg[10*ng+i];
			double u12 = udg[11*ng+i];
			double u13 = udg[12*ng+i];
			double u14 = udg[13*ng+i];
			double u15 = udg[14*ng+i];

			double t2 = 1.0/(u1*u1);
			double t3 = u2*u2;
			double t4 = 1.0/(u1*u1*u1);
			double t5 = u3*u3;
			double t6 = 1.0/mu[i];
			double t9 = 1.0/3.141592653589793;
			double t10 = b*t6*u5;
			double t11 = atan(t10);
			double t12 = t9*t11;
			double t13 = t12+1.0/2.0;
			double t14 = t6*t13*u5;
			double t7 = c+t14;
			double t8 = t7*t7;
			double t15 = cv1*cv1;
			double t16 = 1.0/u1;
			double t17 = 1.0/param3;
			double t18 = t8*t8;
			double t19 = cv1*t15+t7*t8;
			double t20 = 1.0/t19;
			double t21 = mu[i]*t18*t20;
			double t22 = mu[i]+t21;
			double t23 = t2*t3*(1.0/2.0);
			double t24 = t2*t5*(1.0/2.0);
			double t25 = param1-1.0;
			double t26 = t3*t4;
			double t27 = t4*t5;
			double t28 = t26+t27;
			double t58 = t28*u1;
			double t29 = t23+t24-t58;
			double t34 = t16*u3*u6;
			double t30 = -t34+u8;
			double t36 = t16*u2*u11;
			double t31 = -t36+u12;
			double t39 = t16*u2*u6;
			double t32 = -t39+u7;
			double t41 = t16*u3*u11;
			double t33 = -t41+u13;
			double t35 = t2*t30;
			double t37 = t2*t31;
			double t62 = t4*u3*u6;
			double t63 = t4*u2*u11;
			double t38 = t35+t37-t62-t63;
			double t40 = t2*t32*(4.0/3.0);
			double t42 = t4*u3*u11*(2.0/3.0);
			double t43 = t40+t42-t2*t33*(2.0/3.0)-t4*u2*u6*(4.0/3.0);
			double t44 = t23+t24;
			double t66 = t44*u1;
			double t45 = -t66+u4;
			double t46 = 1.0/param4;
			double t47 = mu[i]*param1*t46;
			double t48 = 1.0/PrTurb;
			double t49 = mu[i]*param1*t18*t20*t48;
			double t50 = t47+t49;
			double t51 = 1.0/t25;
			double t52 = t44*u6;
			double t53 = t2*t32*u2;
			double t54 = t2*t30*u3;
			double t55 = t53+t54;
			double t56 = t55*u1;
			double t57 = t52+t56-u9;
			double t59 = 1.0/(u1*u1*u1*u1);
			double t60 = 1.0/sigma;
			double t61 = c+t14+1.0;
			double t64 = -t17*t22*t38-t2*u2*u3;
			double t65 = t2*u4;
			double t67 = t2*t25*t45;
			double t68 = t16*t25*t29;
			double t69 = t65+t67+t68;
			double t70 = t16*t30;
			double t71 = t16*t31;
			double t72 = t70+t71;
			double t73 = t2*t32*(2.0/3.0);
			double t74 = t4*u3*u11*(4.0/3.0);
			double t75 = t73+t74-t2*t33*(4.0/3.0)-t4*u2*u6*(2.0/3.0);
			double t76 = t44*u11;
			double t77 = t2*t31*u2;
			double t78 = t2*t33*u3;
			double t79 = t77+t78;
			double t80 = t79*u1;
			double t81 = t76+t80-u14;
			double t82 = t16*t32*(4.0/3.0);
			double t105 = t16*t33*(2.0/3.0);
			double t83 = t82-t105;
			double t84 = t16*u3;
			double t85 = t84-t2*t17*t22*u11;
			double t86 = t16*t17*t22*t72;
			double t87 = t16*u2;
			double t88 = t87-t2*t17*t22*u6;
			double t89 = t16*u4;
			double t90 = t16*t25*t45;
			double t91 = t16*t32*(2.0/3.0);
			double t115 = t16*t33*(4.0/3.0);
			double t92 = t91-t115;
			double t93 = t16*u5;
			double t94 = t16*t25;
			double t95 = t16+t94;
			double t96 = 1.0/(mu[i]*mu[i]);
			double t97 = t6*t13;
			double t98 = b*b;
			double t99 = u5*u5;
			double t100 = t96*t98*t99;
			double t101 = t100+1.0;
			double t102 = 1.0/t101;
			double t103 = b*t9*t96*t102*u5;
			double t104 = t97+t103;
			double t106 = mu[i]*t7*t8*t20*t104*4.0;
			double t107 = 1.0/(t19*t19);
			double t112 = mu[i]*t8*t18*t104*t107*3.0;
			double t108 = t106-t112;
			double t109 = t25*t57*u1;
			double t110 = t25*t45*u6;
			double t111 = t109+t110;
			double t113 = u10-t16*u5*u6;
			double t114 = t17*t72*t108;
			double t116 = t25*t81*u1;
			double t117 = t25*t45*u11;
			double t118 = t116+t117;
			double t119 = mu[i]*param1*t7*t8*t20*t48*t104*4.0;
			double t120 = t119-mu[i]*param1*t8*t18*t48*t104*t107*3.0;
			double t121 = u15-t16*u5*u11;
			double t122 = t16*t17*t22;
			double t123 = t2*t17*t22*u2;
			double t124 = t25*t45;
			double t125 = t25*t29*u1;
			double t126 = t124+t125;
			double t127 = t2*t17*t22*u3;
			double t128 = t2*t17*t22*u2*(2.0/3.0);
			double t129 = t16*t17*t22*(4.0/3.0);
			double t130 = t16*t17*t50;
			double t131 = mu[i]*t16*t17*t60*t61;

			f_udg[0*ng+i] = 0.0;
			f_udg[1*ng+i] = -t2*t3-t25*t29-t17*t22*t43;
			f_udg[2*ng+i] = t64;
			f_udg[3*ng+i] = -t69*u2-t2*t17*t50*t51*(t25*t57-t25*t29*u6+t25*u1*(t53+t54-u1*(t4*t30*u3*2.0+t4*t32*u2*2.0-t3*t59*u6-t5*t59*u6)-t28*u6))+t4*t17*t50*t51*t111*2.0-t16*t17*t22*t38*u3-t16*t17*t22*t43*u2-t2*t17*t22*t72*u3-t2*t17*t22*t83*u2;
			f_udg[4*ng+i] = -t2*u2*u5-mu[i]*t2*t17*t60*t61*t113+mu[i]*t4*t17*t60*t61*u5*u6;
			f_udg[5*ng+i] = 0.0;
			f_udg[6*ng+i] = t64;
			f_udg[7*ng+i] = -t2*t5-t25*t29+t17*t22*t75;
			f_udg[8*ng+i] = -t69*u3-t2*t17*t50*t51*(t25*t81-t25*t29*u11+t25*u1*(t77+t78-u1*(t4*t31*u2*2.0+t4*t33*u3*2.0-t3*t59*u11-t5*t59*u11)-t28*u11))+t4*t17*t50*t51*t118*2.0-t16*t17*t22*t38*u2-t2*t17*t22*t72*u2+t16*t17*t22*t75*u3+t2*t17*t22*t92*u3;
			f_udg[9*ng+i] = -t2*u3*u5-mu[i]*t2*t17*t60*t61*t121+mu[i]*t4*t17*t60*t61*u5*u11;
			f_udg[10*ng+i] = 1.0;
			f_udg[11*ng+i] = t16*u2*2.0-t16*t25*u2-t2*t17*t22*u6*(4.0/3.0);
			f_udg[12*ng+i] = t85;
			f_udg[13*ng+i] = t89+t90-t2*t3*t25+t16*t17*t22*t83-t2*t17*t50*t51*(t25*u1*(u1*(t2*t32-t4*u2*u6)+t2*u2*u6)-t16*t25*u2*u6)-t4*t17*t22*u2*u6*(4.0/3.0)-t4*t17*t22*u3*u11;
			f_udg[14*ng+i] = t93;
			f_udg[15*ng+i] = 0.0;
			f_udg[16*ng+i] = t85;
			f_udg[17*ng+i] = -t16*t25*u2+t2*t17*t22*u6*(2.0/3.0);
			f_udg[18*ng+i] = t86-t2*t25*u2*u3-t2*t17*t50*t51*(t25*u1*(u1*(t37-t63)+t2*u2*u11)-t16*t25*u2*u11)+t4*t17*t22*u3*u6*(2.0/3.0)-t4*t17*t22*u2*u11;
			f_udg[19*ng+i] = 0.0;
			f_udg[20*ng+i] = 0.0;
			f_udg[21*ng+i] = -t16*t25*u3+t2*t17*t22*u11*(2.0/3.0);
			f_udg[22*ng+i] = t88;
			f_udg[23*ng+i] = t86-t2*t25*u2*u3-t2*t17*t50*t51*(t25*u1*(u1*(t35-t62)+t2*u3*u6)-t16*t25*u3*u6)-t4*t17*t22*u3*u6+t4*t17*t22*u2*u11*(2.0/3.0);
			f_udg[24*ng+i] = 0.0;
			f_udg[25*ng+i] = 1.0;
			f_udg[26*ng+i] = t88;
			f_udg[27*ng+i] = t16*u3*2.0-t16*t25*u3-t2*t17*t22*u11*(4.0/3.0);
			f_udg[28*ng+i] = t89+t90-t2*t5*t25-t16*t17*t22*t92-t2*t17*t50*t51*(t25*u1*(u1*(t2*t33-t4*u3*u11)+t2*u3*u11)-t16*t25*u3*u11)-t4*t17*t22*u2*u6-t4*t17*t22*u3*u11*(4.0/3.0);
			f_udg[29*ng+i] = t93;
			f_udg[30*ng+i] = 0.0;
			f_udg[31*ng+i] = t25;
			f_udg[32*ng+i] = 0.0;
			f_udg[33*ng+i] = t95*u2-t2*t17*t50*u6;
			f_udg[34*ng+i] = 0.0;
			f_udg[35*ng+i] = 0.0;
			f_udg[36*ng+i] = 0.0;
			f_udg[37*ng+i] = t25;
			f_udg[38*ng+i] = t95*u3-t2*t17*t50*u11;
			f_udg[39*ng+i] = 0.0;
			f_udg[40*ng+i] = 0.0;
			f_udg[41*ng+i] = t17*t83*t108;
			f_udg[42*ng+i] = t114;
			f_udg[43*ng+i] = -t2*t17*t51*t111*t120+t16*t17*t72*t108*u3+t16*t17*t83*t108*u2;
			f_udg[44*ng+i] = t87+mu[i]*t16*t17*t60*t104*t113-mu[i]*t2*t17*t60*t61*u6;
			f_udg[45*ng+i] = 0.0;
			f_udg[46*ng+i] = t114;
			f_udg[47*ng+i] = -t17*t92*t108;
			f_udg[48*ng+i] = -t2*t17*t51*t118*t120+t16*t17*t72*t108*u2-t16*t17*t92*t108*u3;
			f_udg[49*ng+i] = t84+mu[i]*t16*t17*t60*t104*t121-mu[i]*t2*t17*t60*t61*u11;
			f_udg[50*ng+i] = 0.0;
			f_udg[51*ng+i] = t2*t17*t22*u2*(-4.0/3.0);
			f_udg[52*ng+i] = -t2*t17*t22*u3;
			f_udg[53*ng+i] = t3*t4*t17*t22*(-4.0/3.0)-t4*t5*t17*t22-t2*t17*t50*t51*t126;
			f_udg[54*ng+i] = -mu[i]*t2*t17*t60*t61*u5;
			f_udg[55*ng+i] = 0.0;
			f_udg[56*ng+i] = -t2*t17*t22*u3;
			f_udg[57*ng+i] = t128;
			f_udg[58*ng+i] = t4*t17*t22*u2*u3*(-1.0/3.0);
			f_udg[59*ng+i] = 0.0;
			f_udg[60*ng+i] = 0.0;
			f_udg[61*ng+i] = t129;
			f_udg[62*ng+i] = 0.0;
			f_udg[63*ng+i] = t2*t17*t22*u2*(4.0/3.0)-t2*t17*t50*u2;
			f_udg[64*ng+i] = 0.0;
			f_udg[65*ng+i] = 0.0;
			f_udg[66*ng+i] = 0.0;
			f_udg[67*ng+i] = t16*t17*t22*(-2.0/3.0);
			f_udg[68*ng+i] = t2*t17*t22*u3*(-2.0/3.0);
			f_udg[69*ng+i] = 0.0;
			f_udg[70*ng+i] = 0.0;
			f_udg[71*ng+i] = 0.0;
			f_udg[72*ng+i] = t122;
			f_udg[73*ng+i] = t127-t2*t17*t50*u3;
			f_udg[74*ng+i] = 0.0;
			f_udg[75*ng+i] = 0.0;
			f_udg[76*ng+i] = t122;
			f_udg[77*ng+i] = 0.0;
			f_udg[78*ng+i] = t123;
			f_udg[79*ng+i] = 0.0;
			f_udg[80*ng+i] = 0.0;
			f_udg[81*ng+i] = 0.0;
			f_udg[82*ng+i] = 0.0;
			f_udg[83*ng+i] = t130;
			f_udg[84*ng+i] = 0.0;
			f_udg[85*ng+i] = 0.0;
			f_udg[86*ng+i] = 0.0;
			f_udg[87*ng+i] = 0.0;
			f_udg[88*ng+i] = 0.0;
			f_udg[89*ng+i] = 0.0;
			f_udg[90*ng+i] = 0.0;
			f_udg[91*ng+i] = 0.0;
			f_udg[92*ng+i] = 0.0;
			f_udg[93*ng+i] = 0.0;
			f_udg[94*ng+i] = t131;
			f_udg[95*ng+i] = 0.0;
			f_udg[96*ng+i] = 0.0;
			f_udg[97*ng+i] = 0.0;
			f_udg[98*ng+i] = 0.0;
			f_udg[99*ng+i] = 0.0;
			f_udg[100*ng+i] = 0.0;
			f_udg[101*ng+i] = t2*t17*t22*u3*(2.0/3.0);
			f_udg[102*ng+i] = -t123;
			f_udg[103*ng+i] = t4*t17*t22*u2*u3*(-1.0/3.0);
			f_udg[104*ng+i] = 0.0;
			f_udg[105*ng+i] = 0.0;
			f_udg[106*ng+i] = -t123;
			f_udg[107*ng+i] = t2*t17*t22*u3*(-4.0/3.0);
			f_udg[108*ng+i] = -t3*t4*t17*t22-t4*t5*t17*t22*(4.0/3.0)-t2*t17*t50*t51*t126;
			f_udg[109*ng+i] = -mu[i]*t2*t17*t60*t61*u5;
			f_udg[110*ng+i] = 0.0;
			f_udg[111*ng+i] = 0.0;
			f_udg[112*ng+i] = t122;
			f_udg[113*ng+i] = t127;
			f_udg[114*ng+i] = 0.0;
			f_udg[115*ng+i] = 0.0;
			f_udg[116*ng+i] = t122;
			f_udg[117*ng+i] = 0.0;
			f_udg[118*ng+i] = t123-t2*t17*t50*u2;
			f_udg[119*ng+i] = 0.0;
			f_udg[120*ng+i] = 0.0;
			f_udg[121*ng+i] = t16*t17*t22*(-2.0/3.0);
			f_udg[122*ng+i] = 0.0;
			f_udg[123*ng+i] = -t128;
			f_udg[124*ng+i] = 0.0;
			f_udg[125*ng+i] = 0.0;
			f_udg[126*ng+i] = 0.0;
			f_udg[127*ng+i] = t129;
			f_udg[128*ng+i] = t2*t17*t22*u3*(4.0/3.0)-t2*t17*t50*u3;
			f_udg[129*ng+i] = 0.0;
			f_udg[130*ng+i] = 0.0;
			f_udg[131*ng+i] = 0.0;
			f_udg[132*ng+i] = 0.0;
			f_udg[133*ng+i] = 0.0;
			f_udg[134*ng+i] = 0.0;
			f_udg[135*ng+i] = 0.0;
			f_udg[136*ng+i] = 0.0;
			f_udg[137*ng+i] = 0.0;
			f_udg[138*ng+i] = t130;
			f_udg[139*ng+i] = 0.0;
			f_udg[140*ng+i] = 0.0;
			f_udg[141*ng+i] = 0.0;
			f_udg[142*ng+i] = 0.0;
			f_udg[143*ng+i] = 0.0;
			f_udg[144*ng+i] = 0.0;
			f_udg[145*ng+i] = 0.0;
			f_udg[146*ng+i] = 0.0;
			f_udg[147*ng+i] = 0.0;
			f_udg[148*ng+i] = 0.0;
			f_udg[149*ng+i] = t131;
		}

		if (app.viscosityModel != 0) {

			for (int i = 0; i <ng; i++) {
				double x1 = pg[0*ng+i];
				double x2 = pg[1*ng+i];

				double u1 = udg[0*ng+i];
				double u2 = udg[1*ng+i];
				double u3 = udg[2*ng+i];
				double u4 = udg[3*ng+i];
				double u5 = udg[4*ng+i];
				double u6 = udg[5*ng+i];
				double u7 = udg[6*ng+i];
				double u8 = udg[7*ng+i];
				double u9 = udg[8*ng+i];
				double u10 = udg[9*ng+i];
				double u11 = udg[10*ng+i];
				double u12 = udg[11*ng+i];
				double u13 = udg[12*ng+i];
				double u14 = udg[13*ng+i];
				double u15 = udg[14*ng+i];

				double t2 = 1.0/u1;
				double t3 = 1.0/mu[i];
				double t6 = 1.0/3.141592653589793;
				double t7 = b*t3*u5;
				double t8 = atan(t7);
				double t9 = t6*t8;
				double t10 = t9+1.0/2.0;
				double t11 = t3*t10*u5;
				double t4 = c+t11;
				double t5 = t4*t4;
				double t12 = cv1*cv1;
				double t13 = 1.0/(mu[i]*mu[i]);
				double t14 = u5*u5;
				double t15 = cv1*t12+t4*t5;
				double t16 = 1.0/t15;
				double t17 = t5*t5;
				double t18 = t10*t13*u5;
				double t19 = 1.0/(mu[i]*mu[i]*mu[i]);
				double t20 = b*b;
				double t21 = t13*t14*t20;
				double t22 = t21+1.0;
				double t23 = 1.0/t22;
				double t24 = b*t6*t14*t19*t23;
				double t25 = t18+t24;
				double t26 = 1.0/param3;
				double t27 = t16*t17;
				double t28 = 1.0/(t15*t15);
				double t29 = mu[i]*t5*t17*t25*t28*3.0;
				double t46 = mu[i]*t4*t5*t16*t25*4.0;
				double t30 = t27+t29-t46+1.0;
				double t31 = 1.0/(u1*u1);
				double t47 = t2*u2*u6;
				double t32 = -t47+u7;
				double t41 = t2*u3*u6;
				double t33 = -t41+u8;
				double t34 = u2*u2;
				double t35 = t31*t34*(1.0/2.0);
				double t36 = u3*u3;
				double t37 = t31*t36*(1.0/2.0);
				double t38 = t35+t37;
				double t39 = param1-1.0;
				double t40 = 1.0/PrTurb;
				double t42 = t2*t33;
				double t53 = t2*u2*u11;
				double t43 = -t53+u12;
				double t44 = t2*t43;
				double t45 = t42+t44;
				double t48 = t2*t32*(4.0/3.0);
				double t55 = t2*u3*u11;
				double t49 = -t55+u13;
				double t50 = t48-t2*t49*(2.0/3.0);
				double t51 = 1.0/sigma;
				double t52 = u10-t2*u5*u6;
				double t54 = t26*t30*t45;
				double t56 = u4-t38*u1;
				double t57 = 1.0/t39;
				double t58 = 1.0/param4;
				double t59 = param1*t58;
				double t60 = param1*t16*t17*t40;
				double t61 = mu[i]*param1*t5*t17*t25*t28*t40*3.0;
				double t62 = t59+t60+t61-mu[i]*param1*t4*t5*t16*t25*t40*4.0;
				double t63 = t2*t32*(2.0/3.0);
				double t64 = t63-t2*t49*(4.0/3.0);
				double t65 = c+t11+1.0;
				double t66 = u15-t2*u5*u11;

				f_mu[0*ng+i] = 0.0;
				f_mu[1*ng+i] = t26*t30*t50;
				f_mu[2*ng+i] = t54;
				f_mu[3*ng+i] = t2*t26*t30*t45*u3+t2*t26*t30*t50*u2-t26*t31*t57*t62*(t39*u1*(-u9+t38*u6+u1*(t31*t32*u2+t31*t33*u3))+t39*t56*u6);
				f_mu[4*ng+i] = t2*t26*t51*t52*t65-mu[i]*t2*t25*t26*t51*t52;
				f_mu[5*ng+i] = 0.0;
				f_mu[6*ng+i] = t54;
				f_mu[7*ng+i] = -t26*t30*t64;
				f_mu[8*ng+i] = t2*t26*t30*t45*u2-t2*t26*t30*t64*u3-t26*t31*t57*t62*(t39*u1*(-u14+t38*u11+u1*(t31*t43*u2+t31*t49*u3))+t39*t56*u11);
				f_mu[9*ng+i] = t2*t26*t51*t65*t66-mu[i]*t2*t25*t26*t51*t66;
			}

			chainRule_f_udg(f_udg, f_mu, mu_udg, ng, nc, ncu, nd);
		}
        
//         for (int i = 0; i <ng*5*2*15; i++)
//             f_udg[i] /= param3;
	}

//	for (int i = 0; i <ng; i++) {
//		double x1 = pg[0*ng+i];
//		double x2 = pg[1*ng+i];
//
//		double u1 = udg[0*ng+i];
//		double u2 = udg[1*ng+i];
//		double u3 = udg[2*ng+i];
//		double u4 = udg[3*ng+i];
//		double u5 = udg[4*ng+i];
//		double u6 = udg[5*ng+i];
//		double u7 = udg[6*ng+i];
//		double u8 = udg[7*ng+i];
//		double u9 = udg[8*ng+i];
//		double u10 = udg[9*ng+i];
//		double u11 = udg[10*ng+i];
//		double u12 = udg[11*ng+i];
//		double u13 = udg[12*ng+i];
//		double u14 = udg[13*ng+i];
//		double u15 = udg[14*ng+i];
//
//		double t2 = u2*u2;
//		double t3 = 1.0/(u1*u1);
//		double t4 = 1.0/u1;
//		double t5 = 1.0/nu[i];
//		double t9 = 1.0/3.141592653589793;
//		double t10 = b*t4*t5*u5;
//		double t11 = atan(t10);
//		double t12 = t9*t11;
//		double t13 = t12+1.0/2.0;
//		double t14 = t4*t5*t13*u5;
//		double t6 = c+t14;
//		double t7 = t6*t6;
//		double t8 = cv1*cv1;
//		double t15 = 1.0/param3;
//		double t16 = cv1*t8+t6*t7;
//		double t17 = 1.0/t16;
//		double t18 = t7*t7;
//		double t19 = nu[i]*t17*t18;
//		double t20 = nu[i]+t19;
//		double t21 = t2*t3*(1.0/2.0);
//		double t22 = u3*u3;
//		double t23 = t3*t22*(1.0/2.0);
//		double t24 = t21+t23;
//		double t38 = t24*u1;
//		double t25 = -t38+u4;
//		double t26 = param1-1.0;
//		double t37 = t4*u3*u6;
//		double t27 = -t37+u8;
//		double t28 = t4*t27;
//		double t40 = t4*u2*u11;
//		double t29 = -t40+u12;
//		double t30 = t4*t29;
//		double t31 = t28+t30;
//		double t36 = t4*u2*u6;
//		double t32 = -t36+u7;
//		double t33 = t4*t32*(4.0/3.0);
//		double t44 = t4*u3*u11;
//		double t34 = -t44+u13;
//		double t35 = t33-t4*t34*(2.0/3.0);
//		double t39 = t4*u2*u3;
//		double t41 = t15*t20*t31*u1;
//		double t42 = t39+t41;
//		double t43 = t25*t26;
//		double t45 = t4*u4;
//		double t46 = t4*t25*t26;
//		double t47 = t45+t46;
//		double t48 = t4*t32*(2.0/3.0);
//		double t49 = t48-t4*t34*(4.0/3.0);
//		double t50 = 1.0/param4;
//		double t51 = nu[i]*param1*t50*u1;
//		double t52 = 1.0/PrTurb;
//		double t53 = nu[i]*param1*t17*t18*t52*u1;
//		double t54 = t51+t53;
//		double t55 = 1.0/t26;
//		double t56 = 1.0/sigma;
//		double t57 = c+t14+1.0;
//
//		f[0*ng+i] = u2;
//		f[1*ng+i] = t43+t2*t4+t15*t20*t35*u1;
//		f[2*ng+i] = t42;
//		f[3*ng+i] = t47*u2+t15*t20*t31*u3+t15*t20*t35*u2-t3*t15*t54*t55*(t26*u1*(-u9+t24*u6+u1*(t3*t27*u3+t3*t32*u2))+t25*t26*u6);
//		f[4*ng+i] = t4*u2*u5+nu[i]*t15*t56*t57*(u10-t4*u5*u6);
//		f[5*ng+i] = u3;
//		f[6*ng+i] = t42;
//		f[7*ng+i] = t43+t4*t22-t15*t20*t49*u1;
//		f[8*ng+i] = t47*u3+t15*t20*t31*u2-t15*t20*t49*u3-t3*t15*t54*t55*(t26*u1*(-u14+t24*u11+u1*(t3*t29*u2+t3*t34*u3))+t25*t26*u11);
//		f[9*ng+i] = t4*u3*u5+nu[i]*t15*t56*t57*(u15-t4*u5*u11);
//	}
//
//	if (computeJacobian == 1) {
//
//		for (int i = 0; i <ng; i++) {
//			double x1 = pg[0*ng+i];
//			double x2 = pg[1*ng+i];
//
//			double u1 = udg[0*ng+i];
//			double u2 = udg[1*ng+i];
//			double u3 = udg[2*ng+i];
//			double u4 = udg[3*ng+i];
//			double u5 = udg[4*ng+i];
//			double u6 = udg[5*ng+i];
//			double u7 = udg[6*ng+i];
//			double u8 = udg[7*ng+i];
//			double u9 = udg[8*ng+i];
//			double u10 = udg[9*ng+i];
//			double u11 = udg[10*ng+i];
//			double u12 = udg[11*ng+i];
//			double u13 = udg[12*ng+i];
//			double u14 = udg[13*ng+i];
//			double u15 = udg[14*ng+i];
//
//			double t2 = 1.0/(u1*u1);
//			double t3 = u2*u2;
//			double t4 = 1.0/(u1*u1*u1);
//			double t5 = u3*u3;
//			double t6 = 1.0/nu[i];
//			double t7 = 1.0/u1;
//			double t11 = 1.0/3.141592653589793;
//			double t12 = b*t6*t7*u5;
//			double t13 = atan(t12);
//			double t14 = t11*t13;
//			double t15 = t14+1.0/2.0;
//			double t16 = t6*t7*t15*u5;
//			double t8 = c+t16;
//			double t9 = t8*t8;
//			double t10 = cv1*cv1;
//			double t17 = 1.0/param3;
//			double t18 = cv1*t10+t8*t9;
//			double t19 = 1.0/t18;
//			double t20 = t9*t9;
//			double t21 = nu[i]*t19*t20;
//			double t22 = nu[i]+t21;
//			double t34 = t7*u2*u6;
//			double t23 = -t34+u7;
//			double t36 = t7*u3*u11;
//			double t24 = -t36+u13;
//			double t25 = 1.0/(nu[i]*nu[i]);
//			double t26 = u5*u5;
//			double t27 = t2*t6*t15*u5;
//			double t28 = b*b;
//			double t29 = t2*t25*t26*t28;
//			double t30 = t29+1.0;
//			double t31 = 1.0/t30;
//			double t32 = b*t4*t11*t25*t26*t31;
//			double t33 = t27+t32;
//			double t35 = t7*t23*(4.0/3.0);
//			double t62 = t7*t24*(2.0/3.0);
//			double t37 = t35-t62;
//			double t43 = t7*u3*u6;
//			double t38 = -t43+u8;
//			double t45 = t7*u2*u11;
//			double t39 = -t45+u12;
//			double t40 = nu[i]*t8*t9*t19*t33*4.0;
//			double t41 = 1.0/(t18*t18);
//			double t61 = nu[i]*t9*t20*t33*t41*3.0;
//			double t42 = t40-t61;
//			double t44 = t7*t38;
//			double t46 = t7*t39;
//			double t47 = t44+t46;
//			double t48 = t2*t3*(1.0/2.0);
//			double t49 = t2*t5*(1.0/2.0);
//			double t50 = param1-1.0;
//			double t51 = t3*t4;
//			double t52 = t4*t5;
//			double t53 = t51+t52;
//			double t77 = t53*u1;
//			double t54 = t48+t49-t77;
//			double t55 = t2*t38;
//			double t56 = t2*t39;
//			double t85 = t4*u3*u6;
//			double t86 = t4*u2*u11;
//			double t57 = t55+t56-t85-t86;
//			double t58 = t2*t23*(4.0/3.0);
//			double t59 = t4*u3*u11*(2.0/3.0);
//			double t60 = t58+t59-t2*t24*(2.0/3.0)-t4*u2*u6*(4.0/3.0);
//			double t63 = t48+t49;
//			double t80 = t63*u1;
//			double t64 = -t80+u4;
//			double t65 = 1.0/param4;
//			double t66 = nu[i]*param1*t65*u1;
//			double t67 = 1.0/PrTurb;
//			double t68 = nu[i]*param1*t19*t20*t67*u1;
//			double t69 = t66+t68;
//			double t70 = 1.0/t50;
//			double t71 = t63*u6;
//			double t72 = t2*t23*u2;
//			double t73 = t2*t38*u3;
//			double t74 = t72+t73;
//			double t75 = t74*u1;
//			double t76 = t71+t75-u9;
//			double t78 = 1.0/(u1*u1*u1*u1);
//			double t79 = t50*t76*u1;
//			double t81 = t50*t64*u6;
//			double t82 = t79+t81;
//			double t83 = 1.0/sigma;
//			double t84 = t17*t22*t47;
//			double t87 = t84-t2*u2*u3-t17*t22*t57*u1-t17*t42*t47*u1;
//			double t88 = t7*t23*(2.0/3.0);
//			double t97 = t7*t24*(4.0/3.0);
//			double t89 = t88-t97;
//			double t90 = t2*u4;
//			double t91 = t2*t50*t64;
//			double t92 = t7*t50*t54;
//			double t93 = t90+t91+t92;
//			double t94 = t2*t23*(2.0/3.0);
//			double t95 = t4*u3*u11*(4.0/3.0);
//			double t96 = t94+t95-t2*t24*(4.0/3.0)-t4*u2*u6*(2.0/3.0);
//			double t98 = t63*u11;
//			double t99 = t2*t39*u2;
//			double t100 = t2*t24*u3;
//			double t101 = t99+t100;
//			double t102 = t101*u1;
//			double t103 = t98+t102-u14;
//			double t104 = t50*t103*u1;
//			double t105 = t50*t64*u11;
//			double t106 = t104+t105;
//			double t107 = nu[i]*param1*t65;
//			double t108 = nu[i]*param1*t19*t20*t67;
//			double t109 = nu[i]*param1*t9*t20*t33*t41*t67*u1*3.0;
//			double t110 = t107+t108+t109-nu[i]*param1*t8*t9*t19*t33*t67*u1*4.0;
//			double t111 = c+t16+1.0;
//			double t112 = t17*t22*t37;
//			double t113 = t7*u3;
//			double t114 = t113-t7*t17*t22*u11;
//			double t115 = t7*u2;
//			double t116 = t115-t7*t17*t22*u6;
//			double t117 = t7*u4;
//			double t118 = t7*t50*t64;
//			double t119 = t7*u5;
//			double t120 = t7*t50;
//			double t121 = t7+t120;
//			double t122 = t6*t7*t15;
//			double t123 = b*t2*t11*t25*t31*u5;
//			double t124 = t122+t123;
//			double t125 = nu[i]*t8*t9*t19*t124*4.0;
//			double t127 = nu[i]*t9*t20*t41*t124*3.0;
//			double t126 = t125-t127;
//			double t128 = u10-t7*u5*u6;
//			double t129 = t17*t47*t126*u1;
//			double t130 = nu[i]*param1*t8*t9*t19*t67*t124*u1*4.0;
//			double t131 = t130-nu[i]*param1*t9*t20*t41*t67*t124*u1*3.0;
//			double t132 = u15-t7*u5*u11;
//			double t133 = t17*t22;
//			double t134 = t7*t17*t22*u2;
//			double t135 = t50*t64;
//			double t136 = t50*t54*u1;
//			double t137 = t135+t136;
//			double t138 = t7*t17*t22*u3;
//			double t139 = t7*t17*t22*u2*(2.0/3.0);
//			double t140 = t17*t22*(4.0/3.0);
//			double t141 = t7*t17*t69;
//			double t142 = nu[i]*t17*t83*t111;
//
//			f_udg[0*ng+i] = 0.0;
//			f_udg[1*ng+i] = t112-t2*t3-t50*t54-t17*t37*t42*u1-t17*t22*t60*u1;
//			f_udg[2*ng+i] = t87;
//			f_udg[3*ng+i] = -t93*u2-t17*t37*t42*u2-t17*t22*t57*u3-t17*t22*t60*u2-t17*t42*t47*u3-t2*t17*t69*t70*(t50*t76-t50*t54*u6+t50*u1*(t72+t73-u1*(t4*t23*u2*2.0+t4*t38*u3*2.0-t3*t78*u6-t5*t78*u6)-t53*u6))+t4*t17*t69*t70*t82*2.0-t2*t17*t70*t82*t110;
//			f_udg[4*ng+i] = -t2*u2*u5-nu[i]*t17*t33*t83*t128+nu[i]*t2*t17*t83*t111*u5*u6;
//			f_udg[5*ng+i] = 0.0;
//			f_udg[6*ng+i] = t87;
//			f_udg[7*ng+i] = -t2*t5-t50*t54-t17*t22*t89+t17*t22*t96*u1+t17*t42*t89*u1;
//			f_udg[8*ng+i] = -t93*u3-t17*t22*t57*u2-t17*t42*t47*u2+t17*t22*t96*u3+t17*t42*t89*u3-t2*t17*t69*t70*(t50*t103-t50*t54*u11+t50*u1*(t99+t100-u1*(t4*t24*u3*2.0+t4*t39*u2*2.0-t3*t78*u11-t5*t78*u11)-t53*u11))+t4*t17*t69*t70*t106*2.0-t2*t17*t70*t106*t110;
//			f_udg[9*ng+i] = -t2*u3*u5-nu[i]*t17*t33*t83*t132+nu[i]*t2*t17*t83*t111*u5*u11;
//			f_udg[10*ng+i] = 1.0;
//			f_udg[11*ng+i] = t7*u2*2.0-t7*t50*u2-t7*t17*t22*u6*(4.0/3.0);
//			f_udg[12*ng+i] = t114;
//			f_udg[13*ng+i] = t112+t117+t118-t2*t3*t50-t2*t17*t69*t70*(t50*u1*(u1*(t2*t23-t4*u2*u6)+t2*u2*u6)-t7*t50*u2*u6)-t2*t17*t22*u2*u6*(4.0/3.0)-t2*t17*t22*u3*u11;
//			f_udg[14*ng+i] = t119;
//			f_udg[15*ng+i] = 0.0;
//			f_udg[16*ng+i] = t114;
//			f_udg[17*ng+i] = -t7*t50*u2+t7*t17*t22*u6*(2.0/3.0);
//			f_udg[18*ng+i] = t84-t2*t50*u2*u3-t2*t17*t69*t70*(t50*u1*(u1*(t56-t86)+t2*u2*u11)-t7*t50*u2*u11)+t2*t17*t22*u3*u6*(2.0/3.0)-t2*t17*t22*u2*u11;
//			f_udg[19*ng+i] = 0.0;
//			f_udg[20*ng+i] = 0.0;
//			f_udg[21*ng+i] = -t7*t50*u3+t7*t17*t22*u11*(2.0/3.0);
//			f_udg[22*ng+i] = t116;
//			f_udg[23*ng+i] = t84-t2*t50*u2*u3-t2*t17*t69*t70*(t50*u1*(u1*(t55-t85)+t2*u3*u6)-t7*t50*u3*u6)-t2*t17*t22*u3*u6+t2*t17*t22*u2*u11*(2.0/3.0);
//			f_udg[24*ng+i] = 0.0;
//			f_udg[25*ng+i] = 1.0;
//			f_udg[26*ng+i] = t116;
//			f_udg[27*ng+i] = t7*u3*2.0-t7*t50*u3-t7*t17*t22*u11*(4.0/3.0);
//			f_udg[28*ng+i] = t117+t118-t2*t5*t50-t17*t22*t89-t2*t17*t69*t70*(t50*u1*(u1*(t2*t24-t4*u3*u11)+t2*u3*u11)-t7*t50*u3*u11)-t2*t17*t22*u2*u6-t2*t17*t22*u3*u11*(4.0/3.0);
//			f_udg[29*ng+i] = t119;
//			f_udg[30*ng+i] = 0.0;
//			f_udg[31*ng+i] = t50;
//			f_udg[32*ng+i] = 0.0;
//			f_udg[33*ng+i] = t121*u2-t2*t17*t69*u6;
//			f_udg[34*ng+i] = 0.0;
//			f_udg[35*ng+i] = 0.0;
//			f_udg[36*ng+i] = 0.0;
//			f_udg[37*ng+i] = t50;
//			f_udg[38*ng+i] = t121*u3-t2*t17*t69*u11;
//			f_udg[39*ng+i] = 0.0;
//			f_udg[40*ng+i] = 0.0;
//			f_udg[41*ng+i] = t17*t37*t126*u1;
//			f_udg[42*ng+i] = t129;
//			f_udg[43*ng+i] = t17*t37*t126*u2+t17*t47*t126*u3-t2*t17*t70*t82*t131;
//			f_udg[44*ng+i] = t115+nu[i]*t17*t83*t124*t128-nu[i]*t7*t17*t83*t111*u6;
//			f_udg[45*ng+i] = 0.0;
//			f_udg[46*ng+i] = t129;
//			f_udg[47*ng+i] = -t17*t89*t126*u1;
//			f_udg[48*ng+i] = t17*t47*t126*u2-t17*t89*t126*u3-t2*t17*t70*t106*t131;
//			f_udg[49*ng+i] = t113+nu[i]*t17*t83*t124*t132-nu[i]*t7*t17*t83*t111*u11;
//			f_udg[50*ng+i] = 0.0;
//			f_udg[51*ng+i] = t7*t17*t22*u2*(-4.0/3.0);
//			f_udg[52*ng+i] = -t7*t17*t22*u3;
//			f_udg[53*ng+i] = t2*t3*t17*t22*(-4.0/3.0)-t2*t5*t17*t22-t2*t17*t69*t70*t137;
//			f_udg[54*ng+i] = -nu[i]*t7*t17*t83*t111*u5;
//			f_udg[55*ng+i] = 0.0;
//			f_udg[56*ng+i] = -t7*t17*t22*u3;
//			f_udg[57*ng+i] = t139;
//			f_udg[58*ng+i] = t2*t17*t22*u2*u3*(-1.0/3.0);
//			f_udg[59*ng+i] = 0.0;
//			f_udg[60*ng+i] = 0.0;
//			f_udg[61*ng+i] = t140;
//			f_udg[62*ng+i] = 0.0;
//			f_udg[63*ng+i] = t7*t17*t22*u2*(4.0/3.0)-t2*t17*t69*u2;
//			f_udg[64*ng+i] = 0.0;
//			f_udg[65*ng+i] = 0.0;
//			f_udg[66*ng+i] = 0.0;
//			f_udg[67*ng+i] = t17*t22*(-2.0/3.0);
//			f_udg[68*ng+i] = t7*t17*t22*u3*(-2.0/3.0);
//			f_udg[69*ng+i] = 0.0;
//			f_udg[70*ng+i] = 0.0;
//			f_udg[71*ng+i] = 0.0;
//			f_udg[72*ng+i] = t133;
//			f_udg[73*ng+i] = t138-t2*t17*t69*u3;
//			f_udg[74*ng+i] = 0.0;
//			f_udg[75*ng+i] = 0.0;
//			f_udg[76*ng+i] = t133;
//			f_udg[77*ng+i] = 0.0;
//			f_udg[78*ng+i] = t134;
//			f_udg[79*ng+i] = 0.0;
//			f_udg[80*ng+i] = 0.0;
//			f_udg[81*ng+i] = 0.0;
//			f_udg[82*ng+i] = 0.0;
//			f_udg[83*ng+i] = t141;
//			f_udg[84*ng+i] = 0.0;
//			f_udg[85*ng+i] = 0.0;
//			f_udg[86*ng+i] = 0.0;
//			f_udg[87*ng+i] = 0.0;
//			f_udg[88*ng+i] = 0.0;
//			f_udg[89*ng+i] = 0.0;
//			f_udg[90*ng+i] = 0.0;
//			f_udg[91*ng+i] = 0.0;
//			f_udg[92*ng+i] = 0.0;
//			f_udg[93*ng+i] = 0.0;
//			f_udg[94*ng+i] = t142;
//			f_udg[95*ng+i] = 0.0;
//			f_udg[96*ng+i] = 0.0;
//			f_udg[97*ng+i] = 0.0;
//			f_udg[98*ng+i] = 0.0;
//			f_udg[99*ng+i] = 0.0;
//			f_udg[100*ng+i] = 0.0;
//			f_udg[101*ng+i] = t7*t17*t22*u3*(2.0/3.0);
//			f_udg[102*ng+i] = -t134;
//			f_udg[103*ng+i] = t2*t17*t22*u2*u3*(-1.0/3.0);
//			f_udg[104*ng+i] = 0.0;
//			f_udg[105*ng+i] = 0.0;
//			f_udg[106*ng+i] = -t134;
//			f_udg[107*ng+i] = t7*t17*t22*u3*(-4.0/3.0);
//			f_udg[108*ng+i] = -t2*t3*t17*t22-t2*t5*t17*t22*(4.0/3.0)-t2*t17*t69*t70*t137;
//			f_udg[109*ng+i] = -nu[i]*t7*t17*t83*t111*u5;
//			f_udg[110*ng+i] = 0.0;
//			f_udg[111*ng+i] = 0.0;
//			f_udg[112*ng+i] = t133;
//			f_udg[113*ng+i] = t138;
//			f_udg[114*ng+i] = 0.0;
//			f_udg[115*ng+i] = 0.0;
//			f_udg[116*ng+i] = t133;
//			f_udg[117*ng+i] = 0.0;
//			f_udg[118*ng+i] = t134-t2*t17*t69*u2;
//			f_udg[119*ng+i] = 0.0;
//			f_udg[120*ng+i] = 0.0;
//			f_udg[121*ng+i] = t17*t22*(-2.0/3.0);
//			f_udg[122*ng+i] = 0.0;
//			f_udg[123*ng+i] = -t139;
//			f_udg[124*ng+i] = 0.0;
//			f_udg[125*ng+i] = 0.0;
//			f_udg[126*ng+i] = 0.0;
//			f_udg[127*ng+i] = t140;
//			f_udg[128*ng+i] = t7*t17*t22*u3*(4.0/3.0)-t2*t17*t69*u3;
//			f_udg[129*ng+i] = 0.0;
//			f_udg[130*ng+i] = 0.0;
//			f_udg[131*ng+i] = 0.0;
//			f_udg[132*ng+i] = 0.0;
//			f_udg[133*ng+i] = 0.0;
//			f_udg[134*ng+i] = 0.0;
//			f_udg[135*ng+i] = 0.0;
//			f_udg[136*ng+i] = 0.0;
//			f_udg[137*ng+i] = 0.0;
//			f_udg[138*ng+i] = t141;
//			f_udg[139*ng+i] = 0.0;
//			f_udg[140*ng+i] = 0.0;
//			f_udg[141*ng+i] = 0.0;
//			f_udg[142*ng+i] = 0.0;
//			f_udg[143*ng+i] = 0.0;
//			f_udg[144*ng+i] = 0.0;
//			f_udg[145*ng+i] = 0.0;
//			f_udg[146*ng+i] = 0.0;
//			f_udg[147*ng+i] = 0.0;
//			f_udg[148*ng+i] = 0.0;
//			f_udg[149*ng+i] = t142;
//		}
//
//		if (app.viscosityModel != 0) {
//
//			for (int i = 0; i <ng; i++) {
//				double x1 = pg[0*ng+i];
//				double x2 = pg[1*ng+i];
//
//				double u1 = udg[0*ng+i];
//				double u2 = udg[1*ng+i];
//				double u3 = udg[2*ng+i];
//				double u4 = udg[3*ng+i];
//				double u5 = udg[4*ng+i];
//				double u6 = udg[5*ng+i];
//				double u7 = udg[6*ng+i];
//				double u8 = udg[7*ng+i];
//				double u9 = udg[8*ng+i];
//				double u10 = udg[9*ng+i];
//				double u11 = udg[10*ng+i];
//				double u12 = udg[11*ng+i];
//				double u13 = udg[12*ng+i];
//				double u14 = udg[13*ng+i];
//				double u15 = udg[14*ng+i];
//
//				double t2 = 1.0/u1;
//				double t3 = 1.0/nu[i];
//				double t7 = 1.0/3.141592653589793;
//				double t8 = b*t2*t3*u5;
//				double t9 = atan(t8);
//				double t10 = t7*t9;
//				double t11 = t10+1.0/2.0;
//				double t12 = t2*t3*t11*u5;
//				double t4 = c+t12;
//				double t5 = t4*t4;
//				double t6 = cv1*cv1;
//				double t13 = cv1*t6+t4*t5;
//				double t14 = 1.0/t13;
//				double t15 = 1.0/(nu[i]*nu[i]);
//				double t16 = 1.0/(u1*u1);
//				double t17 = u5*u5;
//				double t18 = t2*t11*t15*u5;
//				double t19 = 1.0/(nu[i]*nu[i]*nu[i]);
//				double t20 = b*b;
//				double t21 = t15*t16*t17*t20;
//				double t22 = t21+1.0;
//				double t23 = 1.0/t22;
//				double t24 = b*t7*t16*t17*t19*t23;
//				double t25 = t18+t24;
//				double t26 = t5*t5;
//				double t27 = 1.0/param3;
//				double t28 = t14*t26;
//				double t29 = 1.0/(t13*t13);
//				double t30 = nu[i]*t5*t25*t26*t29*3.0;
//				double t37 = nu[i]*t4*t5*t14*t25*4.0;
//				double t31 = t28+t30-t37+1.0;
//				double t43 = t2*u3*u6;
//				double t32 = -t43+u8;
//				double t33 = t2*t32;
//				double t53 = t2*u2*u11;
//				double t34 = -t53+u12;
//				double t35 = t2*t34;
//				double t36 = t33+t35;
//				double t42 = t2*u2*u6;
//				double t38 = -t42+u7;
//				double t39 = t2*t38*(4.0/3.0);
//				double t55 = t2*u3*u11;
//				double t40 = -t55+u13;
//				double t41 = t39-t2*t40*(2.0/3.0);
//				double t44 = u2*u2;
//				double t45 = t16*t44*(1.0/2.0);
//				double t46 = u3*u3;
//				double t47 = t16*t46*(1.0/2.0);
//				double t48 = t45+t47;
//				double t49 = param1-1.0;
//				double t50 = 1.0/PrTurb;
//				double t51 = 1.0/sigma;
//				double t52 = u10-t2*u5*u6;
//				double t54 = t27*t31*t36*u1;
//				double t56 = t2*t38*(2.0/3.0);
//				double t57 = t56-t2*t40*(4.0/3.0);
//				double t58 = u4-t48*u1;
//				double t59 = 1.0/t49;
//				double t60 = 1.0/param4;
//				double t61 = param1*t60*u1;
//				double t62 = param1*t14*t26*t50*u1;
//				double t63 = nu[i]*param1*t5*t25*t26*t29*t50*u1*3.0;
//				double t64 = t61+t62+t63-nu[i]*param1*t4*t5*t14*t25*t50*u1*4.0;
//				double t65 = c+t12+1.0;
//				double t66 = u15-t2*u5*u11;
//
//				f_nu[0*ng+i] = 0.0;
//				f_nu[1*ng+i] = t27*t31*t41*u1;
//				f_nu[2*ng+i] = t54;
//				f_nu[3*ng+i] = t27*t31*t36*u3+t27*t31*t41*u2-t16*t27*t59*t64*(t49*u1*(-u9+t48*u6+u1*(t16*t32*u3+t16*t38*u2))+t49*t58*u6);
//				f_nu[4*ng+i] = t27*t51*t52*t65-nu[i]*t25*t27*t51*t52;
//				f_nu[5*ng+i] = 0.0;
//				f_nu[6*ng+i] = t54;
//				f_nu[7*ng+i] = -t27*t31*t57*u1;
//				f_nu[8*ng+i] = t27*t31*t36*u2-t27*t31*t57*u3-t16*t27*t59*t64*(t49*u1*(-u14+t48*u11+u1*(t16*t34*u2+t16*t40*u3))+t49*t58*u11);
//				f_nu[9*ng+i] = t27*t51*t65*t66-nu[i]*t25*t27*t51*t66;
//			}
//
//			chainRule_f_udg(f_udg, f_nu, nu_udg, ng, nc, ncu, nd);
//		}
//	}
    
	/* Deallocate dynamic memory */
	delete[] mu;
	if (computeJacobian == 1 && app.viscosityModel != 0) {
		delete[] mu_udg;
		delete[] f_mu;
	}
}
