
#define PI (3.141592653589793)

// Written by: C. Nguyen & P. Fernandez

void flux_ransSA3dNEW(double *f, double *f_udg, double *pg, double *udg, appstruct &app, double *param,
				   double time, int ng, int nc, int ncu, int nd, int ncd, int computeJacobian)
{
	double param1 = param[0];
	double param2 = param[1];
	double param3 = param[2];
	double param4 = param[3];
	double param5 = param[4];
	double param6 = param[5];

	/* Allocate dynamic memory */
	double * mu  = new double [ng];
	double * mu_udg;
	double * f_mu;
	if (computeJacobian == 1 && app.viscosityModel != 0) {
		mu_udg = new double [ng * nc];
		f_mu = new double [ng * ncu * nd];
	}

	double PrTurb = 0.9;
	double sigma = 2.0/3.0;
	double cv1 = 7.1;

	// SA regularization parameters (Ref. Hemant Chaurasia PhD Thesis):
	double b = 100.0;
	double c = 1.0/2.0 - atan(b)/PI;

	getViscosity(mu, mu_udg, pg, udg, param, app.viscosityModel, ng, nc, ncu, nd, computeJacobian);


	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double x3 = pg[2*ng+i];

		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];
		double u10 = udg[9*ng+i];
		double u11 = udg[10*ng+i];
		double u12 = udg[11*ng+i];
		double u13 = udg[12*ng+i];
		double u14 = udg[13*ng+i];
		double u15 = udg[14*ng+i];
		double u16 = udg[15*ng+i];
		double u17 = udg[16*ng+i];
		double u18 = udg[17*ng+i];
		double u19 = udg[18*ng+i];
		double u20 = udg[19*ng+i];
		double u21 = udg[20*ng+i];
		double u22 = udg[21*ng+i];
		double u23 = udg[22*ng+i];
		double u24 = udg[23*ng+i];

		double t2 = u2*u2;
		double t3 = 1.0/(u1*u1);
		double t4 = 1.0/mu[i];
		double t7 = 1.0/3.141592653589793;
		double t8 = b*t4*u6;
		double t9 = atan(t8);
		double t10 = t7*t9;
		double t11 = t10+1.0/2.0;
		double t12 = t4*t11*u6;
		double t5 = c+t12;
		double t6 = t5*t5;
		double t13 = cv1*cv1;
		double t14 = 1.0/u1;
		double t15 = 1.0/param3;
		double t16 = t6*t6;
		double t17 = cv1*t13+t5*t6;
		double t18 = 1.0/t17;
		double t19 = mu[i]*t16*t18;
		double t20 = mu[i]+t19;
		double t21 = t2*t3*(1.0/2.0);
		double t22 = u3*u3;
		double t23 = t3*t22*(1.0/2.0);
		double t24 = u4*u4;
		double t25 = t3*t24*(1.0/2.0);
		double t26 = t21+t23+t25;
		double t42 = t26*u1;
		double t27 = -t42+u5;
		double t28 = param1-1.0;
		double t40 = t14*u3*u7;
		double t29 = -t40+u9;
		double t30 = t14*t29;
		double t50 = t14*u2*u13;
		double t31 = -t50+u14;
		double t32 = t14*t31;
		double t33 = t30+t32;
		double t41 = t14*u4*u7;
		double t34 = -t41+u10;
		double t35 = t14*t34;
		double t76 = t14*u2*u19;
		double t36 = -t76+u20;
		double t37 = t14*t36;
		double t38 = t35+t37;
		double t43 = t14*u2*u7;
		double t39 = -t43+u8;
		double t54 = t14*u3*u13;
		double t44 = -t54+u15;
		double t45 = t14*t44*(2.0/3.0);
		double t55 = t14*u4*u19;
		double t46 = -t55+u22;
		double t47 = t14*t46*(2.0/3.0);
		double t48 = t45+t47-t14*t39*(4.0/3.0);
		double t49 = t14*u2*u3;
		double t51 = t15*t20*t33;
		double t52 = t49+t51;
		double t53 = t27*t28;
		double t56 = t14*u5;
		double t57 = t14*t27*t28;
		double t58 = t56+t57;
		double t69 = t14*u4*u13;
		double t59 = -t69+u16;
		double t60 = t14*t59;
		double t80 = t14*u3*u19;
		double t61 = -t80+u21;
		double t62 = t14*t61;
		double t63 = t60+t62;
		double t64 = 1.0/param4;
		double t65 = mu[i]*param1*t64;
		double t66 = 1.0/PrTurb;
		double t67 = mu[i]*param1*t16*t18*t66;
		double t68 = t65+t67;
		double t70 = 1.0/t28;
		double t71 = t14*t39*(2.0/3.0);
		double t72 = t47+t71-t14*t44*(4.0/3.0);
		double t73 = 1.0/sigma;
		double t74 = c+t12+1.0;
		double t75 = t14*u2*u4;
		double t77 = t15*t20*t38;
		double t78 = t75+t77;
		double t79 = t14*u3*u4;
		double t81 = t15*t20*t63;
		double t82 = t79+t81;
		double t83 = t45+t71-t14*t46*(4.0/3.0);

		f[0*ng+i] = u2;
		f[1*ng+i] = t53+t2*t14-t15*t20*t48;
		f[2*ng+i] = t52;
		f[3*ng+i] = t78;
		f[4*ng+i] = t58*u2-t3*t15*t68*t70*(t28*u1*(-u11+t26*u7+u1*(t3*t29*u3+t3*t34*u4+t3*t39*u2))+t27*t28*u7)+t14*t15*t20*t33*u3+t14*t15*t20*t38*u4-t14*t15*t20*t48*u2;
		f[5*ng+i] = t14*u2*u6+mu[i]*t14*t15*t73*t74*(u12-t14*u6*u7);
		f[6*ng+i] = u3;
		f[7*ng+i] = t52;
		f[8*ng+i] = t53+t14*t22-t15*t20*t72;
		f[9*ng+i] = t82;
		f[10*ng+i] = t58*u3-t3*t15*t68*t70*(t28*u1*(-u17+t26*u13+u1*(t3*t31*u2+t3*t44*u3+t3*t59*u4))+t27*t28*u13)+t14*t15*t20*t33*u2+t14*t15*t20*t63*u4-t14*t15*t20*t72*u3;
		f[11*ng+i] = t14*u3*u6+mu[i]*t14*t15*t73*t74*(u18-t14*u6*u13);
		f[12*ng+i] = u4;
		f[13*ng+i] = t78;
		f[14*ng+i] = t82;
		f[15*ng+i] = t53+t14*t24-t15*t20*t83;
		f[16*ng+i] = t58*u4-t3*t15*t68*t70*(t28*u1*(-u23+t26*u19+u1*(t3*t36*u2+t3*t46*u4+t3*t61*u3))+t27*t28*u19)+t14*t15*t20*t38*u2+t14*t15*t20*t63*u3-t14*t15*t20*t83*u4;
		f[17*ng+i] = t14*u4*u6+mu[i]*t14*t15*t73*t74*(u24-t14*u6*u19);
	}
    
//     for (int i = 0; i <ng*6*3; i++)
//         f[i] /= param3;

	if (computeJacobian == 1) {

		for (int i = 0; i <ng; i++) {
			double x1 = pg[0*ng+i];
			double x2 = pg[1*ng+i];
			double x3 = pg[2*ng+i];

			double u1 = udg[0*ng+i];
			double u2 = udg[1*ng+i];
			double u3 = udg[2*ng+i];
			double u4 = udg[3*ng+i];
			double u5 = udg[4*ng+i];
			double u6 = udg[5*ng+i];
			double u7 = udg[6*ng+i];
			double u8 = udg[7*ng+i];
			double u9 = udg[8*ng+i];
			double u10 = udg[9*ng+i];
			double u11 = udg[10*ng+i];
			double u12 = udg[11*ng+i];
			double u13 = udg[12*ng+i];
			double u14 = udg[13*ng+i];
			double u15 = udg[14*ng+i];
			double u16 = udg[15*ng+i];
			double u17 = udg[16*ng+i];
			double u18 = udg[17*ng+i];
			double u19 = udg[18*ng+i];
			double u20 = udg[19*ng+i];
			double u21 = udg[20*ng+i];
			double u22 = udg[21*ng+i];
			double u23 = udg[22*ng+i];
			double u24 = udg[23*ng+i];

			double t2 = 1.0/(u1*u1);
			double t3 = u2*u2;
			double t4 = 1.0/(u1*u1*u1);
			double t5 = u3*u3;
			double t6 = u4*u4;
			double t7 = 1.0/mu[i];
			double t10 = 1.0/3.141592653589793;
			double t11 = b*t7*u6;
			double t12 = atan(t11);
			double t13 = t10*t12;
			double t14 = t13+1.0/2.0;
			double t15 = t7*t14*u6;
			double t8 = c+t15;
			double t9 = t8*t8;
			double t16 = cv1*cv1;
			double t17 = 1.0/u1;
			double t18 = 1.0/param3;
			double t19 = t9*t9;
			double t20 = cv1*t16+t8*t9;
			double t21 = 1.0/t20;
			double t22 = mu[i]*t19*t21;
			double t23 = mu[i]+t22;
			double t24 = t2*t3*(1.0/2.0);
			double t25 = t2*t5*(1.0/2.0);
			double t26 = t2*t6*(1.0/2.0);
			double t27 = param1-1.0;
			double t28 = t3*t4;
			double t29 = t4*t5;
			double t30 = t4*t6;
			double t31 = t28+t29+t30;
			double t37 = t31*u1;
			double t32 = t24+t25+t26-t37;
			double t39 = t17*u2*u7;
			double t33 = -t39+u8;
			double t40 = t17*u3*u7;
			double t34 = -t40+u9;
			double t41 = t17*u4*u7;
			double t35 = -t41+u10;
			double t36 = t24+t25+t26;
			double t38 = 1.0/(u1*u1*u1*u1);
			double t42 = t2*t33*u2;
			double t43 = t2*t34*u3;
			double t44 = t2*t35*u4;
			double t61 = t17*u2*u13;
			double t45 = -t61+u14;
			double t65 = t17*u2*u19;
			double t46 = -t65+u20;
			double t47 = 1.0/param4;
			double t48 = mu[i]*param1*t47;
			double t49 = 1.0/PrTurb;
			double t50 = mu[i]*param1*t19*t21*t49;
			double t51 = t48+t50;
			double t52 = t42+t43+t44;
			double t53 = t52*u1;
			double t54 = t36*u7;
			double t55 = t53+t54-u11;
			double t81 = t36*u1;
			double t56 = -t81+u5;
			double t57 = 1.0/t27;
			double t69 = t17*u3*u13;
			double t58 = -t69+u15;
			double t70 = t17*u4*u19;
			double t59 = -t70+u22;
			double t60 = t2*t34;
			double t62 = t2*t45;
			double t76 = t4*u3*u7;
			double t77 = t4*u2*u13;
			double t63 = t60+t62-t76-t77;
			double t64 = t2*t35;
			double t66 = t2*t46;
			double t106 = t4*u4*u7;
			double t107 = t4*u2*u19;
			double t67 = t64+t66-t106-t107;
			double t68 = t2*t33*(4.0/3.0);
			double t71 = t4*u3*u13*(2.0/3.0);
			double t72 = t4*u4*u19*(2.0/3.0);
			double t79 = t2*t59*(2.0/3.0);
			double t113 = t2*t58*(2.0/3.0);
			double t73 = t68+t71+t72-t79-t113-t4*u2*u7*(4.0/3.0);
			double t74 = 1.0/sigma;
			double t75 = c+t15+1.0;
			double t78 = -t18*t23*t63-t2*u2*u3;
			double t80 = t2*u5;
			double t82 = t2*t27*t56;
			double t83 = t17*t27*t32;
			double t84 = t80+t82+t83;
			double t86 = t17*u4*u13;
			double t85 = -t86+u16;
			double t87 = t2*t45*u2;
			double t88 = t2*t58*u3;
			double t89 = t2*t85*u4;
			double t90 = t17*t34;
			double t91 = t17*t45;
			double t92 = t90+t91;
			double t100 = t17*u3*u19;
			double t93 = -t100+u21;
			double t94 = t87+t88+t89;
			double t95 = t94*u1;
			double t96 = t36*u13;
			double t97 = t95+t96-u17;
			double t98 = t17*t59*(2.0/3.0);
			double t99 = t2*t85;
			double t101 = t2*t93;
			double t109 = t4*u4*u13;
			double t110 = t4*u3*u19;
			double t102 = t99+t101-t109-t110;
			double t103 = t2*t58*(4.0/3.0);
			double t104 = t4*u2*u7*(2.0/3.0);
			double t112 = t2*t33*(2.0/3.0);
			double t105 = t72-t79+t103+t104-t112-t4*u3*u13*(4.0/3.0);
			double t108 = -t18*t23*t67-t2*u2*u4;
			double t111 = -t18*t23*t102-t2*u3*u4;
			double t114 = t2*t46*u2;
			double t115 = t2*t93*u3;
			double t116 = t2*t59*u4;
			double t117 = t17*t35;
			double t118 = t17*t46;
			double t119 = t117+t118;
			double t120 = t17*t85;
			double t121 = t17*t93;
			double t122 = t120+t121;
			double t123 = t114+t115+t116;
			double t124 = t123*u1;
			double t125 = t36*u19;
			double t126 = t124+t125-u23;
			double t127 = t17*t33*(2.0/3.0);
			double t128 = t17*t58*(2.0/3.0);
			double t129 = t2*t59*(4.0/3.0);
			double t130 = t71+t104-t112-t113+t129-t4*u4*u19*(4.0/3.0);
			double t167 = t17*t33*(4.0/3.0);
			double t131 = t98+t128-t167;
			double t132 = t17*u3;
			double t152 = t2*t18*t23*u13;
			double t133 = t132-t152;
			double t134 = t17*u4;
			double t141 = t2*t18*t23*u19;
			double t135 = t134-t141;
			double t136 = t2*t18*t23*u7*(2.0/3.0);
			double t137 = t136-t17*t27*u2;
			double t138 = t17*t18*t23*t92;
			double t139 = t17*u2;
			double t148 = t2*t18*t23*u7;
			double t140 = t139-t148;
			double t142 = t17*u5;
			double t143 = t17*t27*t56;
			double t177 = t17*t58*(4.0/3.0);
			double t144 = t98+t127-t177;
			double t145 = t17*u6;
			double t146 = t2*t18*t23*u13*(2.0/3.0);
			double t147 = t146-t17*t27*u3;
			double t149 = t17*t18*t23*t119;
			double t150 = t2*t18*t23*u19*(2.0/3.0);
			double t154 = t17*t27*u4;
			double t151 = t150-t154;
			double t153 = t17*t18*t23*t122;
			double t186 = t17*t59*(4.0/3.0);
			double t155 = t127+t128-t186;
			double t156 = t17*t27;
			double t157 = t17+t156;
			double t158 = 1.0/(mu[i]*mu[i]);
			double t159 = t7*t14;
			double t160 = b*b;
			double t161 = u6*u6;
			double t162 = t158*t160*t161;
			double t163 = t162+1.0;
			double t164 = 1.0/t163;
			double t165 = b*t10*t158*t164*u6;
			double t166 = t159+t165;
			double t168 = mu[i]*t8*t9*t21*t166*4.0;
			double t169 = 1.0/(t20*t20);
			double t171 = mu[i]*t9*t19*t166*t169*3.0;
			double t170 = t168-t171;
			double t172 = t27*t55*u1;
			double t173 = t27*t56*u7;
			double t174 = t172+t173;
			double t175 = u12-t17*u6*u7;
			double t176 = t18*t92*t170;
			double t178 = t27*t97*u1;
			double t179 = t27*t56*u13;
			double t180 = t178+t179;
			double t181 = mu[i]*param1*t8*t9*t21*t49*t166*4.0;
			double t190 = mu[i]*param1*t9*t19*t49*t166*t169*3.0;
			double t182 = t181-t190;
			double t183 = u18-t17*u6*u13;
			double t184 = t18*t119*t170;
			double t185 = t18*t122*t170;
			double t187 = t27*t126*u1;
			double t188 = t27*t56*u19;
			double t189 = t187+t188;
			double t191 = u24-t17*u6*u19;
			double t192 = t2*t18*t23*u2*(2.0/3.0);
			double t193 = t17*t18*t23;
			double t194 = t2*t18*t23*u2;
			double t195 = t2*t18*t23*u4;
			double t196 = t27*t56;
			double t197 = t27*t32*u1;
			double t198 = t196+t197;
			double t199 = t2*t18*t23*u3*(2.0/3.0);
			double t200 = t2*t18*t23*u3;
			double t201 = t17*t18*t23*(4.0/3.0);
			double t208 = t2*t18*t51*u4;
			double t202 = t195-t208;
			double t203 = t17*t18*t51;
			double t204 = mu[i]*t17*t18*t74*t75;
			double t205 = t2*t18*t23*u4*(2.0/3.0);
			double t206 = t194-t2*t18*t51*u2;
			double t207 = t200-t2*t18*t51*u3;

			f_udg[0*ng+i] = 0.0;
			f_udg[1*ng+i] = -t2*t3-t27*t32-t18*t23*t73;
			f_udg[2*ng+i] = t78;
			f_udg[3*ng+i] = t108;
			f_udg[4*ng+i] = -t84*u2-t2*t18*t51*t57*(t27*t55-t27*t32*u7+t27*u1*(t42+t43+t44-t31*u7-u1*(t4*t33*u2*2.0+t4*t34*u3*2.0+t4*t35*u4*2.0-t3*t38*u7-t5*t38*u7-t6*t38*u7)))+t4*t18*t51*t57*t174*2.0-t17*t18*t23*t63*u3-t17*t18*t23*t67*u4-t17*t18*t23*t73*u2-t2*t18*t23*t92*u3-t2*t18*t23*t119*u4+t2*t18*t23*t131*u2;
			f_udg[5*ng+i] = -t2*u2*u6-mu[i]*t2*t18*t74*t75*t175+mu[i]*t4*t18*t74*t75*u6*u7;
			f_udg[6*ng+i] = 0.0;
			f_udg[7*ng+i] = t78;
			f_udg[8*ng+i] = -t2*t5-t27*t32-t18*t23*t105;
			f_udg[9*ng+i] = t111;
			f_udg[10*ng+i] = -t84*u3-t2*t18*t51*t57*(t27*t97-t27*t32*u13+t27*u1*(t87+t88+t89-t31*u13-u1*(t4*t45*u2*2.0-t3*t38*u13-t5*t38*u13-t6*t38*u13+t4*t58*u3*2.0+t4*t85*u4*2.0)))+t4*t18*t51*t57*t180*2.0-t17*t18*t23*t63*u2-t2*t18*t23*t92*u2-t17*t18*t23*t102*u4-t17*t18*t23*t105*u3-t2*t18*t23*t122*u4+t2*t18*t23*t144*u3;
			f_udg[11*ng+i] = -t2*u3*u6-mu[i]*t2*t18*t74*t75*t183+mu[i]*t4*t18*t74*t75*u6*u13;
			f_udg[12*ng+i] = 0.0;
			f_udg[13*ng+i] = t108;
			f_udg[14*ng+i] = t111;
			f_udg[15*ng+i] = -t2*t6-t27*t32-t18*t23*t130;
			f_udg[16*ng+i] = -t84*u4-t2*t18*t51*t57*(t27*t126-t27*t32*u19+t27*u1*(t114+t115+t116-t31*u19-u1*(t4*t46*u2*2.0-t3*t38*u19-t5*t38*u19-t6*t38*u19+t4*t59*u4*2.0+t4*t93*u3*2.0)))+t4*t18*t51*t57*t189*2.0-t17*t18*t23*t67*u2-t17*t18*t23*t102*u3-t2*t18*t23*t119*u2-t2*t18*t23*t122*u3-t17*t18*t23*t130*u4+t2*t18*t23*t155*u4;
			f_udg[17*ng+i] = -t2*u4*u6-mu[i]*t2*t18*t74*t75*t191+mu[i]*t4*t18*t74*t75*u6*u19;
			f_udg[18*ng+i] = 1.0;
			f_udg[19*ng+i] = t17*u2*2.0-t17*t27*u2-t2*t18*t23*u7*(4.0/3.0);
			f_udg[20*ng+i] = t133;
			f_udg[21*ng+i] = t135;
			f_udg[22*ng+i] = t142+t143-t2*t3*t27-t17*t18*t23*t131-t2*t18*t51*t57*(t27*u1*(u1*(t2*t33-t4*u2*u7)+t2*u2*u7)-t17*t27*u2*u7)-t4*t18*t23*u2*u7*(4.0/3.0)-t4*t18*t23*u3*u13-t4*t18*t23*u4*u19;
			f_udg[23*ng+i] = t145;
			f_udg[24*ng+i] = 0.0;
			f_udg[25*ng+i] = t133;
			f_udg[26*ng+i] = t137;
			f_udg[27*ng+i] = 0.0;
			f_udg[28*ng+i] = t138-t2*t27*u2*u3-t2*t18*t51*t57*(t27*u1*(u1*(t62-t77)+t2*u2*u13)-t17*t27*u2*u13)+t4*t18*t23*u3*u7*(2.0/3.0)-t4*t18*t23*u2*u13;
			f_udg[29*ng+i] = 0.0;
			f_udg[30*ng+i] = 0.0;
			f_udg[31*ng+i] = t135;
			f_udg[32*ng+i] = 0.0;
			f_udg[33*ng+i] = t137;
			f_udg[34*ng+i] = t149-t2*t27*u2*u4-t2*t18*t51*t57*(t27*u1*(u1*(t66-t107)+t2*u2*u19)-t17*t27*u2*u19)+t4*t18*t23*u4*u7*(2.0/3.0)-t4*t18*t23*u2*u19;
			f_udg[35*ng+i] = 0.0;
			f_udg[36*ng+i] = 0.0;
			f_udg[37*ng+i] = t147;
			f_udg[38*ng+i] = t140;
			f_udg[39*ng+i] = 0.0;
			f_udg[40*ng+i] = t138-t2*t27*u2*u3-t2*t18*t51*t57*(t27*u1*(u1*(t60-t76)+t2*u3*u7)-t17*t27*u3*u7)-t4*t18*t23*u3*u7+t4*t18*t23*u2*u13*(2.0/3.0);
			f_udg[41*ng+i] = 0.0;
			f_udg[42*ng+i] = 1.0;
			f_udg[43*ng+i] = t140;
			f_udg[44*ng+i] = t17*u3*2.0-t17*t27*u3-t2*t18*t23*u13*(4.0/3.0);
			f_udg[45*ng+i] = t135;
			f_udg[46*ng+i] = t142+t143-t2*t5*t27-t17*t18*t23*t144-t2*t18*t51*t57*(t27*u1*(u1*(t2*t58-t4*u3*u13)+t2*u3*u13)-t17*t27*u3*u13)-t4*t18*t23*u2*u7-t4*t18*t23*u3*u13*(4.0/3.0)-t4*t18*t23*u4*u19;
			f_udg[47*ng+i] = t145;
			f_udg[48*ng+i] = 0.0;
			f_udg[49*ng+i] = 0.0;
			f_udg[50*ng+i] = t135;
			f_udg[51*ng+i] = t147;
			f_udg[52*ng+i] = t153-t2*t27*u3*u4-t2*t18*t51*t57*(t27*u1*(u1*(t101-t110)+t2*u3*u19)-t17*t27*u3*u19)+t4*t18*t23*u4*u13*(2.0/3.0)-t4*t18*t23*u3*u19;
			f_udg[53*ng+i] = 0.0;
			f_udg[54*ng+i] = 0.0;
			f_udg[55*ng+i] = t151;
			f_udg[56*ng+i] = 0.0;
			f_udg[57*ng+i] = t140;
			f_udg[58*ng+i] = t149-t2*t27*u2*u4-t2*t18*t51*t57*(t27*u1*(u1*(t64-t106)+t2*u4*u7)-t17*t27*u4*u7)-t4*t18*t23*u4*u7+t4*t18*t23*u2*u19*(2.0/3.0);
			f_udg[59*ng+i] = 0.0;
			f_udg[60*ng+i] = 0.0;
			f_udg[61*ng+i] = 0.0;
			f_udg[62*ng+i] = t151;
			f_udg[63*ng+i] = t133;
			f_udg[64*ng+i] = t153-t2*t27*u3*u4-t2*t18*t51*t57*(t27*u1*(u1*(t99-t109)+t2*u4*u13)-t17*t27*u4*u13)-t4*t18*t23*u4*u13+t4*t18*t23*u3*u19*(2.0/3.0);
			f_udg[65*ng+i] = 0.0;
			f_udg[66*ng+i] = 1.0;
			f_udg[67*ng+i] = t140;
			f_udg[68*ng+i] = t133;
			f_udg[69*ng+i] = -t154+t17*u4*2.0-t2*t18*t23*u19*(4.0/3.0);
			f_udg[70*ng+i] = t142+t143-t2*t6*t27-t17*t18*t23*t155-t2*t18*t51*t57*(t27*u1*(u1*(t2*t59-t4*u4*u19)+t2*u4*u19)-t17*t27*u4*u19)-t4*t18*t23*u2*u7-t4*t18*t23*u3*u13-t4*t18*t23*u4*u19*(4.0/3.0);
			f_udg[71*ng+i] = t145;
			f_udg[72*ng+i] = 0.0;
			f_udg[73*ng+i] = t27;
			f_udg[74*ng+i] = 0.0;
			f_udg[75*ng+i] = 0.0;
			f_udg[76*ng+i] = t157*u2-t2*t18*t51*u7;
			f_udg[77*ng+i] = 0.0;
			f_udg[78*ng+i] = 0.0;
			f_udg[79*ng+i] = 0.0;
			f_udg[80*ng+i] = t27;
			f_udg[81*ng+i] = 0.0;
			f_udg[82*ng+i] = t157*u3-t2*t18*t51*u13;
			f_udg[83*ng+i] = 0.0;
			f_udg[84*ng+i] = 0.0;
			f_udg[85*ng+i] = 0.0;
			f_udg[86*ng+i] = 0.0;
			f_udg[87*ng+i] = t27;
			f_udg[88*ng+i] = t157*u4-t2*t18*t51*u19;
			f_udg[89*ng+i] = 0.0;
			f_udg[90*ng+i] = 0.0;
			f_udg[91*ng+i] = -t18*t131*t170;
			f_udg[92*ng+i] = t176;
			f_udg[93*ng+i] = t184;
			f_udg[94*ng+i] = -t2*t18*t57*t174*t182+t17*t18*t92*t170*u3+t17*t18*t119*t170*u4-t17*t18*t131*t170*u2;
			f_udg[95*ng+i] = t139+mu[i]*t17*t18*t74*t166*t175-mu[i]*t2*t18*t74*t75*u7;
			f_udg[96*ng+i] = 0.0;
			f_udg[97*ng+i] = t176;
			f_udg[98*ng+i] = -t18*t144*t170;
			f_udg[99*ng+i] = t185;
			f_udg[100*ng+i] = -t2*t18*t57*t180*t182+t17*t18*t92*t170*u2+t17*t18*t122*t170*u4-t17*t18*t144*t170*u3;
			f_udg[101*ng+i] = t132+mu[i]*t17*t18*t74*t166*t183-mu[i]*t2*t18*t74*t75*u13;
			f_udg[102*ng+i] = 0.0;
			f_udg[103*ng+i] = t184;
			f_udg[104*ng+i] = t185;
			f_udg[105*ng+i] = -t18*t155*t170;
			f_udg[106*ng+i] = -t2*t18*t57*t182*t189+t17*t18*t119*t170*u2+t17*t18*t122*t170*u3-t17*t18*t155*t170*u4;
			f_udg[107*ng+i] = t134+mu[i]*t17*t18*t74*t166*t191-mu[i]*t2*t18*t74*t75*u19;
			f_udg[108*ng+i] = 0.0;
			f_udg[109*ng+i] = t2*t18*t23*u2*(-4.0/3.0);
			f_udg[110*ng+i] = -t2*t18*t23*u3;
			f_udg[111*ng+i] = -t2*t18*t23*u4;
			f_udg[112*ng+i] = t3*t4*t18*t23*(-4.0/3.0)-t4*t5*t18*t23-t4*t6*t18*t23-t2*t18*t51*t57*t198;
			f_udg[113*ng+i] = -mu[i]*t2*t18*t74*t75*u6;
			f_udg[114*ng+i] = 0.0;
			f_udg[115*ng+i] = -t2*t18*t23*u3;
			f_udg[116*ng+i] = t192;
			f_udg[117*ng+i] = 0.0;
			f_udg[118*ng+i] = t4*t18*t23*u2*u3*(-1.0/3.0);
			f_udg[119*ng+i] = 0.0;
			f_udg[120*ng+i] = 0.0;
			f_udg[121*ng+i] = -t2*t18*t23*u4;
			f_udg[122*ng+i] = 0.0;
			f_udg[123*ng+i] = t192;
			f_udg[124*ng+i] = t4*t18*t23*u2*u4*(-1.0/3.0);
			f_udg[125*ng+i] = 0.0;
			f_udg[126*ng+i] = 0.0;
			f_udg[127*ng+i] = t201;
			f_udg[128*ng+i] = 0.0;
			f_udg[129*ng+i] = 0.0;
			f_udg[130*ng+i] = t2*t18*t23*u2*(4.0/3.0)-t2*t18*t51*u2;
			f_udg[131*ng+i] = 0.0;
			f_udg[132*ng+i] = 0.0;
			f_udg[133*ng+i] = 0.0;
			f_udg[134*ng+i] = t17*t18*t23*(-2.0/3.0);
			f_udg[135*ng+i] = 0.0;
			f_udg[136*ng+i] = t2*t18*t23*u3*(-2.0/3.0);
			f_udg[137*ng+i] = 0.0;
			f_udg[138*ng+i] = 0.0;
			f_udg[139*ng+i] = 0.0;
			f_udg[140*ng+i] = 0.0;
			f_udg[141*ng+i] = t17*t18*t23*(-2.0/3.0);
			f_udg[142*ng+i] = t2*t18*t23*u4*(-2.0/3.0);
			f_udg[143*ng+i] = 0.0;
			f_udg[144*ng+i] = 0.0;
			f_udg[145*ng+i] = 0.0;
			f_udg[146*ng+i] = t193;
			f_udg[147*ng+i] = 0.0;
			f_udg[148*ng+i] = t207;
			f_udg[149*ng+i] = 0.0;
			f_udg[150*ng+i] = 0.0;
			f_udg[151*ng+i] = t193;
			f_udg[152*ng+i] = 0.0;
			f_udg[153*ng+i] = 0.0;
			f_udg[154*ng+i] = t194;
			f_udg[155*ng+i] = 0.0;
			f_udg[156*ng+i] = 0.0;
			f_udg[157*ng+i] = 0.0;
			f_udg[158*ng+i] = 0.0;
			f_udg[159*ng+i] = 0.0;
			f_udg[160*ng+i] = 0.0;
			f_udg[161*ng+i] = 0.0;
			f_udg[162*ng+i] = 0.0;
			f_udg[163*ng+i] = 0.0;
			f_udg[164*ng+i] = 0.0;
			f_udg[165*ng+i] = t193;
			f_udg[166*ng+i] = t202;
			f_udg[167*ng+i] = 0.0;
			f_udg[168*ng+i] = 0.0;
			f_udg[169*ng+i] = 0.0;
			f_udg[170*ng+i] = 0.0;
			f_udg[171*ng+i] = 0.0;
			f_udg[172*ng+i] = 0.0;
			f_udg[173*ng+i] = 0.0;
			f_udg[174*ng+i] = 0.0;
			f_udg[175*ng+i] = t193;
			f_udg[176*ng+i] = 0.0;
			f_udg[177*ng+i] = 0.0;
			f_udg[178*ng+i] = t194;
			f_udg[179*ng+i] = 0.0;
			f_udg[180*ng+i] = 0.0;
			f_udg[181*ng+i] = 0.0;
			f_udg[182*ng+i] = 0.0;
			f_udg[183*ng+i] = 0.0;
			f_udg[184*ng+i] = t203;
			f_udg[185*ng+i] = 0.0;
			f_udg[186*ng+i] = 0.0;
			f_udg[187*ng+i] = 0.0;
			f_udg[188*ng+i] = 0.0;
			f_udg[189*ng+i] = 0.0;
			f_udg[190*ng+i] = 0.0;
			f_udg[191*ng+i] = 0.0;
			f_udg[192*ng+i] = 0.0;
			f_udg[193*ng+i] = 0.0;
			f_udg[194*ng+i] = 0.0;
			f_udg[195*ng+i] = 0.0;
			f_udg[196*ng+i] = 0.0;
			f_udg[197*ng+i] = 0.0;
			f_udg[198*ng+i] = 0.0;
			f_udg[199*ng+i] = 0.0;
			f_udg[200*ng+i] = 0.0;
			f_udg[201*ng+i] = 0.0;
			f_udg[202*ng+i] = 0.0;
			f_udg[203*ng+i] = t204;
			f_udg[204*ng+i] = 0.0;
			f_udg[205*ng+i] = 0.0;
			f_udg[206*ng+i] = 0.0;
			f_udg[207*ng+i] = 0.0;
			f_udg[208*ng+i] = 0.0;
			f_udg[209*ng+i] = 0.0;
			f_udg[210*ng+i] = 0.0;
			f_udg[211*ng+i] = 0.0;
			f_udg[212*ng+i] = 0.0;
			f_udg[213*ng+i] = 0.0;
			f_udg[214*ng+i] = 0.0;
			f_udg[215*ng+i] = 0.0;
			f_udg[216*ng+i] = 0.0;
			f_udg[217*ng+i] = t199;
			f_udg[218*ng+i] = -t194;
			f_udg[219*ng+i] = 0.0;
			f_udg[220*ng+i] = t4*t18*t23*u2*u3*(-1.0/3.0);
			f_udg[221*ng+i] = 0.0;
			f_udg[222*ng+i] = 0.0;
			f_udg[223*ng+i] = -t194;
			f_udg[224*ng+i] = t2*t18*t23*u3*(-4.0/3.0);
			f_udg[225*ng+i] = -t195;
			f_udg[226*ng+i] = -t3*t4*t18*t23-t4*t5*t18*t23*(4.0/3.0)-t4*t6*t18*t23-t2*t18*t51*t57*t198;
			f_udg[227*ng+i] = -mu[i]*t2*t18*t74*t75*u6;
			f_udg[228*ng+i] = 0.0;
			f_udg[229*ng+i] = 0.0;
			f_udg[230*ng+i] = -t195;
			f_udg[231*ng+i] = t199;
			f_udg[232*ng+i] = t4*t18*t23*u3*u4*(-1.0/3.0);
			f_udg[233*ng+i] = 0.0;
			f_udg[234*ng+i] = 0.0;
			f_udg[235*ng+i] = 0.0;
			f_udg[236*ng+i] = t193;
			f_udg[237*ng+i] = 0.0;
			f_udg[238*ng+i] = t200;
			f_udg[239*ng+i] = 0.0;
			f_udg[240*ng+i] = 0.0;
			f_udg[241*ng+i] = t193;
			f_udg[242*ng+i] = 0.0;
			f_udg[243*ng+i] = 0.0;
			f_udg[244*ng+i] = t206;
			f_udg[245*ng+i] = 0.0;
			f_udg[246*ng+i] = 0.0;
			f_udg[247*ng+i] = 0.0;
			f_udg[248*ng+i] = 0.0;
			f_udg[249*ng+i] = 0.0;
			f_udg[250*ng+i] = 0.0;
			f_udg[251*ng+i] = 0.0;
			f_udg[252*ng+i] = 0.0;
			f_udg[253*ng+i] = t17*t18*t23*(-2.0/3.0);
			f_udg[254*ng+i] = 0.0;
			f_udg[255*ng+i] = 0.0;
			f_udg[256*ng+i] = -t192;
			f_udg[257*ng+i] = 0.0;
			f_udg[258*ng+i] = 0.0;
			f_udg[259*ng+i] = 0.0;
			f_udg[260*ng+i] = t201;
			f_udg[261*ng+i] = 0.0;
			f_udg[262*ng+i] = t2*t18*t23*u3*(4.0/3.0)-t2*t18*t51*u3;
			f_udg[263*ng+i] = 0.0;
			f_udg[264*ng+i] = 0.0;
			f_udg[265*ng+i] = 0.0;
			f_udg[266*ng+i] = 0.0;
			f_udg[267*ng+i] = t17*t18*t23*(-2.0/3.0);
			f_udg[268*ng+i] = t2*t18*t23*u4*(-2.0/3.0);
			f_udg[269*ng+i] = 0.0;
			f_udg[270*ng+i] = 0.0;
			f_udg[271*ng+i] = 0.0;
			f_udg[272*ng+i] = 0.0;
			f_udg[273*ng+i] = 0.0;
			f_udg[274*ng+i] = 0.0;
			f_udg[275*ng+i] = 0.0;
			f_udg[276*ng+i] = 0.0;
			f_udg[277*ng+i] = 0.0;
			f_udg[278*ng+i] = 0.0;
			f_udg[279*ng+i] = t193;
			f_udg[280*ng+i] = t202;
			f_udg[281*ng+i] = 0.0;
			f_udg[282*ng+i] = 0.0;
			f_udg[283*ng+i] = 0.0;
			f_udg[284*ng+i] = t193;
			f_udg[285*ng+i] = 0.0;
			f_udg[286*ng+i] = t200;
			f_udg[287*ng+i] = 0.0;
			f_udg[288*ng+i] = 0.0;
			f_udg[289*ng+i] = 0.0;
			f_udg[290*ng+i] = 0.0;
			f_udg[291*ng+i] = 0.0;
			f_udg[292*ng+i] = 0.0;
			f_udg[293*ng+i] = 0.0;
			f_udg[294*ng+i] = 0.0;
			f_udg[295*ng+i] = 0.0;
			f_udg[296*ng+i] = 0.0;
			f_udg[297*ng+i] = 0.0;
			f_udg[298*ng+i] = t203;
			f_udg[299*ng+i] = 0.0;
			f_udg[300*ng+i] = 0.0;
			f_udg[301*ng+i] = 0.0;
			f_udg[302*ng+i] = 0.0;
			f_udg[303*ng+i] = 0.0;
			f_udg[304*ng+i] = 0.0;
			f_udg[305*ng+i] = 0.0;
			f_udg[306*ng+i] = 0.0;
			f_udg[307*ng+i] = 0.0;
			f_udg[308*ng+i] = 0.0;
			f_udg[309*ng+i] = 0.0;
			f_udg[310*ng+i] = 0.0;
			f_udg[311*ng+i] = 0.0;
			f_udg[312*ng+i] = 0.0;
			f_udg[313*ng+i] = 0.0;
			f_udg[314*ng+i] = 0.0;
			f_udg[315*ng+i] = 0.0;
			f_udg[316*ng+i] = 0.0;
			f_udg[317*ng+i] = t204;
			f_udg[318*ng+i] = 0.0;
			f_udg[319*ng+i] = 0.0;
			f_udg[320*ng+i] = 0.0;
			f_udg[321*ng+i] = 0.0;
			f_udg[322*ng+i] = 0.0;
			f_udg[323*ng+i] = 0.0;
			f_udg[324*ng+i] = 0.0;
			f_udg[325*ng+i] = t205;
			f_udg[326*ng+i] = 0.0;
			f_udg[327*ng+i] = -t194;
			f_udg[328*ng+i] = t4*t18*t23*u2*u4*(-1.0/3.0);
			f_udg[329*ng+i] = 0.0;
			f_udg[330*ng+i] = 0.0;
			f_udg[331*ng+i] = 0.0;
			f_udg[332*ng+i] = t205;
			f_udg[333*ng+i] = -t200;
			f_udg[334*ng+i] = t4*t18*t23*u3*u4*(-1.0/3.0);
			f_udg[335*ng+i] = 0.0;
			f_udg[336*ng+i] = 0.0;
			f_udg[337*ng+i] = -t194;
			f_udg[338*ng+i] = -t200;
			f_udg[339*ng+i] = t2*t18*t23*u4*(-4.0/3.0);
			f_udg[340*ng+i] = -t3*t4*t18*t23-t4*t5*t18*t23-t4*t6*t18*t23*(4.0/3.0)-t2*t18*t51*t57*t198;
			f_udg[341*ng+i] = -mu[i]*t2*t18*t74*t75*u6;
			f_udg[342*ng+i] = 0.0;
			f_udg[343*ng+i] = 0.0;
			f_udg[344*ng+i] = 0.0;
			f_udg[345*ng+i] = t193;
			f_udg[346*ng+i] = t195;
			f_udg[347*ng+i] = 0.0;
			f_udg[348*ng+i] = 0.0;
			f_udg[349*ng+i] = 0.0;
			f_udg[350*ng+i] = 0.0;
			f_udg[351*ng+i] = 0.0;
			f_udg[352*ng+i] = 0.0;
			f_udg[353*ng+i] = 0.0;
			f_udg[354*ng+i] = 0.0;
			f_udg[355*ng+i] = t193;
			f_udg[356*ng+i] = 0.0;
			f_udg[357*ng+i] = 0.0;
			f_udg[358*ng+i] = t206;
			f_udg[359*ng+i] = 0.0;
			f_udg[360*ng+i] = 0.0;
			f_udg[361*ng+i] = 0.0;
			f_udg[362*ng+i] = 0.0;
			f_udg[363*ng+i] = 0.0;
			f_udg[364*ng+i] = 0.0;
			f_udg[365*ng+i] = 0.0;
			f_udg[366*ng+i] = 0.0;
			f_udg[367*ng+i] = 0.0;
			f_udg[368*ng+i] = 0.0;
			f_udg[369*ng+i] = t193;
			f_udg[370*ng+i] = t195;
			f_udg[371*ng+i] = 0.0;
			f_udg[372*ng+i] = 0.0;
			f_udg[373*ng+i] = 0.0;
			f_udg[374*ng+i] = t193;
			f_udg[375*ng+i] = 0.0;
			f_udg[376*ng+i] = t207;
			f_udg[377*ng+i] = 0.0;
			f_udg[378*ng+i] = 0.0;
			f_udg[379*ng+i] = t17*t18*t23*(-2.0/3.0);
			f_udg[380*ng+i] = 0.0;
			f_udg[381*ng+i] = 0.0;
			f_udg[382*ng+i] = -t192;
			f_udg[383*ng+i] = 0.0;
			f_udg[384*ng+i] = 0.0;
			f_udg[385*ng+i] = 0.0;
			f_udg[386*ng+i] = t17*t18*t23*(-2.0/3.0);
			f_udg[387*ng+i] = 0.0;
			f_udg[388*ng+i] = -t199;
			f_udg[389*ng+i] = 0.0;
			f_udg[390*ng+i] = 0.0;
			f_udg[391*ng+i] = 0.0;
			f_udg[392*ng+i] = 0.0;
			f_udg[393*ng+i] = t201;
			f_udg[394*ng+i] = -t208+t2*t18*t23*u4*(4.0/3.0);
			f_udg[395*ng+i] = 0.0;
			f_udg[396*ng+i] = 0.0;
			f_udg[397*ng+i] = 0.0;
			f_udg[398*ng+i] = 0.0;
			f_udg[399*ng+i] = 0.0;
			f_udg[400*ng+i] = 0.0;
			f_udg[401*ng+i] = 0.0;
			f_udg[402*ng+i] = 0.0;
			f_udg[403*ng+i] = 0.0;
			f_udg[404*ng+i] = 0.0;
			f_udg[405*ng+i] = 0.0;
			f_udg[406*ng+i] = 0.0;
			f_udg[407*ng+i] = 0.0;
			f_udg[408*ng+i] = 0.0;
			f_udg[409*ng+i] = 0.0;
			f_udg[410*ng+i] = 0.0;
			f_udg[411*ng+i] = 0.0;
			f_udg[412*ng+i] = t203;
			f_udg[413*ng+i] = 0.0;
			f_udg[414*ng+i] = 0.0;
			f_udg[415*ng+i] = 0.0;
			f_udg[416*ng+i] = 0.0;
			f_udg[417*ng+i] = 0.0;
			f_udg[418*ng+i] = 0.0;
			f_udg[419*ng+i] = 0.0;
			f_udg[420*ng+i] = 0.0;
			f_udg[421*ng+i] = 0.0;
			f_udg[422*ng+i] = 0.0;
			f_udg[423*ng+i] = 0.0;
			f_udg[424*ng+i] = 0.0;
			f_udg[425*ng+i] = 0.0;
			f_udg[426*ng+i] = 0.0;
			f_udg[427*ng+i] = 0.0;
			f_udg[428*ng+i] = 0.0;
			f_udg[429*ng+i] = 0.0;
			f_udg[430*ng+i] = 0.0;
			f_udg[431*ng+i] = t204;
		}

		if (app.viscosityModel != 0) {

			for (int i = 0; i <ng; i++) {
				double x1 = pg[0*ng+i];
				double x2 = pg[1*ng+i];
				double x3 = pg[2*ng+i];

				double u1 = udg[0*ng+i];
				double u2 = udg[1*ng+i];
				double u3 = udg[2*ng+i];
				double u4 = udg[3*ng+i];
				double u5 = udg[4*ng+i];
				double u6 = udg[5*ng+i];
				double u7 = udg[6*ng+i];
				double u8 = udg[7*ng+i];
				double u9 = udg[8*ng+i];
				double u10 = udg[9*ng+i];
				double u11 = udg[10*ng+i];
				double u12 = udg[11*ng+i];
				double u13 = udg[12*ng+i];
				double u14 = udg[13*ng+i];
				double u15 = udg[14*ng+i];
				double u16 = udg[15*ng+i];
				double u17 = udg[16*ng+i];
				double u18 = udg[17*ng+i];
				double u19 = udg[18*ng+i];
				double u20 = udg[19*ng+i];
				double u21 = udg[20*ng+i];
				double u22 = udg[21*ng+i];
				double u23 = udg[22*ng+i];
				double u24 = udg[23*ng+i];

				double t2 = 1.0/u1;
				double t3 = 1.0/mu[i];
				double t6 = 1.0/3.141592653589793;
				double t7 = b*t3*u6;
				double t8 = atan(t7);
				double t9 = t6*t8;
				double t10 = t9+1.0/2.0;
				double t11 = t3*t10*u6;
				double t4 = c+t11;
				double t5 = t4*t4;
				double t12 = cv1*cv1;
				double t13 = 1.0/(mu[i]*mu[i]);
				double t14 = u6*u6;
				double t15 = cv1*t12+t4*t5;
				double t16 = 1.0/t15;
				double t17 = t5*t5;
				double t18 = t10*t13*u6;
				double t19 = 1.0/(mu[i]*mu[i]*mu[i]);
				double t20 = b*b;
				double t21 = t13*t14*t20;
				double t22 = t21+1.0;
				double t23 = 1.0/t22;
				double t24 = b*t6*t14*t19*t23;
				double t25 = t18+t24;
				double t26 = 1.0/param3;
				double t27 = t16*t17;
				double t28 = 1.0/(t15*t15);
				double t29 = mu[i]*t5*t17*t25*t28*3.0;
				double t31 = mu[i]*t4*t5*t16*t25*4.0;
				double t30 = t27+t29-t31+1.0;
				double t50 = t2*u3*u7;
				double t32 = -t50+u9;
				double t33 = t2*t32;
				double t63 = t2*u2*u13;
				double t34 = -t63+u14;
				double t35 = t2*t34;
				double t36 = t33+t35;
				double t51 = t2*u4*u7;
				double t37 = -t51+u10;
				double t38 = t2*t37;
				double t84 = t2*u2*u19;
				double t39 = -t84+u20;
				double t40 = t2*t39;
				double t41 = t38+t40;
				double t49 = t2*u2*u7;
				double t42 = -t49+u8;
				double t65 = t2*u3*u13;
				double t43 = -t65+u15;
				double t44 = t2*t43*(2.0/3.0);
				double t66 = t2*u4*u19;
				double t45 = -t66+u22;
				double t46 = t2*t45*(2.0/3.0);
				double t47 = t44+t46-t2*t42*(4.0/3.0);
				double t48 = 1.0/(u1*u1);
				double t52 = u2*u2;
				double t53 = t48*t52*(1.0/2.0);
				double t54 = u3*u3;
				double t55 = t48*t54*(1.0/2.0);
				double t56 = u4*u4;
				double t57 = t48*t56*(1.0/2.0);
				double t58 = t53+t55+t57;
				double t59 = param1-1.0;
				double t60 = 1.0/PrTurb;
				double t61 = 1.0/sigma;
				double t62 = u12-t2*u6*u7;
				double t64 = t26*t30*t36;
				double t74 = t2*u4*u13;
				double t67 = -t74+u16;
				double t68 = t2*t67;
				double t86 = t2*u3*u19;
				double t69 = -t86+u21;
				double t70 = t2*t69;
				double t71 = t68+t70;
				double t72 = t2*t42*(2.0/3.0);
				double t73 = t46+t72-t2*t43*(4.0/3.0);
				double t89 = t58*u1;
				double t75 = -t89+u5;
				double t76 = 1.0/t59;
				double t77 = 1.0/param4;
				double t78 = param1*t77;
				double t79 = param1*t16*t17*t60;
				double t80 = mu[i]*param1*t5*t17*t25*t28*t60*3.0;
				double t90 = mu[i]*param1*t4*t5*t16*t25*t60*4.0;
				double t81 = t78+t79+t80-t90;
				double t82 = c+t11+1.0;
				double t83 = u18-t2*u6*u13;
				double t85 = t26*t30*t41;
				double t87 = t26*t30*t71;
				double t88 = t44+t72-t2*t45*(4.0/3.0);
				double t91 = u24-t2*u6*u19;

				f_mu[0*ng+i] = 0.0;
				f_mu[1*ng+i] = -t26*t30*t47;
				f_mu[2*ng+i] = t64;
				f_mu[3*ng+i] = t85;
				f_mu[4*ng+i] = -t26*t48*t76*t81*(t59*u1*(-u11+t58*u7+u1*(t32*t48*u3+t37*t48*u4+t42*t48*u2))+t59*t75*u7)+t2*t26*t30*t36*u3+t2*t26*t30*t41*u4-t2*t26*t30*t47*u2;
				f_mu[5*ng+i] = t2*t26*t61*t62*t82-mu[i]*t2*t25*t26*t61*t62;
				f_mu[6*ng+i] = 0.0;
				f_mu[7*ng+i] = t64;
				f_mu[8*ng+i] = -t26*t30*t73;
				f_mu[9*ng+i] = t87;
				f_mu[10*ng+i] = -t26*t48*t76*t81*(t59*u1*(-u17+t58*u13+u1*(t34*t48*u2+t43*t48*u3+t48*t67*u4))+t59*t75*u13)+t2*t26*t30*t36*u2+t2*t26*t30*t71*u4-t2*t26*t30*t73*u3;
				f_mu[11*ng+i] = t2*t26*t61*t82*t83-mu[i]*t2*t25*t26*t61*t83;
				f_mu[12*ng+i] = 0.0;
				f_mu[13*ng+i] = t85;
				f_mu[14*ng+i] = t87;
				f_mu[15*ng+i] = -t26*t30*t88;
				f_mu[16*ng+i] = -t26*t48*t76*t81*(t59*u1*(-u23+t58*u19+u1*(t39*t48*u2+t45*t48*u4+t48*t69*u3))+t59*t75*u19)+t2*t26*t30*t41*u2+t2*t26*t30*t71*u3-t2*t26*t30*t88*u4;
				f_mu[17*ng+i] = t2*t26*t61*t82*t91-mu[i]*t2*t25*t26*t61*t91;
			}

			chainRule_f_udg(f_udg, f_mu, mu_udg, ng, nc, ncu, nd);
		}
        
//         for (int i = 0; i <ng*6*3*24; i++)
//             f_udg[i] /= param3;
	}
    
//	for (int i = 0; i <ng; i++) {
//		double x1 = pg[0*ng+i];
//		double x2 = pg[1*ng+i];
//		double x3 = pg[2*ng+i];
//
//		double u1 = udg[0*ng+i];
//		double u2 = udg[1*ng+i];
//		double u3 = udg[2*ng+i];
//		double u4 = udg[3*ng+i];
//		double u5 = udg[4*ng+i];
//		double u6 = udg[5*ng+i];
//		double u7 = udg[6*ng+i];
//		double u8 = udg[7*ng+i];
//		double u9 = udg[8*ng+i];
//		double u10 = udg[9*ng+i];
//		double u11 = udg[10*ng+i];
//		double u12 = udg[11*ng+i];
//		double u13 = udg[12*ng+i];
//		double u14 = udg[13*ng+i];
//		double u15 = udg[14*ng+i];
//		double u16 = udg[15*ng+i];
//		double u17 = udg[16*ng+i];
//		double u18 = udg[17*ng+i];
//		double u19 = udg[18*ng+i];
//		double u20 = udg[19*ng+i];
//		double u21 = udg[20*ng+i];
//		double u22 = udg[21*ng+i];
//		double u23 = udg[22*ng+i];
//		double u24 = udg[23*ng+i];
//
//		double t2 = u2*u2;
//		double t3 = 1.0/(u1*u1);
//		double t4 = 1.0/u1;
//		double t5 = 1.0/nu[i];
//		double t9 = 1.0/3.141592653589793;
//		double t10 = b*t4*t5*u6;
//		double t11 = atan(t10);
//		double t12 = t9*t11;
//		double t13 = t12+1.0/2.0;
//		double t14 = t4*t5*t13*u6;
//		double t6 = c+t14;
//		double t7 = t6*t6;
//		double t8 = cv1*cv1;
//		double t15 = 1.0/param3;
//		double t16 = cv1*t8+t6*t7;
//		double t17 = 1.0/t16;
//		double t18 = t7*t7;
//		double t19 = nu[i]*t17*t18;
//		double t20 = nu[i]+t19;
//		double t21 = t2*t3*(1.0/2.0);
//		double t22 = u3*u3;
//		double t23 = t3*t22*(1.0/2.0);
//		double t24 = u4*u4;
//		double t25 = t3*t24*(1.0/2.0);
//		double t26 = t21+t23+t25;
//		double t48 = t26*u1;
//		double t27 = -t48+u5;
//		double t28 = param1-1.0;
//		double t45 = t4*u2*u7;
//		double t29 = -t45+u8;
//		double t54 = t4*u3*u13;
//		double t30 = -t54+u15;
//		double t31 = t4*t30*(2.0/3.0);
//		double t55 = t4*u4*u19;
//		double t32 = -t55+u22;
//		double t33 = t4*t32*(2.0/3.0);
//		double t34 = t31+t33-t4*t29*(4.0/3.0);
//		double t46 = t4*u3*u7;
//		double t35 = -t46+u9;
//		double t36 = t4*t35;
//		double t50 = t4*u2*u13;
//		double t37 = -t50+u14;
//		double t38 = t4*t37;
//		double t39 = t36+t38;
//		double t47 = t4*u4*u7;
//		double t40 = -t47+u10;
//		double t41 = t4*t40;
//		double t76 = t4*u2*u19;
//		double t42 = -t76+u20;
//		double t43 = t4*t42;
//		double t44 = t41+t43;
//		double t49 = t4*u2*u3;
//		double t51 = t15*t20*t39*u1;
//		double t52 = t49+t51;
//		double t53 = t27*t28;
//		double t56 = t4*u5;
//		double t57 = t4*t27*t28;
//		double t58 = t56+t57;
//		double t59 = t4*t29*(2.0/3.0);
//		double t60 = t33+t59-t4*t30*(4.0/3.0);
//		double t71 = t4*u4*u13;
//		double t61 = -t71+u16;
//		double t62 = t4*t61;
//		double t80 = t4*u3*u19;
//		double t63 = -t80+u21;
//		double t64 = t4*t63;
//		double t65 = t62+t64;
//		double t66 = 1.0/param4;
//		double t67 = nu[i]*param1*t66*u1;
//		double t68 = 1.0/PrTurb;
//		double t69 = nu[i]*param1*t17*t18*t68*u1;
//		double t70 = t67+t69;
//		double t72 = 1.0/t28;
//		double t73 = 1.0/sigma;
//		double t74 = c+t14+1.0;
//		double t75 = t4*u2*u4;
//		double t77 = t15*t20*t44*u1;
//		double t78 = t75+t77;
//		double t79 = t4*u3*u4;
//		double t81 = t15*t20*t65*u1;
//		double t82 = t79+t81;
//		double t83 = t31+t59-t4*t32*(4.0/3.0);
//
//		f[0*ng+i] = u2;
//		f[1*ng+i] = t53+t2*t4-t15*t20*t34*u1;
//		f[2*ng+i] = t52;
//		f[3*ng+i] = t78;
//		f[4*ng+i] = t58*u2-t15*t20*t34*u2+t15*t20*t39*u3+t15*t20*t44*u4-t3*t15*t70*t72*(t28*u1*(-u11+t26*u7+u1*(t3*t29*u2+t3*t35*u3+t3*t40*u4))+t27*t28*u7);
//		f[5*ng+i] = t4*u2*u6+nu[i]*t15*t73*t74*(u12-t4*u6*u7);
//		f[6*ng+i] = u3;
//		f[7*ng+i] = t52;
//		f[8*ng+i] = t53+t4*t22-t15*t20*t60*u1;
//		f[9*ng+i] = t82;
//		f[10*ng+i] = t58*u3+t15*t20*t39*u2-t15*t20*t60*u3+t15*t20*t65*u4-t3*t15*t70*t72*(t28*u1*(-u17+t26*u13+u1*(t3*t30*u3+t3*t37*u2+t3*t61*u4))+t27*t28*u13);
//		f[11*ng+i] = t4*u3*u6+nu[i]*t15*t73*t74*(u18-t4*u6*u13);
//		f[12*ng+i] = u4;
//		f[13*ng+i] = t78;
//		f[14*ng+i] = t82;
//		f[15*ng+i] = t53+t4*t24-t15*t20*t83*u1;
//		f[16*ng+i] = t58*u4+t15*t20*t44*u2+t15*t20*t65*u3-t15*t20*t83*u4-t3*t15*t70*t72*(t28*u1*(-u23+t26*u19+u1*(t3*t32*u4+t3*t42*u2+t3*t63*u3))+t27*t28*u19);
//		f[17*ng+i] = t4*u4*u6+nu[i]*t15*t73*t74*(u24-t4*u6*u19);
//
//	}
//
//	if (computeJacobian == 1) {
//
//		for (int i = 0; i <ng; i++) {
//			double x1 = pg[0*ng+i];
//			double x2 = pg[1*ng+i];
//			double x3 = pg[2*ng+i];
//
//			double u1 = udg[0*ng+i];
//			double u2 = udg[1*ng+i];
//			double u3 = udg[2*ng+i];
//			double u4 = udg[3*ng+i];
//			double u5 = udg[4*ng+i];
//			double u6 = udg[5*ng+i];
//			double u7 = udg[6*ng+i];
//			double u8 = udg[7*ng+i];
//			double u9 = udg[8*ng+i];
//			double u10 = udg[9*ng+i];
//			double u11 = udg[10*ng+i];
//			double u12 = udg[11*ng+i];
//			double u13 = udg[12*ng+i];
//			double u14 = udg[13*ng+i];
//			double u15 = udg[14*ng+i];
//			double u16 = udg[15*ng+i];
//			double u17 = udg[16*ng+i];
//			double u18 = udg[17*ng+i];
//			double u19 = udg[18*ng+i];
//			double u20 = udg[19*ng+i];
//			double u21 = udg[20*ng+i];
//			double u22 = udg[21*ng+i];
//			double u23 = udg[22*ng+i];
//			double u24 = udg[23*ng+i];
//
//			double t2 = 1.0/(u1*u1);
//			double t3 = u2*u2;
//			double t4 = 1.0/(u1*u1*u1);
//			double t5 = u3*u3;
//			double t6 = u4*u4;
//			double t7 = 1.0/nu[i];
//			double t8 = 1.0/u1;
//			double t12 = 1.0/3.141592653589793;
//			double t13 = b*t7*t8*u6;
//			double t14 = atan(t13);
//			double t15 = t12*t14;
//			double t16 = t15+1.0/2.0;
//			double t17 = t7*t8*t16*u6;
//			double t9 = c+t17;
//			double t10 = t9*t9;
//			double t11 = cv1*cv1;
//			double t18 = 1.0/param3;
//			double t19 = cv1*t11+t9*t10;
//			double t20 = 1.0/t19;
//			double t21 = t10*t10;
//			double t22 = nu[i]*t20*t21;
//			double t23 = nu[i]+t22;
//			double t36 = t8*u2*u7;
//			double t24 = -t36+u8;
//			double t37 = t8*u3*u13;
//			double t25 = -t37+u15;
//			double t39 = t8*u4*u19;
//			double t26 = -t39+u22;
//			double t27 = 1.0/(nu[i]*nu[i]);
//			double t28 = u6*u6;
//			double t29 = t2*t7*t16*u6;
//			double t30 = b*b;
//			double t31 = t2*t27*t28*t30;
//			double t32 = t31+1.0;
//			double t33 = 1.0/t32;
//			double t34 = b*t4*t12*t27*t28*t33;
//			double t35 = t29+t34;
//			double t38 = t8*t25*(2.0/3.0);
//			double t40 = t8*t26*(2.0/3.0);
//			double t79 = t8*t24*(4.0/3.0);
//			double t41 = t38+t40-t79;
//			double t47 = t8*u3*u7;
//			double t42 = -t47+u9;
//			double t49 = t8*u2*u13;
//			double t43 = -t49+u14;
//			double t44 = nu[i]*t9*t10*t20*t35*4.0;
//			double t45 = 1.0/(t19*t19);
//			double t54 = nu[i]*t10*t21*t35*t45*3.0;
//			double t46 = t44-t54;
//			double t48 = t8*t42;
//			double t50 = t8*t43;
//			double t51 = t48+t50;
//			double t55 = t8*u4*u7;
//			double t52 = -t55+u10;
//			double t57 = t8*u2*u19;
//			double t53 = -t57+u20;
//			double t56 = t8*t52;
//			double t58 = t8*t53;
//			double t59 = t56+t58;
//			double t60 = t2*t3*(1.0/2.0);
//			double t61 = t2*t5*(1.0/2.0);
//			double t62 = t2*t6*(1.0/2.0);
//			double t63 = param1-1.0;
//			double t64 = t3*t4;
//			double t65 = t4*t5;
//			double t66 = t4*t6;
//			double t67 = t64+t65+t66;
//			double t92 = t67*u1;
//			double t68 = t60+t61+t62-t92;
//			double t69 = t2*t42;
//			double t70 = t2*t43;
//			double t103 = t4*u3*u7;
//			double t104 = t4*u2*u13;
//			double t71 = t69+t70-t103-t104;
//			double t72 = t2*t52;
//			double t73 = t2*t53;
//			double t143 = t4*u4*u7;
//			double t144 = t4*u2*u19;
//			double t74 = t72+t73-t143-t144;
//			double t75 = t2*t24*(4.0/3.0);
//			double t76 = t4*u3*u13*(2.0/3.0);
//			double t77 = t4*u4*u19*(2.0/3.0);
//			double t106 = t2*t26*(2.0/3.0);
//			double t151 = t2*t25*(2.0/3.0);
//			double t78 = t75+t76+t77-t106-t151-t4*u2*u7*(4.0/3.0);
//			double t80 = t60+t61+t62;
//			double t98 = t80*u1;
//			double t81 = -t98+u5;
//			double t82 = 1.0/PrTurb;
//			double t83 = 1.0/param4;
//			double t84 = 1.0/t63;
//			double t85 = t2*t24*u2;
//			double t86 = t2*t42*u3;
//			double t87 = t2*t52*u4;
//			double t88 = t85+t86+t87;
//			double t89 = t88*u1;
//			double t90 = t80*u7;
//			double t91 = t89+t90-u11;
//			double t93 = 1.0/(u1*u1*u1*u1);
//			double t94 = nu[i]*param1*t83*u1;
//			double t95 = nu[i]*param1*t20*t21*t82*u1;
//			double t96 = t94+t95;
//			double t97 = t63*t91*u1;
//			double t99 = t63*t81*u7;
//			double t100 = t97+t99;
//			double t101 = 1.0/sigma;
//			double t102 = t18*t23*t51;
//			double t105 = t102-t2*u2*u3-t18*t23*t71*u1-t18*t46*t51*u1;
//			double t107 = t8*t24*(2.0/3.0);
//			double t126 = t8*t25*(4.0/3.0);
//			double t108 = t40+t107-t126;
//			double t111 = t8*u4*u13;
//			double t109 = -t111+u16;
//			double t113 = t8*u3*u19;
//			double t110 = -t113+u21;
//			double t112 = t8*t109;
//			double t114 = t8*t110;
//			double t115 = t112+t114;
//			double t116 = t2*u5;
//			double t117 = t2*t63*t81;
//			double t118 = t8*t63*t68;
//			double t119 = t116+t117+t118;
//			double t120 = t2*t109;
//			double t121 = t2*t110;
//			double t147 = t4*u4*u13;
//			double t148 = t4*u3*u19;
//			double t122 = t120+t121-t147-t148;
//			double t123 = t2*t25*(4.0/3.0);
//			double t124 = t4*u2*u7*(2.0/3.0);
//			double t150 = t2*t24*(2.0/3.0);
//			double t125 = t77-t106+t123+t124-t150-t4*u3*u13*(4.0/3.0);
//			double t127 = nu[i]*param1*t83;
//			double t128 = nu[i]*param1*t20*t21*t82;
//			double t129 = nu[i]*param1*t10*t21*t35*t45*t82*u1*3.0;
//			double t156 = nu[i]*param1*t9*t10*t20*t35*t82*u1*4.0;
//			double t130 = t127+t128+t129-t156;
//			double t131 = t2*t43*u2;
//			double t132 = t2*t25*u3;
//			double t133 = t2*t109*u4;
//			double t134 = t131+t132+t133;
//			double t135 = t134*u1;
//			double t136 = t80*u13;
//			double t137 = t135+t136-u17;
//			double t138 = t63*t137*u1;
//			double t139 = t63*t81*u13;
//			double t140 = t138+t139;
//			double t141 = c+t17+1.0;
//			double t142 = t18*t23*t59;
//			double t145 = t142-t2*u2*u4-t18*t23*t74*u1-t18*t46*t59*u1;
//			double t146 = t18*t23*t115;
//			double t149 = t146-t2*u3*u4-t18*t23*t122*u1-t18*t46*t115*u1;
//			double t155 = t8*t26*(4.0/3.0);
//			double t152 = t38+t107-t155;
//			double t153 = t2*t26*(4.0/3.0);
//			double t154 = t76+t124-t150-t151+t153-t4*u4*u19*(4.0/3.0);
//			double t157 = t2*t53*u2;
//			double t158 = t2*t110*u3;
//			double t159 = t2*t26*u4;
//			double t160 = t157+t158+t159;
//			double t161 = t160*u1;
//			double t162 = t80*u19;
//			double t163 = t161+t162-u23;
//			double t164 = t63*t163*u1;
//			double t165 = t63*t81*u19;
//			double t166 = t164+t165;
//			double t167 = t8*u3;
//			double t184 = t8*t18*t23*u13;
//			double t168 = t167-t184;
//			double t169 = t8*u4;
//			double t175 = t8*t18*t23*u19;
//			double t170 = t169-t175;
//			double t171 = t8*t18*t23*u7*(2.0/3.0);
//			double t172 = t171-t8*t63*u2;
//			double t173 = t8*u2;
//			double t181 = t8*t18*t23*u7;
//			double t174 = t173-t181;
//			double t176 = t8*u5;
//			double t177 = t8*t63*t81;
//			double t178 = t8*u6;
//			double t179 = t8*t18*t23*u13*(2.0/3.0);
//			double t180 = t179-t8*t63*u3;
//			double t182 = t8*t18*t23*u19*(2.0/3.0);
//			double t185 = t8*t63*u4;
//			double t183 = t182-t185;
//			double t186 = t8*t63;
//			double t187 = t8+t186;
//			double t188 = t7*t8*t16;
//			double t189 = b*t2*t12*t27*t33*u6;
//			double t190 = t188+t189;
//			double t191 = nu[i]*t9*t10*t20*t190*4.0;
//			double t193 = nu[i]*t10*t21*t45*t190*3.0;
//			double t192 = t191-t193;
//			double t194 = u12-t8*u6*u7;
//			double t195 = t18*t51*t192*u1;
//			double t196 = nu[i]*param1*t9*t10*t20*t82*t190*u1*4.0;
//			double t201 = nu[i]*param1*t10*t21*t45*t82*t190*u1*3.0;
//			double t197 = t196-t201;
//			double t198 = u18-t8*u6*u13;
//			double t199 = t18*t59*t192*u1;
//			double t200 = t18*t115*t192*u1;
//			double t202 = u24-t8*u6*u19;
//			double t203 = t8*t18*t23*u2*(2.0/3.0);
//			double t204 = t18*t23;
//			double t205 = t8*t18*t23*u2;
//			double t206 = t8*t18*t23*u4;
//			double t207 = t63*t81;
//			double t208 = t63*t68*u1;
//			double t209 = t207+t208;
//			double t210 = t8*t18*t23*u3*(2.0/3.0);
//			double t211 = t8*t18*t23*u3;
//			double t212 = t18*t23*(4.0/3.0);
//			double t219 = t2*t18*t96*u4;
//			double t213 = t206-t219;
//			double t214 = t8*t18*t96;
//			double t215 = nu[i]*t18*t101*t141;
//			double t216 = t8*t18*t23*u4*(2.0/3.0);
//			double t217 = t205-t2*t18*t96*u2;
//			double t218 = t211-t2*t18*t96*u3;
//
//			f_udg[0*ng+i] = 0.0;
//			f_udg[1*ng+i] = -t2*t3-t63*t68-t18*t23*t41+t18*t41*t46*u1-t18*t23*t78*u1;
//			f_udg[2*ng+i] = t105;
//			f_udg[3*ng+i] = t145;
//			f_udg[4*ng+i] = -t119*u2+t18*t41*t46*u2-t18*t23*t71*u3-t18*t46*t51*u3-t18*t23*t74*u4-t18*t23*t78*u2-t18*t46*t59*u4-t2*t18*t84*t96*(t63*t91-t63*t68*u7+t63*u1*(t85+t86+t87-t67*u7-u1*(t4*t24*u2*2.0+t4*t42*u3*2.0+t4*t52*u4*2.0-t3*t93*u7-t5*t93*u7-t6*t93*u7)))+t4*t18*t84*t96*t100*2.0-t2*t18*t84*t100*t130;
//			f_udg[5*ng+i] = -t2*u2*u6-nu[i]*t18*t35*t101*t194+nu[i]*t2*t18*t101*t141*u6*u7;
//			f_udg[6*ng+i] = 0.0;
//			f_udg[7*ng+i] = t105;
//			f_udg[8*ng+i] = -t2*t5-t63*t68-t18*t23*t108-t18*t23*t125*u1+t18*t46*t108*u1;
//			f_udg[9*ng+i] = t149;
//			f_udg[10*ng+i] = -t119*u3-t18*t23*t71*u2-t18*t46*t51*u2-t18*t23*t122*u4-t18*t23*t125*u3+t18*t46*t108*u3-t18*t46*t115*u4-t2*t18*t84*t96*(t63*t137-t63*t68*u13+t63*u1*(t131+t132+t133-t67*u13-u1*(t4*t25*u3*2.0+t4*t43*u2*2.0-t3*t93*u13-t5*t93*u13-t6*t93*u13+t4*t109*u4*2.0)))+t4*t18*t84*t96*t140*2.0-t2*t18*t84*t130*t140;
//			f_udg[11*ng+i] = -t2*u3*u6-nu[i]*t18*t35*t101*t198+nu[i]*t2*t18*t101*t141*u6*u13;
//			f_udg[12*ng+i] = 0.0;
//			f_udg[13*ng+i] = t145;
//			f_udg[14*ng+i] = t149;
//			f_udg[15*ng+i] = -t2*t6-t63*t68-t18*t23*t152-t18*t23*t154*u1+t18*t46*t152*u1;
//			f_udg[16*ng+i] = -t119*u4-t18*t23*t74*u2-t18*t46*t59*u2-t18*t23*t122*u3-t18*t46*t115*u3-t18*t23*t154*u4+t18*t46*t152*u4-t2*t18*t84*t96*(t63*t163-t63*t68*u19+t63*u1*(t157+t158+t159-t67*u19-u1*(t4*t26*u4*2.0+t4*t53*u2*2.0-t3*t93*u19+t4*t110*u3*2.0-t5*t93*u19-t6*t93*u19)))+t4*t18*t84*t96*t166*2.0-t2*t18*t84*t130*t166;
//			f_udg[17*ng+i] = -t2*u4*u6-nu[i]*t18*t35*t101*t202+nu[i]*t2*t18*t101*t141*u6*u19;
//			f_udg[18*ng+i] = 1.0;
//			f_udg[19*ng+i] = t8*u2*2.0-t8*t63*u2-t8*t18*t23*u7*(4.0/3.0);
//			f_udg[20*ng+i] = t168;
//			f_udg[21*ng+i] = t170;
//			f_udg[22*ng+i] = t176+t177-t2*t3*t63-t18*t23*t41-t2*t18*t84*t96*(t63*u1*(u1*(t2*t24-t4*u2*u7)+t2*u2*u7)-t8*t63*u2*u7)-t2*t18*t23*u2*u7*(4.0/3.0)-t2*t18*t23*u3*u13-t2*t18*t23*u4*u19;
//			f_udg[23*ng+i] = t178;
//			f_udg[24*ng+i] = 0.0;
//			f_udg[25*ng+i] = t168;
//			f_udg[26*ng+i] = t172;
//			f_udg[27*ng+i] = 0.0;
//			f_udg[28*ng+i] = t102-t2*t63*u2*u3-t2*t18*t84*t96*(t63*u1*(u1*(t70-t104)+t2*u2*u13)-t8*t63*u2*u13)+t2*t18*t23*u3*u7*(2.0/3.0)-t2*t18*t23*u2*u13;
//			f_udg[29*ng+i] = 0.0;
//			f_udg[30*ng+i] = 0.0;
//			f_udg[31*ng+i] = t170;
//			f_udg[32*ng+i] = 0.0;
//			f_udg[33*ng+i] = t172;
//			f_udg[34*ng+i] = t142-t2*t63*u2*u4-t2*t18*t84*t96*(t63*u1*(u1*(t73-t144)+t2*u2*u19)-t8*t63*u2*u19)+t2*t18*t23*u4*u7*(2.0/3.0)-t2*t18*t23*u2*u19;
//			f_udg[35*ng+i] = 0.0;
//			f_udg[36*ng+i] = 0.0;
//			f_udg[37*ng+i] = t180;
//			f_udg[38*ng+i] = t174;
//			f_udg[39*ng+i] = 0.0;
//			f_udg[40*ng+i] = t102-t2*t63*u2*u3-t2*t18*t84*t96*(t63*u1*(u1*(t69-t103)+t2*u3*u7)-t8*t63*u3*u7)-t2*t18*t23*u3*u7+t2*t18*t23*u2*u13*(2.0/3.0);
//			f_udg[41*ng+i] = 0.0;
//			f_udg[42*ng+i] = 1.0;
//			f_udg[43*ng+i] = t174;
//			f_udg[44*ng+i] = t8*u3*2.0-t8*t63*u3-t8*t18*t23*u13*(4.0/3.0);
//			f_udg[45*ng+i] = t170;
//			f_udg[46*ng+i] = t176+t177-t2*t5*t63-t18*t23*t108-t2*t18*t84*t96*(t63*u1*(u1*(t2*t25-t4*u3*u13)+t2*u3*u13)-t8*t63*u3*u13)-t2*t18*t23*u2*u7-t2*t18*t23*u3*u13*(4.0/3.0)-t2*t18*t23*u4*u19;
//			f_udg[47*ng+i] = t178;
//			f_udg[48*ng+i] = 0.0;
//			f_udg[49*ng+i] = 0.0;
//			f_udg[50*ng+i] = t170;
//			f_udg[51*ng+i] = t180;
//			f_udg[52*ng+i] = t146-t2*t63*u3*u4-t2*t18*t84*t96*(t63*u1*(u1*(t121-t148)+t2*u3*u19)-t8*t63*u3*u19)+t2*t18*t23*u4*u13*(2.0/3.0)-t2*t18*t23*u3*u19;
//			f_udg[53*ng+i] = 0.0;
//			f_udg[54*ng+i] = 0.0;
//			f_udg[55*ng+i] = t183;
//			f_udg[56*ng+i] = 0.0;
//			f_udg[57*ng+i] = t174;
//			f_udg[58*ng+i] = t142-t2*t63*u2*u4-t2*t18*t84*t96*(t63*u1*(u1*(t72-t143)+t2*u4*u7)-t8*t63*u4*u7)-t2*t18*t23*u4*u7+t2*t18*t23*u2*u19*(2.0/3.0);
//			f_udg[59*ng+i] = 0.0;
//			f_udg[60*ng+i] = 0.0;
//			f_udg[61*ng+i] = 0.0;
//			f_udg[62*ng+i] = t183;
//			f_udg[63*ng+i] = t168;
//			f_udg[64*ng+i] = t146-t2*t63*u3*u4-t2*t18*t84*t96*(t63*u1*(u1*(t120-t147)+t2*u4*u13)-t8*t63*u4*u13)-t2*t18*t23*u4*u13+t2*t18*t23*u3*u19*(2.0/3.0);
//			f_udg[65*ng+i] = 0.0;
//			f_udg[66*ng+i] = 1.0;
//			f_udg[67*ng+i] = t174;
//			f_udg[68*ng+i] = t168;
//			f_udg[69*ng+i] = -t185+t8*u4*2.0-t8*t18*t23*u19*(4.0/3.0);
//			f_udg[70*ng+i] = t176+t177-t2*t6*t63-t18*t23*t152-t2*t18*t84*t96*(t63*u1*(u1*(t2*t26-t4*u4*u19)+t2*u4*u19)-t8*t63*u4*u19)-t2*t18*t23*u2*u7-t2*t18*t23*u3*u13-t2*t18*t23*u4*u19*(4.0/3.0);
//			f_udg[71*ng+i] = t178;
//			f_udg[72*ng+i] = 0.0;
//			f_udg[73*ng+i] = t63;
//			f_udg[74*ng+i] = 0.0;
//			f_udg[75*ng+i] = 0.0;
//			f_udg[76*ng+i] = t187*u2-t2*t18*t96*u7;
//			f_udg[77*ng+i] = 0.0;
//			f_udg[78*ng+i] = 0.0;
//			f_udg[79*ng+i] = 0.0;
//			f_udg[80*ng+i] = t63;
//			f_udg[81*ng+i] = 0.0;
//			f_udg[82*ng+i] = t187*u3-t2*t18*t96*u13;
//			f_udg[83*ng+i] = 0.0;
//			f_udg[84*ng+i] = 0.0;
//			f_udg[85*ng+i] = 0.0;
//			f_udg[86*ng+i] = 0.0;
//			f_udg[87*ng+i] = t63;
//			f_udg[88*ng+i] = t187*u4-t2*t18*t96*u19;
//			f_udg[89*ng+i] = 0.0;
//			f_udg[90*ng+i] = 0.0;
//			f_udg[91*ng+i] = -t18*t41*t192*u1;
//			f_udg[92*ng+i] = t195;
//			f_udg[93*ng+i] = t199;
//			f_udg[94*ng+i] = -t18*t41*t192*u2+t18*t51*t192*u3+t18*t59*t192*u4-t2*t18*t84*t100*t197;
//			f_udg[95*ng+i] = t173+nu[i]*t18*t101*t190*t194-nu[i]*t8*t18*t101*t141*u7;
//			f_udg[96*ng+i] = 0.0;
//			f_udg[97*ng+i] = t195;
//			f_udg[98*ng+i] = -t18*t108*t192*u1;
//			f_udg[99*ng+i] = t200;
//			f_udg[100*ng+i] = t18*t51*t192*u2-t18*t108*t192*u3+t18*t115*t192*u4-t2*t18*t84*t140*t197;
//			f_udg[101*ng+i] = t167+nu[i]*t18*t101*t190*t198-nu[i]*t8*t18*t101*t141*u13;
//			f_udg[102*ng+i] = 0.0;
//			f_udg[103*ng+i] = t199;
//			f_udg[104*ng+i] = t200;
//			f_udg[105*ng+i] = -t18*t152*t192*u1;
//			f_udg[106*ng+i] = t18*t59*t192*u2+t18*t115*t192*u3-t18*t152*t192*u4-t2*t18*t84*t166*t197;
//			f_udg[107*ng+i] = t169+nu[i]*t18*t101*t190*t202-nu[i]*t8*t18*t101*t141*u19;
//			f_udg[108*ng+i] = 0.0;
//			f_udg[109*ng+i] = t8*t18*t23*u2*(-4.0/3.0);
//			f_udg[110*ng+i] = -t8*t18*t23*u3;
//			f_udg[111*ng+i] = -t8*t18*t23*u4;
//			f_udg[112*ng+i] = t2*t3*t18*t23*(-4.0/3.0)-t2*t5*t18*t23-t2*t6*t18*t23-t2*t18*t84*t96*t209;
//			f_udg[113*ng+i] = -nu[i]*t8*t18*t101*t141*u6;
//			f_udg[114*ng+i] = 0.0;
//			f_udg[115*ng+i] = -t8*t18*t23*u3;
//			f_udg[116*ng+i] = t203;
//			f_udg[117*ng+i] = 0.0;
//			f_udg[118*ng+i] = t2*t18*t23*u2*u3*(-1.0/3.0);
//			f_udg[119*ng+i] = 0.0;
//			f_udg[120*ng+i] = 0.0;
//			f_udg[121*ng+i] = -t8*t18*t23*u4;
//			f_udg[122*ng+i] = 0.0;
//			f_udg[123*ng+i] = t203;
//			f_udg[124*ng+i] = t2*t18*t23*u2*u4*(-1.0/3.0);
//			f_udg[125*ng+i] = 0.0;
//			f_udg[126*ng+i] = 0.0;
//			f_udg[127*ng+i] = t212;
//			f_udg[128*ng+i] = 0.0;
//			f_udg[129*ng+i] = 0.0;
//			f_udg[130*ng+i] = t8*t18*t23*u2*(4.0/3.0)-t2*t18*t96*u2;
//			f_udg[131*ng+i] = 0.0;
//			f_udg[132*ng+i] = 0.0;
//			f_udg[133*ng+i] = 0.0;
//			f_udg[134*ng+i] = t18*t23*(-2.0/3.0);
//			f_udg[135*ng+i] = 0.0;
//			f_udg[136*ng+i] = t8*t18*t23*u3*(-2.0/3.0);
//			f_udg[137*ng+i] = 0.0;
//			f_udg[138*ng+i] = 0.0;
//			f_udg[139*ng+i] = 0.0;
//			f_udg[140*ng+i] = 0.0;
//			f_udg[141*ng+i] = t18*t23*(-2.0/3.0);
//			f_udg[142*ng+i] = t8*t18*t23*u4*(-2.0/3.0);
//			f_udg[143*ng+i] = 0.0;
//			f_udg[144*ng+i] = 0.0;
//			f_udg[145*ng+i] = 0.0;
//			f_udg[146*ng+i] = t204;
//			f_udg[147*ng+i] = 0.0;
//			f_udg[148*ng+i] = t218;
//			f_udg[149*ng+i] = 0.0;
//			f_udg[150*ng+i] = 0.0;
//			f_udg[151*ng+i] = t204;
//			f_udg[152*ng+i] = 0.0;
//			f_udg[153*ng+i] = 0.0;
//			f_udg[154*ng+i] = t205;
//			f_udg[155*ng+i] = 0.0;
//			f_udg[156*ng+i] = 0.0;
//			f_udg[157*ng+i] = 0.0;
//			f_udg[158*ng+i] = 0.0;
//			f_udg[159*ng+i] = 0.0;
//			f_udg[160*ng+i] = 0.0;
//			f_udg[161*ng+i] = 0.0;
//			f_udg[162*ng+i] = 0.0;
//			f_udg[163*ng+i] = 0.0;
//			f_udg[164*ng+i] = 0.0;
//			f_udg[165*ng+i] = t204;
//			f_udg[166*ng+i] = t213;
//			f_udg[167*ng+i] = 0.0;
//			f_udg[168*ng+i] = 0.0;
//			f_udg[169*ng+i] = 0.0;
//			f_udg[170*ng+i] = 0.0;
//			f_udg[171*ng+i] = 0.0;
//			f_udg[172*ng+i] = 0.0;
//			f_udg[173*ng+i] = 0.0;
//			f_udg[174*ng+i] = 0.0;
//			f_udg[175*ng+i] = t204;
//			f_udg[176*ng+i] = 0.0;
//			f_udg[177*ng+i] = 0.0;
//			f_udg[178*ng+i] = t205;
//			f_udg[179*ng+i] = 0.0;
//			f_udg[180*ng+i] = 0.0;
//			f_udg[181*ng+i] = 0.0;
//			f_udg[182*ng+i] = 0.0;
//			f_udg[183*ng+i] = 0.0;
//			f_udg[184*ng+i] = t214;
//			f_udg[185*ng+i] = 0.0;
//			f_udg[186*ng+i] = 0.0;
//			f_udg[187*ng+i] = 0.0;
//			f_udg[188*ng+i] = 0.0;
//			f_udg[189*ng+i] = 0.0;
//			f_udg[190*ng+i] = 0.0;
//			f_udg[191*ng+i] = 0.0;
//			f_udg[192*ng+i] = 0.0;
//			f_udg[193*ng+i] = 0.0;
//			f_udg[194*ng+i] = 0.0;
//			f_udg[195*ng+i] = 0.0;
//			f_udg[196*ng+i] = 0.0;
//			f_udg[197*ng+i] = 0.0;
//			f_udg[198*ng+i] = 0.0;
//			f_udg[199*ng+i] = 0.0;
//			f_udg[200*ng+i] = 0.0;
//			f_udg[201*ng+i] = 0.0;
//			f_udg[202*ng+i] = 0.0;
//			f_udg[203*ng+i] = t215;
//			f_udg[204*ng+i] = 0.0;
//			f_udg[205*ng+i] = 0.0;
//			f_udg[206*ng+i] = 0.0;
//			f_udg[207*ng+i] = 0.0;
//			f_udg[208*ng+i] = 0.0;
//			f_udg[209*ng+i] = 0.0;
//			f_udg[210*ng+i] = 0.0;
//			f_udg[211*ng+i] = 0.0;
//			f_udg[212*ng+i] = 0.0;
//			f_udg[213*ng+i] = 0.0;
//			f_udg[214*ng+i] = 0.0;
//			f_udg[215*ng+i] = 0.0;
//			f_udg[216*ng+i] = 0.0;
//			f_udg[217*ng+i] = t210;
//			f_udg[218*ng+i] = -t205;
//			f_udg[219*ng+i] = 0.0;
//			f_udg[220*ng+i] = t2*t18*t23*u2*u3*(-1.0/3.0);
//			f_udg[221*ng+i] = 0.0;
//			f_udg[222*ng+i] = 0.0;
//			f_udg[223*ng+i] = -t205;
//			f_udg[224*ng+i] = t8*t18*t23*u3*(-4.0/3.0);
//			f_udg[225*ng+i] = -t206;
//			f_udg[226*ng+i] = -t2*t3*t18*t23-t2*t5*t18*t23*(4.0/3.0)-t2*t6*t18*t23-t2*t18*t84*t96*t209;
//			f_udg[227*ng+i] = -nu[i]*t8*t18*t101*t141*u6;
//			f_udg[228*ng+i] = 0.0;
//			f_udg[229*ng+i] = 0.0;
//			f_udg[230*ng+i] = -t206;
//			f_udg[231*ng+i] = t210;
//			f_udg[232*ng+i] = t2*t18*t23*u3*u4*(-1.0/3.0);
//			f_udg[233*ng+i] = 0.0;
//			f_udg[234*ng+i] = 0.0;
//			f_udg[235*ng+i] = 0.0;
//			f_udg[236*ng+i] = t204;
//			f_udg[237*ng+i] = 0.0;
//			f_udg[238*ng+i] = t211;
//			f_udg[239*ng+i] = 0.0;
//			f_udg[240*ng+i] = 0.0;
//			f_udg[241*ng+i] = t204;
//			f_udg[242*ng+i] = 0.0;
//			f_udg[243*ng+i] = 0.0;
//			f_udg[244*ng+i] = t217;
//			f_udg[245*ng+i] = 0.0;
//			f_udg[246*ng+i] = 0.0;
//			f_udg[247*ng+i] = 0.0;
//			f_udg[248*ng+i] = 0.0;
//			f_udg[249*ng+i] = 0.0;
//			f_udg[250*ng+i] = 0.0;
//			f_udg[251*ng+i] = 0.0;
//			f_udg[252*ng+i] = 0.0;
//			f_udg[253*ng+i] = t18*t23*(-2.0/3.0);
//			f_udg[254*ng+i] = 0.0;
//			f_udg[255*ng+i] = 0.0;
//			f_udg[256*ng+i] = -t203;
//			f_udg[257*ng+i] = 0.0;
//			f_udg[258*ng+i] = 0.0;
//			f_udg[259*ng+i] = 0.0;
//			f_udg[260*ng+i] = t212;
//			f_udg[261*ng+i] = 0.0;
//			f_udg[262*ng+i] = t8*t18*t23*u3*(4.0/3.0)-t2*t18*t96*u3;
//			f_udg[263*ng+i] = 0.0;
//			f_udg[264*ng+i] = 0.0;
//			f_udg[265*ng+i] = 0.0;
//			f_udg[266*ng+i] = 0.0;
//			f_udg[267*ng+i] = t18*t23*(-2.0/3.0);
//			f_udg[268*ng+i] = t8*t18*t23*u4*(-2.0/3.0);
//			f_udg[269*ng+i] = 0.0;
//			f_udg[270*ng+i] = 0.0;
//			f_udg[271*ng+i] = 0.0;
//			f_udg[272*ng+i] = 0.0;
//			f_udg[273*ng+i] = 0.0;
//			f_udg[274*ng+i] = 0.0;
//			f_udg[275*ng+i] = 0.0;
//			f_udg[276*ng+i] = 0.0;
//			f_udg[277*ng+i] = 0.0;
//			f_udg[278*ng+i] = 0.0;
//			f_udg[279*ng+i] = t204;
//			f_udg[280*ng+i] = t213;
//			f_udg[281*ng+i] = 0.0;
//			f_udg[282*ng+i] = 0.0;
//			f_udg[283*ng+i] = 0.0;
//			f_udg[284*ng+i] = t204;
//			f_udg[285*ng+i] = 0.0;
//			f_udg[286*ng+i] = t211;
//			f_udg[287*ng+i] = 0.0;
//			f_udg[288*ng+i] = 0.0;
//			f_udg[289*ng+i] = 0.0;
//			f_udg[290*ng+i] = 0.0;
//			f_udg[291*ng+i] = 0.0;
//			f_udg[292*ng+i] = 0.0;
//			f_udg[293*ng+i] = 0.0;
//			f_udg[294*ng+i] = 0.0;
//			f_udg[295*ng+i] = 0.0;
//			f_udg[296*ng+i] = 0.0;
//			f_udg[297*ng+i] = 0.0;
//			f_udg[298*ng+i] = t214;
//			f_udg[299*ng+i] = 0.0;
//			f_udg[300*ng+i] = 0.0;
//			f_udg[301*ng+i] = 0.0;
//			f_udg[302*ng+i] = 0.0;
//			f_udg[303*ng+i] = 0.0;
//			f_udg[304*ng+i] = 0.0;
//			f_udg[305*ng+i] = 0.0;
//			f_udg[306*ng+i] = 0.0;
//			f_udg[307*ng+i] = 0.0;
//			f_udg[308*ng+i] = 0.0;
//			f_udg[309*ng+i] = 0.0;
//			f_udg[310*ng+i] = 0.0;
//			f_udg[311*ng+i] = 0.0;
//			f_udg[312*ng+i] = 0.0;
//			f_udg[313*ng+i] = 0.0;
//			f_udg[314*ng+i] = 0.0;
//			f_udg[315*ng+i] = 0.0;
//			f_udg[316*ng+i] = 0.0;
//			f_udg[317*ng+i] = t215;
//			f_udg[318*ng+i] = 0.0;
//			f_udg[319*ng+i] = 0.0;
//			f_udg[320*ng+i] = 0.0;
//			f_udg[321*ng+i] = 0.0;
//			f_udg[322*ng+i] = 0.0;
//			f_udg[323*ng+i] = 0.0;
//			f_udg[324*ng+i] = 0.0;
//			f_udg[325*ng+i] = t216;
//			f_udg[326*ng+i] = 0.0;
//			f_udg[327*ng+i] = -t205;
//			f_udg[328*ng+i] = t2*t18*t23*u2*u4*(-1.0/3.0);
//			f_udg[329*ng+i] = 0.0;
//			f_udg[330*ng+i] = 0.0;
//			f_udg[331*ng+i] = 0.0;
//			f_udg[332*ng+i] = t216;
//			f_udg[333*ng+i] = -t211;
//			f_udg[334*ng+i] = t2*t18*t23*u3*u4*(-1.0/3.0);
//			f_udg[335*ng+i] = 0.0;
//			f_udg[336*ng+i] = 0.0;
//			f_udg[337*ng+i] = -t205;
//			f_udg[338*ng+i] = -t211;
//			f_udg[339*ng+i] = t8*t18*t23*u4*(-4.0/3.0);
//			f_udg[340*ng+i] = -t2*t3*t18*t23-t2*t5*t18*t23-t2*t6*t18*t23*(4.0/3.0)-t2*t18*t84*t96*t209;
//			f_udg[341*ng+i] = -nu[i]*t8*t18*t101*t141*u6;
//			f_udg[342*ng+i] = 0.0;
//			f_udg[343*ng+i] = 0.0;
//			f_udg[344*ng+i] = 0.0;
//			f_udg[345*ng+i] = t204;
//			f_udg[346*ng+i] = t206;
//			f_udg[347*ng+i] = 0.0;
//			f_udg[348*ng+i] = 0.0;
//			f_udg[349*ng+i] = 0.0;
//			f_udg[350*ng+i] = 0.0;
//			f_udg[351*ng+i] = 0.0;
//			f_udg[352*ng+i] = 0.0;
//			f_udg[353*ng+i] = 0.0;
//			f_udg[354*ng+i] = 0.0;
//			f_udg[355*ng+i] = t204;
//			f_udg[356*ng+i] = 0.0;
//			f_udg[357*ng+i] = 0.0;
//			f_udg[358*ng+i] = t217;
//			f_udg[359*ng+i] = 0.0;
//			f_udg[360*ng+i] = 0.0;
//			f_udg[361*ng+i] = 0.0;
//			f_udg[362*ng+i] = 0.0;
//			f_udg[363*ng+i] = 0.0;
//			f_udg[364*ng+i] = 0.0;
//			f_udg[365*ng+i] = 0.0;
//			f_udg[366*ng+i] = 0.0;
//			f_udg[367*ng+i] = 0.0;
//			f_udg[368*ng+i] = 0.0;
//			f_udg[369*ng+i] = t204;
//			f_udg[370*ng+i] = t206;
//			f_udg[371*ng+i] = 0.0;
//			f_udg[372*ng+i] = 0.0;
//			f_udg[373*ng+i] = 0.0;
//			f_udg[374*ng+i] = t204;
//			f_udg[375*ng+i] = 0.0;
//			f_udg[376*ng+i] = t218;
//			f_udg[377*ng+i] = 0.0;
//			f_udg[378*ng+i] = 0.0;
//			f_udg[379*ng+i] = t18*t23*(-2.0/3.0);
//			f_udg[380*ng+i] = 0.0;
//			f_udg[381*ng+i] = 0.0;
//			f_udg[382*ng+i] = -t203;
//			f_udg[383*ng+i] = 0.0;
//			f_udg[384*ng+i] = 0.0;
//			f_udg[385*ng+i] = 0.0;
//			f_udg[386*ng+i] = t18*t23*(-2.0/3.0);
//			f_udg[387*ng+i] = 0.0;
//			f_udg[388*ng+i] = -t210;
//			f_udg[389*ng+i] = 0.0;
//			f_udg[390*ng+i] = 0.0;
//			f_udg[391*ng+i] = 0.0;
//			f_udg[392*ng+i] = 0.0;
//			f_udg[393*ng+i] = t212;
//			f_udg[394*ng+i] = -t219+t8*t18*t23*u4*(4.0/3.0);
//			f_udg[395*ng+i] = 0.0;
//			f_udg[396*ng+i] = 0.0;
//			f_udg[397*ng+i] = 0.0;
//			f_udg[398*ng+i] = 0.0;
//			f_udg[399*ng+i] = 0.0;
//			f_udg[400*ng+i] = 0.0;
//			f_udg[401*ng+i] = 0.0;
//			f_udg[402*ng+i] = 0.0;
//			f_udg[403*ng+i] = 0.0;
//			f_udg[404*ng+i] = 0.0;
//			f_udg[405*ng+i] = 0.0;
//			f_udg[406*ng+i] = 0.0;
//			f_udg[407*ng+i] = 0.0;
//			f_udg[408*ng+i] = 0.0;
//			f_udg[409*ng+i] = 0.0;
//			f_udg[410*ng+i] = 0.0;
//			f_udg[411*ng+i] = 0.0;
//			f_udg[412*ng+i] = t214;
//			f_udg[413*ng+i] = 0.0;
//			f_udg[414*ng+i] = 0.0;
//			f_udg[415*ng+i] = 0.0;
//			f_udg[416*ng+i] = 0.0;
//			f_udg[417*ng+i] = 0.0;
//			f_udg[418*ng+i] = 0.0;
//			f_udg[419*ng+i] = 0.0;
//			f_udg[420*ng+i] = 0.0;
//			f_udg[421*ng+i] = 0.0;
//			f_udg[422*ng+i] = 0.0;
//			f_udg[423*ng+i] = 0.0;
//			f_udg[424*ng+i] = 0.0;
//			f_udg[425*ng+i] = 0.0;
//			f_udg[426*ng+i] = 0.0;
//			f_udg[427*ng+i] = 0.0;
//			f_udg[428*ng+i] = 0.0;
//			f_udg[429*ng+i] = 0.0;
//			f_udg[430*ng+i] = 0.0;
//			f_udg[431*ng+i] = t215;
//		}
//
//		if (app.viscosityModel != 0) {
//
//			for (int i = 0; i <ng; i++) {
//				double x1 = pg[0*ng+i];
//				double x2 = pg[1*ng+i];
//				double x3 = pg[2*ng+i];
//
//				double u1 = udg[0*ng+i];
//				double u2 = udg[1*ng+i];
//				double u3 = udg[2*ng+i];
//				double u4 = udg[3*ng+i];
//				double u5 = udg[4*ng+i];
//				double u6 = udg[5*ng+i];
//				double u7 = udg[6*ng+i];
//				double u8 = udg[7*ng+i];
//				double u9 = udg[8*ng+i];
//				double u10 = udg[9*ng+i];
//				double u11 = udg[10*ng+i];
//				double u12 = udg[11*ng+i];
//				double u13 = udg[12*ng+i];
//				double u14 = udg[13*ng+i];
//				double u15 = udg[14*ng+i];
//				double u16 = udg[15*ng+i];
//				double u17 = udg[16*ng+i];
//				double u18 = udg[17*ng+i];
//				double u19 = udg[18*ng+i];
//				double u20 = udg[19*ng+i];
//				double u21 = udg[20*ng+i];
//				double u22 = udg[21*ng+i];
//				double u23 = udg[22*ng+i];
//				double u24 = udg[23*ng+i];
//
//				double t2 = 1.0/u1;
//				double t3 = 1.0/nu[i];
//				double t7 = 1.0/3.141592653589793;
//				double t8 = b*t2*t3*u6;
//				double t9 = atan(t8);
//				double t10 = t7*t9;
//				double t11 = t10+1.0/2.0;
//				double t12 = t2*t3*t11*u6;
//				double t4 = c+t12;
//				double t5 = t4*t4;
//				double t6 = cv1*cv1;
//				double t13 = cv1*t6+t4*t5;
//				double t14 = 1.0/t13;
//				double t15 = 1.0/(nu[i]*nu[i]);
//				double t16 = 1.0/(u1*u1);
//				double t17 = u6*u6;
//				double t18 = t2*t11*t15*u6;
//				double t19 = 1.0/(nu[i]*nu[i]*nu[i]);
//				double t20 = b*b;
//				double t21 = t15*t16*t17*t20;
//				double t22 = t21+1.0;
//				double t23 = 1.0/t22;
//				double t24 = b*t7*t16*t17*t19*t23;
//				double t25 = t18+t24;
//				double t26 = t5*t5;
//				double t27 = 1.0/param3;
//				double t28 = t14*t26;
//				double t29 = 1.0/(t13*t13);
//				double t30 = nu[i]*t5*t25*t26*t29*3.0;
//				double t32 = nu[i]*t4*t5*t14*t25*4.0;
//				double t31 = t28+t30-t32+1.0;
//				double t50 = t2*u3*u7;
//				double t33 = -t50+u9;
//				double t34 = t2*t33;
//				double t63 = t2*u2*u13;
//				double t35 = -t63+u14;
//				double t36 = t2*t35;
//				double t37 = t34+t36;
//				double t51 = t2*u4*u7;
//				double t38 = -t51+u10;
//				double t39 = t2*t38;
//				double t84 = t2*u2*u19;
//				double t40 = -t84+u20;
//				double t41 = t2*t40;
//				double t42 = t39+t41;
//				double t49 = t2*u2*u7;
//				double t43 = -t49+u8;
//				double t65 = t2*u3*u13;
//				double t44 = -t65+u15;
//				double t45 = t2*t44*(2.0/3.0);
//				double t66 = t2*u4*u19;
//				double t46 = -t66+u22;
//				double t47 = t2*t46*(2.0/3.0);
//				double t48 = t45+t47-t2*t43*(4.0/3.0);
//				double t52 = u2*u2;
//				double t53 = t16*t52*(1.0/2.0);
//				double t54 = u3*u3;
//				double t55 = t16*t54*(1.0/2.0);
//				double t56 = u4*u4;
//				double t57 = t16*t56*(1.0/2.0);
//				double t58 = t53+t55+t57;
//				double t59 = param1-1.0;
//				double t60 = 1.0/PrTurb;
//				double t61 = 1.0/sigma;
//				double t62 = u12-t2*u6*u7;
//				double t64 = t27*t31*t37*u1;
//				double t74 = t2*u4*u13;
//				double t67 = -t74+u16;
//				double t68 = t2*t67;
//				double t86 = t2*u3*u19;
//				double t69 = -t86+u21;
//				double t70 = t2*t69;
//				double t71 = t68+t70;
//				double t72 = t2*t43*(2.0/3.0);
//				double t73 = t47+t72-t2*t44*(4.0/3.0);
//				double t89 = t58*u1;
//				double t75 = -t89+u5;
//				double t76 = 1.0/t59;
//				double t77 = 1.0/param4;
//				double t78 = param1*t77*u1;
//				double t79 = param1*t14*t26*t60*u1;
//				double t80 = nu[i]*param1*t5*t25*t26*t29*t60*u1*3.0;
//				double t90 = nu[i]*param1*t4*t5*t14*t25*t60*u1*4.0;
//				double t81 = t78+t79+t80-t90;
//				double t82 = c+t12+1.0;
//				double t83 = u18-t2*u6*u13;
//				double t85 = t27*t31*t42*u1;
//				double t87 = t27*t31*t71*u1;
//				double t88 = t45+t72-t2*t46*(4.0/3.0);
//				double t91 = u24-t2*u6*u19;
//
//				f_nu[0*ng+i] = 0.0;
//				f_nu[1*ng+i] = -t27*t31*t48*u1;
//				f_nu[2*ng+i] = t64;
//				f_nu[3*ng+i] = t85;
//				f_nu[4*ng+i] = t27*t31*t37*u3+t27*t31*t42*u4-t27*t31*t48*u2-t16*t27*t76*t81*(t59*u1*(-u11+t58*u7+u1*(t16*t33*u3+t16*t38*u4+t16*t43*u2))+t59*t75*u7);
//				f_nu[5*ng+i] = t27*t61*t62*t82-nu[i]*t25*t27*t61*t62;
//				f_nu[6*ng+i] = 0.0;
//				f_nu[7*ng+i] = t64;
//				f_nu[8*ng+i] = -t27*t31*t73*u1;
//				f_nu[9*ng+i] = t87;
//				f_nu[10*ng+i] = t27*t31*t37*u2+t27*t31*t71*u4-t27*t31*t73*u3-t16*t27*t76*t81*(t59*u1*(-u17+t58*u13+u1*(t16*t35*u2+t16*t44*u3+t16*t67*u4))+t59*t75*u13);
//				f_nu[11*ng+i] = t27*t61*t82*t83-nu[i]*t25*t27*t61*t83;
//				f_nu[12*ng+i] = 0.0;
//				f_nu[13*ng+i] = t85;
//				f_nu[14*ng+i] = t87;
//				f_nu[15*ng+i] = -t27*t31*t88*u1;
//				f_nu[16*ng+i] = t27*t31*t42*u2+t27*t31*t71*u3-t27*t31*t88*u4-t16*t27*t76*t81*(t59*u1*(-u23+t58*u19+u1*(t16*t40*u2+t16*t46*u4+t16*t69*u3))+t59*t75*u19);
//				f_nu[17*ng+i] = t27*t61*t82*t91-nu[i]*t25*t27*t61*t91;
//			}
//
//			chainRule_f_udg(f_udg, f_nu, nu_udg, ng, nc, ncu, nd);
//		}
//	}

	/* Deallocate dynamic memory */
	delete[] mu;
	if (computeJacobian == 1 && app.viscosityModel != 0) {
		delete[] mu_udg;
		delete[] f_mu;
	}
}
