
// Written by C. Nguyen and P. Fernandez

void flux_AVprecomputed_ns3d(double *f, double *f_udg, double *pg, double *avField, double *udg, appstruct &app, double *param, double time, int ng, int nc, int ncu, int nd, int ncd, int computeJacobian, Int AVtype)
{
	// Description: Artificial viscosity fluxes with precomputed AV field.
    
	double rampFactor;
	double gam = param[0];
    double Re = param[2];
    double Pr = param[3];
    double gam1 = gam - 1.0;
    
    double Pr_AV = 0.9;     // kappa^* = gam * r * beta^* / Pr_AV using the beta sensor
    Int wallBlendingFlag = 2;       // 0: No wall blending. 1: Initial approach. 2:  Approach in note.tex
    double avMax = 1.0e10; //1.0e-2;
    double wallDistance, wallBlending;

	for (int i = 0; i <ng; i++) {
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];
		double u10 = udg[9*ng+i];
		double u11 = udg[10*ng+i];
		double u12 = udg[11*ng+i];
		double u13 = udg[12*ng+i];
		double u14 = udg[13*ng+i];
		double u15 = udg[14*ng+i];
		double u16 = udg[15*ng+i];
		double u17 = udg[16*ng+i];
		double u18 = udg[17*ng+i];
		double u19 = udg[18*ng+i];
		double u20 = udg[19*ng+i];
        
        wallDistance = pg[(nd+1)*ng+i];
        if (wallDistance < 0.0)
            wallDistance = 0.0;
        
        if (wallBlendingFlag == 0)            // No wall blending
            wallBlending = 1.0;
        else if (wallBlendingFlag == 1)       // Initial approach
            wallBlending = 1.0 - 1.0/(10.0*wallDistance+1.0);
        else if (wallBlendingFlag == 2)       // Approach in note.tex
            wallBlending = 1.0 - exp( - sqrt(Re * wallDistance / 40.0) );
        
		double av = wallBlending * app.rampFactor * min(avField[i], avMax);

		double r = u1;
		double ru = u2;
		double rv = u3;
		double rw = u4;
		double rE = u5;
		double rx = u6;
		double rux = u7;
		double rvx = u8;
		double rwx = u9;
		double rEx = u10;
		double ry = u11;
		double ruy = u12;
		double rvy = u13;
		double rwy = u14;
		double rEy = u15;
		double rz = u16;
		double ruz = u17;
		double rvz = u18;
		double rwz = u19;
		double rEz = u20;

        if (AVtype == 0) {            // Laplacian with total enthalpy gradient for energy flux
            double t2 = 1.0/(r*r);
            double t3 = 1.0/r;
            double t4 = gam*(1.0/2.0);
            double t5 = t4-1.0/2.0;
            double t6 = ru*ru;
            double t7 = rv*rv;
            double t8 = rw*rw;

            f[0*ng+i] += av*rx;
            f[1*ng+i] += av*rux;
            f[2*ng+i] += av*rvx;
            f[3*ng+i] += av*rwx;
            f[4*ng+i] += av*(gam*rEx-t5*(rx*t2*t6+rx*t2*t7+rx*t2*t8+ru*t3*(rux-ru*rx*t3)*2.0+rv*t3*(rvx-rv*rx*t3)*2.0+rw*t3*(rwx-rw*rx*t3)*2.0));
            f[5*ng+i] += av*ry;
            f[6*ng+i] += av*ruy;
            f[7*ng+i] += av*rvy;
            f[8*ng+i] += av*rwy;
            f[9*ng+i] += av*(gam*rEy-t5*(ry*t2*t6+ry*t2*t7+ry*t2*t8+ru*t3*(ruy-ru*ry*t3)*2.0+rv*t3*(rvy-rv*ry*t3)*2.0+rw*t3*(rwy-rw*ry*t3)*2.0));
            f[10*ng+i] += av*rz;
            f[11*ng+i] += av*ruz;
            f[12*ng+i] += av*rvz;
            f[13*ng+i] += av*rwz;
            f[14*ng+i] += av*(gam*rEz-t5*(rz*t2*t6+rz*t2*t7+rz*t2*t8+ru*t3*(ruz-ru*rz*t3)*2.0+rv*t3*(rvz-rv*rz*t3)*2.0+rw*t3*(rwz-rw*rz*t3)*2.0));
        }
        else if (AVtype == 1) {       // Bulk viscosity only
            double t2 = 1.0/r;
            double t18 = ru*rx*t2;
            double t3 = rux-t18;
            double t4 = t2*t3;
            double t19 = rv*ry*t2;
            double t5 = rvy-t19;
            double t6 = t2*t5;
            double t20 = rw*rz*t2;
            double t7 = rwz-t20;
            double t8 = t2*t7;
            double t9 = t4+t6+t8;
            double t10 = 1.0/(r*r);
            double t11 = ru*ru;
            double t12 = t10*t11*(1.0/2.0);
            double t13 = rv*rv;
            double t14 = t10*t13*(1.0/2.0);
            double t15 = rw*rw;
            double t16 = t10*t15*(1.0/2.0);
            double t17 = t12+t14+t16;
            double t21 = av*r*t9;
            double t22 = 1.0/Pr_AV;
            double t23 = 1.0/gam1;
            double t25 = r*t17;
            double t24 = rE-t25;
            
            f[0*ng+i] += 0.0;
            f[1*ng+i] += t21;
            f[2*ng+i] += 0.0;
            f[3*ng+i] += 0.0;
            f[4*ng+i] += av*ru*t9-av*gam*t2*t22*t23*(gam1*r*(-rEx+rx*t17+r*(ru*t3*t10+rv*t10*(rvx-rv*rx*t2)+rw*t10*(rwx-rw*rx*t2)))+gam1*rx*t24);
            f[5*ng+i] += 0.0;
            f[6*ng+i] += 0.0;
            f[7*ng+i] += t21;
            f[8*ng+i] += 0.0;
            f[9*ng+i] += av*rv*t9-av*gam*t2*t22*t23*(gam1*r*(-rEy+ry*t17+r*(rv*t5*t10+ru*t10*(ruy-ru*ry*t2)+rw*t10*(rwy-rw*ry*t2)))+gam1*ry*t24);
            f[10*ng+i] += 0.0;
            f[11*ng+i] += 0.0;
            f[12*ng+i] += 0.0;
            f[13*ng+i] += t21;
            f[14*ng+i] += av*rw*t9-av*gam*t2*t22*t23*(gam1*r*(-rEz+rz*t17+r*(rw*t7*t10+ru*t10*(ruz-ru*rz*t2)+rv*t10*(rvz-rv*rz*t2)))+gam1*rz*t24);
        }
        else if (AVtype == 2) {       // Bulk viscosity and thermal conductivity with Pr^* = Pr
            double t2 = 1.0/r;
            double t18 = ru*rx*t2;
            double t3 = rux-t18;
            double t4 = t2*t3;
            double t19 = rv*ry*t2;
            double t5 = rvy-t19;
            double t6 = t2*t5;
            double t20 = rw*rz*t2;
            double t7 = rwz-t20;
            double t8 = t2*t7;
            double t9 = t4+t6+t8;
            double t10 = 1.0/(r*r);
            double t11 = ru*ru;
            double t12 = t10*t11*(1.0/2.0);
            double t13 = rv*rv;
            double t14 = t10*t13*(1.0/2.0);
            double t15 = rw*rw;
            double t16 = t10*t15*(1.0/2.0);
            double t17 = t12+t14+t16;
            double t21 = av*r*t9;
            double t22 = 1.0/Pr;
            double t23 = 1.0/gam1;
            double t25 = r*t17;
            double t24 = rE-t25;
            
            f[0*ng+i] += 0.0;
            f[1*ng+i] += t21;
            f[2*ng+i] += 0.0;
            f[3*ng+i] += 0.0;
            f[4*ng+i] += av*ru*t9-av*gam*t2*t22*t23*(gam1*r*(-rEx+rx*t17+r*(ru*t3*t10+rv*t10*(rvx-rv*rx*t2)+rw*t10*(rwx-rw*rx*t2)))+gam1*rx*t24);
            f[5*ng+i] += 0.0;
            f[6*ng+i] += 0.0;
            f[7*ng+i] += t21;
            f[8*ng+i] += 0.0;
            f[9*ng+i] += av*rv*t9-av*gam*t2*t22*t23*(gam1*r*(-rEy+ry*t17+r*(rv*t5*t10+ru*t10*(ruy-ru*ry*t2)+rw*t10*(rwy-rw*ry*t2)))+gam1*ry*t24);
            f[10*ng+i] += 0.0;
            f[11*ng+i] += 0.0;
            f[12*ng+i] += 0.0;
            f[13*ng+i] += t21;
            f[14*ng+i] += av*rw*t9-av*gam*t2*t22*t23*(gam1*r*(-rEz+rz*t17+r*(rw*t7*t10+ru*t10*(ruz-ru*rz*t2)+rv*t10*(rvz-rv*rz*t2)))+gam1*rz*t24);
        }
        else if (AVtype == 3) {          // Physical model with thermal conductivity only
            double t2 = 1.0/(r*r);
            double t3 = ru*ru;
            double t4 = t2*t3*(1.0/2.0);
            double t5 = rv*rv;
            double t6 = t2*t5*(1.0/2.0);
            double t7 = rw*rw;
            double t8 = t2*t7*(1.0/2.0);
            double t9 = t4+t6+t8;
            double t10 = 1.0/r;
            double t11 = 1.0/gam1;
            double t13 = r*t9;
            double t12 = rE-t13;
            
            f[0*ng+i] += 0.0;
            f[1*ng+i] += 0.0;
            f[2*ng+i] += 0.0;
            f[3*ng+i] += 0.0;
            f[4*ng+i] += -av*t10*t11*(gam1*r*(-rEx+rx*t9+r*(ru*t2*(rux-ru*rx*t10)+rv*t2*(rvx-rv*rx*t10)+rw*t2*(rwx-rw*rx*t10)))+gam1*rx*t12);
            f[5*ng+i] += 0.0;
            f[6*ng+i] += 0.0;
            f[7*ng+i] += 0.0;
            f[8*ng+i] += 0.0;
            f[9*ng+i] += -av*t10*t11*(gam1*r*(-rEy+ry*t9+r*(ru*t2*(ruy-ru*ry*t10)+rv*t2*(rvy-rv*ry*t10)+rw*t2*(rwy-rw*ry*t10)))+gam1*ry*t12);
            f[10*ng+i] += 0.0;
            f[11*ng+i] += 0.0;
            f[12*ng+i] += 0.0;
            f[13*ng+i] += 0.0;
            f[14*ng+i] += -av*t10*t11*(gam1*r*(-rEz+rz*t9+r*(ru*t2*(ruz-ru*rz*t10)+rv*t2*(rvz-rv*rz*t10)+rw*t2*(rwz-rw*rz*t10)))+gam1*rz*t12);
        }
        else if (AVtype == 4) {             // Physical model with molecular viscosity only
            double t2 = 1.0/r;
            double t19 = ru*ry*t2;
            double t3 = ruy-t19;
            double t4 = t2*t3;
            double t20 = rv*rx*t2;
            double t5 = rvx-t20;
            double t6 = t2*t5;
            double t7 = t4+t6;
            double t32 = ru*rz*t2;
            double t8 = ruz-t32;
            double t9 = t2*t8;
            double t33 = rw*rx*t2;
            double t10 = rwx-t33;
            double t11 = t2*t10;
            double t12 = t9+t11;
            double t22 = ru*rx*t2;
            double t13 = rux-t22;
            double t23 = rv*ry*t2;
            double t14 = rvy-t23;
            double t15 = t2*t14*(2.0/3.0);
            double t24 = rw*rz*t2;
            double t16 = rwz-t24;
            double t17 = t2*t16*(2.0/3.0);
            double t18 = t15+t17-t2*t13*(4.0/3.0);
            double t21 = av*r*t7;
            double t35 = rv*rz*t2;
            double t25 = rvz-t35;
            double t26 = t2*t25;
            double t36 = rw*ry*t2;
            double t27 = rwy-t36;
            double t28 = t2*t27;
            double t29 = t26+t28;
            double t30 = t2*t13*(2.0/3.0);
            double t31 = t17+t30-t2*t14*(4.0/3.0);
            double t34 = av*r*t12;
            double t37 = av*r*t29;
            double t38 = t15+t30-t2*t16*(4.0/3.0);
            
            f[0*ng+i] += 0.0;
            f[1*ng+i] += -av*r*t18;
            f[2*ng+i] += t21;
            f[3*ng+i] += t34;
            f[4*ng+i] += -av*ru*t18+av*rv*t7+av*rw*t12;
            f[5*ng+i] += 0.0;
            f[6*ng+i] += t21;
            f[7*ng+i] += -av*r*t31;
            f[8*ng+i] += t37;
            f[9*ng+i] += av*ru*t7-av*rv*t31+av*rw*t29;
            f[10*ng+i] += 0.0;
            f[11*ng+i] += t34;
            f[12*ng+i] += t37;
            f[13*ng+i] += -av*r*t38;
            f[14*ng+i] += av*ru*t12+av*rv*t29-av*rw*t38;
        }
    }

	if (computeJacobian == 1) {
		for (int i = 0; i <ng; i++) {
			double u1 = udg[0*ng+i];
			double u2 = udg[1*ng+i];
			double u3 = udg[2*ng+i];
			double u4 = udg[3*ng+i];
			double u5 = udg[4*ng+i];
			double u6 = udg[5*ng+i];
			double u7 = udg[6*ng+i];
			double u8 = udg[7*ng+i];
			double u9 = udg[8*ng+i];
			double u10 = udg[9*ng+i];
			double u11 = udg[10*ng+i];
			double u12 = udg[11*ng+i];
			double u13 = udg[12*ng+i];
			double u14 = udg[13*ng+i];
			double u15 = udg[14*ng+i];
			double u16 = udg[15*ng+i];
			double u17 = udg[16*ng+i];
			double u18 = udg[17*ng+i];
			double u19 = udg[18*ng+i];
			double u20 = udg[19*ng+i];
            
			wallDistance = pg[(nd+1)*ng+i];
            if (wallDistance < 0.0)
                wallDistance = 0.0;
            
            if (wallBlendingFlag == 0)            // No wall blending
                wallBlending = 1.0;
            else if (wallBlendingFlag == 1)       // Initial approach
                wallBlending = 1.0 - 1.0/(10.0*wallDistance+1.0);
            else if (wallBlendingFlag == 2)       // Approach in note.tex
                wallBlending = 1.0 - exp( - sqrt(Re * wallDistance / 40) ); 
            
            double av = wallBlending * app.rampFactor * min(avField[i], avMax);

			double r = u1;
			double ru = u2;
			double rv = u3;
			double rw = u4;
			double rE = u5;
			double rx = u6;
			double rux = u7;
			double rvx = u8;
			double rwx = u9;
			double rEx = u10;
			double ry = u11;
			double ruy = u12;
			double rvy = u13;
			double rwy = u14;
			double rEy = u15;
			double rz = u16;
			double ruz = u17;
			double rvz = u18;
			double rwz = u19;
			double rEz = u20;

            if (AVtype == 0) {            // Laplacian with total enthalpy gradient for energy flux
                double t2 = 1.0/(r*r);
                double t3 = 1.0/r;
                double t4 = gam*(1.0/2.0);
                double t5 = t4-1.0/2.0;
                double t6 = rux-ru*rx*t3;
                double t7 = ruy-ru*ry*t3;
                double t8 = ruz-ru*rz*t3;
                double t9 = rvx-rv*rx*t3;
                double t10 = rvy-rv*ry*t3;
                double t11 = rvz-rv*rz*t3;
                double t12 = rwx-rw*rx*t3;
                double t13 = rwy-rw*ry*t3;
                double t14 = rwz-rw*rz*t3;
                double t15 = ru*ru;
                double t16 = t2*t15;
                double t17 = rv*rv;
                double t18 = t2*t17;
                double t19 = rw*rw;
                double t20 = t2*t19;
                double t21 = t16+t18+t20;
                double t22 = av*t5*t21;
                double t23 = av*gam;

                f_udg[4*ng+i] += av*t5*(ru*t2*t6*2.0+rv*t2*t9*2.0+rw*t2*t12*2.0);
                f_udg[9*ng+i] += av*t5*(ru*t2*t7*2.0+rv*t2*t10*2.0+rw*t2*t13*2.0);
                f_udg[14*ng+i] += av*t5*(ru*t2*t8*2.0+rv*t2*t11*2.0+rw*t2*t14*2.0);
                f_udg[19*ng+i] += av*t3*t5*t6*-2.0;
                f_udg[24*ng+i] += av*t3*t5*t7*-2.0;
                f_udg[29*ng+i] += av*t3*t5*t8*-2.0;
                f_udg[34*ng+i] += av*t3*t5*t9*-2.0;
                f_udg[39*ng+i] += av*t3*t5*t10*-2.0;
                f_udg[44*ng+i] += av*t3*t5*t11*-2.0;
                f_udg[49*ng+i] += av*t3*t5*t12*-2.0;
                f_udg[54*ng+i] += av*t3*t5*t13*-2.0;
                f_udg[59*ng+i] += av*t3*t5*t14*-2.0;
                f_udg[75*ng+i] += av;
                f_udg[79*ng+i] += t22;
                f_udg[91*ng+i] += av;
                f_udg[94*ng+i] += av*ru*t3*t5*-2.0;
                f_udg[107*ng+i] += av;
                f_udg[109*ng+i] += av*rv*t3*t5*-2.0;
                f_udg[123*ng+i] += av;
                f_udg[124*ng+i] += av*rw*t3*t5*-2.0;
                f_udg[139*ng+i] += t23;
                f_udg[155*ng+i] += av;
                f_udg[159*ng+i] += t22;
                f_udg[171*ng+i] += av;
                f_udg[174*ng+i] += av*ru*t3*t5*-2.0;
                f_udg[187*ng+i] += av;
                f_udg[189*ng+i] += av*rv*t3*t5*-2.0;
                f_udg[203*ng+i] += av;
                f_udg[204*ng+i] += av*rw*t3*t5*-2.0;
                f_udg[219*ng+i] += t23;
                f_udg[235*ng+i] += av;
                f_udg[239*ng+i] += t22;
                f_udg[251*ng+i] += av;
                f_udg[254*ng+i] += av*ru*t3*t5*-2.0;
                f_udg[267*ng+i] += av;
                f_udg[269*ng+i] += av*rv*t3*t5*-2.0;
                f_udg[283*ng+i] += av;
                f_udg[284*ng+i] += av*rw*t3*t5*-2.0;
                f_udg[299*ng+i] += t23;
            }
            else if (AVtype == 1) {       // Bulk viscosity only
                double t2 = 1.0/r;
                double t8 = ru*rx*t2;
                double t3 = rux-t8;
                double t4 = 1.0/(r*r);
                double t10 = rv*ry*t2;
                double t5 = rvy-t10;
                double t12 = rw*rz*t2;
                double t6 = rwz-t12;
                double t7 = 1.0/(r*r*r);
                double t9 = t3*t4;
                double t11 = t4*t5;
                double t13 = t4*t6;
                double t45 = ru*rx*t7;
                double t46 = rv*ry*t7;
                double t47 = rw*rz*t7;
                double t14 = t9+t11+t13-t45-t46-t47;
                double t15 = ru*ru;
                double t16 = 1.0/(r*r*r*r);
                double t17 = rv*rv;
                double t18 = rw*rw;
                double t22 = rv*rx*t2;
                double t19 = rvx-t22;
                double t24 = rw*rx*t2;
                double t20 = rwx-t24;
                double t21 = ru*t3*t4;
                double t23 = rv*t4*t19;
                double t25 = rw*t4*t20;
                double t26 = t4*t15*(1.0/2.0);
                double t27 = t4*t17*(1.0/2.0);
                double t28 = t4*t18*(1.0/2.0);
                double t29 = t7*t15;
                double t30 = t7*t17;
                double t31 = t7*t18;
                double t32 = t29+t30+t31;
                double t33 = 1.0/Pr_AV;
                double t34 = 1.0/gam1;
                double t35 = t26+t27+t28;
                double t36 = rx*t35;
                double t37 = t21+t23+t25;
                double t38 = r*t37;
                double t39 = -rEx+t36+t38;
                double t40 = t2*t3;
                double t41 = t2*t5;
                double t42 = t2*t6;
                double t43 = t40+t41+t42;
                double t44 = av*t43;
                double t62 = av*r*t14;
                double t48 = t44-t62;
                double t51 = ru*ry*t2;
                double t49 = ruy-t51;
                double t54 = rw*ry*t2;
                double t50 = rwy-t54;
                double t52 = ru*t4*t49;
                double t53 = rv*t4*t5;
                double t55 = rw*t4*t50;
                double t70 = r*t32;
                double t56 = t26+t27+t28-t70;
                double t71 = r*t35;
                double t57 = rE-t71;
                double t58 = ry*t35;
                double t59 = t52+t53+t55;
                double t60 = r*t59;
                double t61 = -rEy+t58+t60;
                double t65 = ru*rz*t2;
                double t63 = ruz-t65;
                double t67 = rv*rz*t2;
                double t64 = rvz-t67;
                double t66 = ru*t4*t63;
                double t68 = rv*t4*t64;
                double t69 = rw*t4*t6;
                double t72 = rz*t35;
                double t73 = t66+t68+t69;
                double t74 = r*t73;
                double t75 = -rEz+t72+t74;
                double t76 = av*rv*t2;
                double t77 = gam1*t57;
                double t78 = gam1*r*t56;
                double t79 = t77+t78;
                double t80 = av*ru*t2;
                double t81 = av*rw*t2;
                double t82 = av*gam*t33;
                
                f_udg[0*ng+i] += 0.0;
                f_udg[1*ng+i] += t48;
                f_udg[2*ng+i] += 0.0;
                f_udg[3*ng+i] += 0.0;
                f_udg[4*ng+i] += -av*ru*t14+av*gam*t4*t33*t34*(gam1*r*t39+gam1*rx*t57)-av*gam*t2*t33*t34*(gam1*t39-gam1*rx*t56+gam1*r*(t21+t23+t25-rx*t32-r*(ru*t3*t7*2.0+rv*t7*t19*2.0+rw*t7*t20*2.0-rx*t15*t16-rx*t16*t17-rx*t16*t18)));
                f_udg[5*ng+i] += 0.0;
                f_udg[6*ng+i] += 0.0;
                f_udg[7*ng+i] += t48;
                f_udg[8*ng+i] += 0.0;
                f_udg[9*ng+i] += -av*rv*t14+av*gam*t4*t33*t34*(gam1*r*t61+gam1*ry*t57)-av*gam*t2*t33*t34*(gam1*t61-gam1*ry*t56+gam1*r*(t52+t53+t55-ry*t32-r*(ru*t7*t49*2.0+rv*t5*t7*2.0+rw*t7*t50*2.0-ry*t15*t16-ry*t16*t17-ry*t16*t18)));
                f_udg[10*ng+i] += 0.0;
                f_udg[11*ng+i] += 0.0;
                f_udg[12*ng+i] += 0.0;
                f_udg[13*ng+i] += t48;
                f_udg[14*ng+i] += -av*rw*t14+av*gam*t4*t33*t34*(gam1*r*t75+gam1*rz*t57)-av*gam*t2*t33*t34*(gam1*t75-gam1*rz*t56+gam1*r*(t66+t68+t69-rz*t32-r*(ru*t7*t63*2.0+rv*t7*t64*2.0+rw*t6*t7*2.0-rz*t15*t16-rz*t16*t17-rz*t16*t18)));
                f_udg[15*ng+i] += 0.0;
                f_udg[16*ng+i] += -av*rx*t2;
                f_udg[17*ng+i] += 0.0;
                f_udg[18*ng+i] += 0.0;
                f_udg[19*ng+i] += t44-av*ru*rx*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t9-t45)+ru*rx*t4)-gam1*ru*rx*t2);
                f_udg[20*ng+i] += 0.0;
                f_udg[21*ng+i] += 0.0;
                f_udg[22*ng+i] += -av*rx*t2;
                f_udg[23*ng+i] += 0.0;
                f_udg[24*ng+i] += -av*rv*rx*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t49-ru*ry*t7)+ru*ry*t4)-gam1*ru*ry*t2);
                f_udg[25*ng+i] += 0.0;
                f_udg[26*ng+i] += 0.0;
                f_udg[27*ng+i] += 0.0;
                f_udg[28*ng+i] += -av*rx*t2;
                f_udg[29*ng+i] += -av*rw*rx*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t63-ru*rz*t7)+ru*rz*t4)-gam1*ru*rz*t2);
                f_udg[30*ng+i] += 0.0;
                f_udg[31*ng+i] += -av*ry*t2;
                f_udg[32*ng+i] += 0.0;
                f_udg[33*ng+i] += 0.0;
                f_udg[34*ng+i] += -av*ru*ry*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t19-rv*rx*t7)+rv*rx*t4)-gam1*rv*rx*t2);
                f_udg[35*ng+i] += 0.0;
                f_udg[36*ng+i] += 0.0;
                f_udg[37*ng+i] += -av*ry*t2;
                f_udg[38*ng+i] += 0.0;
                f_udg[39*ng+i] += t44-av*rv*ry*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t11-t46)+rv*ry*t4)-gam1*rv*ry*t2);
                f_udg[40*ng+i] += 0.0;
                f_udg[41*ng+i] += 0.0;
                f_udg[42*ng+i] += 0.0;
                f_udg[43*ng+i] += -av*ry*t2;
                f_udg[44*ng+i] += -av*rw*ry*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t64-rv*rz*t7)+rv*rz*t4)-gam1*rv*rz*t2);
                f_udg[45*ng+i] += 0.0;
                f_udg[46*ng+i] += -av*rz*t2;
                f_udg[47*ng+i] += 0.0;
                f_udg[48*ng+i] += 0.0;
                f_udg[49*ng+i] += -av*ru*rz*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t20-rw*rx*t7)+rw*rx*t4)-gam1*rw*rx*t2);
                f_udg[50*ng+i] += 0.0;
                f_udg[51*ng+i] += 0.0;
                f_udg[52*ng+i] += -av*rz*t2;
                f_udg[53*ng+i] += 0.0;
                f_udg[54*ng+i] += -av*rv*rz*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t50-rw*ry*t7)+rw*ry*t4)-gam1*rw*ry*t2);
                f_udg[55*ng+i] += 0.0;
                f_udg[56*ng+i] += 0.0;
                f_udg[57*ng+i] += 0.0;
                f_udg[58*ng+i] += -av*rz*t2;
                f_udg[59*ng+i] += t44-av*rw*rz*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t13-t47)+rw*rz*t4)-gam1*rw*rz*t2);
                f_udg[60*ng+i] += 0.0;
                f_udg[61*ng+i] += 0.0;
                f_udg[62*ng+i] += 0.0;
                f_udg[63*ng+i] += 0.0;
                f_udg[64*ng+i] += -av*gam*rx*t2*t33;
                f_udg[65*ng+i] += 0.0;
                f_udg[66*ng+i] += 0.0;
                f_udg[67*ng+i] += 0.0;
                f_udg[68*ng+i] += 0.0;
                f_udg[69*ng+i] += -av*gam*ry*t2*t33;
                f_udg[70*ng+i] += 0.0;
                f_udg[71*ng+i] += 0.0;
                f_udg[72*ng+i] += 0.0;
                f_udg[73*ng+i] += 0.0;
                f_udg[74*ng+i] += -av*gam*rz*t2*t33;
                f_udg[75*ng+i] += 0.0;
                f_udg[76*ng+i] += -av*ru*t2;
                f_udg[77*ng+i] += 0.0;
                f_udg[78*ng+i] += 0.0;
                f_udg[79*ng+i] += -av*t4*t15-av*gam*t2*t33*t34*t79;
                f_udg[80*ng+i] += 0.0;
                f_udg[81*ng+i] += 0.0;
                f_udg[82*ng+i] += -av*ru*t2;
                f_udg[83*ng+i] += 0.0;
                f_udg[84*ng+i] += -av*ru*rv*t4;
                f_udg[85*ng+i] += 0.0;
                f_udg[86*ng+i] += 0.0;
                f_udg[87*ng+i] += 0.0;
                f_udg[88*ng+i] += -av*ru*t2;
                f_udg[89*ng+i] += -av*ru*rw*t4;
                f_udg[90*ng+i] += 0.0;
                f_udg[91*ng+i] += av;
                f_udg[92*ng+i] += 0.0;
                f_udg[93*ng+i] += 0.0;
                f_udg[94*ng+i] += t80-av*gam*ru*t2*t33;
                f_udg[95*ng+i] += 0.0;
                f_udg[96*ng+i] += 0.0;
                f_udg[97*ng+i] += av;
                f_udg[98*ng+i] += 0.0;
                f_udg[99*ng+i] += t76;
                f_udg[100*ng+i] += 0.0;
                f_udg[101*ng+i] += 0.0;
                f_udg[102*ng+i] += 0.0;
                f_udg[103*ng+i] += av;
                f_udg[104*ng+i] += t81;
                f_udg[105*ng+i] += 0.0;
                f_udg[106*ng+i] += 0.0;
                f_udg[107*ng+i] += 0.0;
                f_udg[108*ng+i] += 0.0;
                f_udg[109*ng+i] += -av*gam*rv*t2*t33;
                f_udg[110*ng+i] += 0.0;
                f_udg[111*ng+i] += 0.0;
                f_udg[112*ng+i] += 0.0;
                f_udg[113*ng+i] += 0.0;
                f_udg[114*ng+i] += 0.0;
                f_udg[115*ng+i] += 0.0;
                f_udg[116*ng+i] += 0.0;
                f_udg[117*ng+i] += 0.0;
                f_udg[118*ng+i] += 0.0;
                f_udg[119*ng+i] += 0.0;
                f_udg[120*ng+i] += 0.0;
                f_udg[121*ng+i] += 0.0;
                f_udg[122*ng+i] += 0.0;
                f_udg[123*ng+i] += 0.0;
                f_udg[124*ng+i] += -av*gam*rw*t2*t33;
                f_udg[125*ng+i] += 0.0;
                f_udg[126*ng+i] += 0.0;
                f_udg[127*ng+i] += 0.0;
                f_udg[128*ng+i] += 0.0;
                f_udg[129*ng+i] += 0.0;
                f_udg[130*ng+i] += 0.0;
                f_udg[131*ng+i] += 0.0;
                f_udg[132*ng+i] += 0.0;
                f_udg[133*ng+i] += 0.0;
                f_udg[134*ng+i] += 0.0;
                f_udg[135*ng+i] += 0.0;
                f_udg[136*ng+i] += 0.0;
                f_udg[137*ng+i] += 0.0;
                f_udg[138*ng+i] += 0.0;
                f_udg[139*ng+i] += t82;
                f_udg[140*ng+i] += 0.0;
                f_udg[141*ng+i] += 0.0;
                f_udg[142*ng+i] += 0.0;
                f_udg[143*ng+i] += 0.0;
                f_udg[144*ng+i] += 0.0;
                f_udg[145*ng+i] += 0.0;
                f_udg[146*ng+i] += 0.0;
                f_udg[147*ng+i] += 0.0;
                f_udg[148*ng+i] += 0.0;
                f_udg[149*ng+i] += 0.0;
                f_udg[150*ng+i] += 0.0;
                f_udg[151*ng+i] += -t76;
                f_udg[152*ng+i] += 0.0;
                f_udg[153*ng+i] += 0.0;
                f_udg[154*ng+i] += -av*ru*rv*t4;
                f_udg[155*ng+i] += 0.0;
                f_udg[156*ng+i] += 0.0;
                f_udg[157*ng+i] += -t76;
                f_udg[158*ng+i] += 0.0;
                f_udg[159*ng+i] += -av*t4*t17-av*gam*t2*t33*t34*t79;
                f_udg[160*ng+i] += 0.0;
                f_udg[161*ng+i] += 0.0;
                f_udg[162*ng+i] += 0.0;
                f_udg[163*ng+i] += -t76;
                f_udg[164*ng+i] += -av*rv*rw*t4;
                f_udg[165*ng+i] += 0.0;
                f_udg[166*ng+i] += 0.0;
                f_udg[167*ng+i] += 0.0;
                f_udg[168*ng+i] += 0.0;
                f_udg[169*ng+i] += 0.0;
                f_udg[170*ng+i] += 0.0;
                f_udg[171*ng+i] += 0.0;
                f_udg[172*ng+i] += 0.0;
                f_udg[173*ng+i] += 0.0;
                f_udg[174*ng+i] += -av*gam*ru*t2*t33;
                f_udg[175*ng+i] += 0.0;
                f_udg[176*ng+i] += 0.0;
                f_udg[177*ng+i] += 0.0;
                f_udg[178*ng+i] += 0.0;
                f_udg[179*ng+i] += 0.0;
                f_udg[180*ng+i] += 0.0;
                f_udg[181*ng+i] += av;
                f_udg[182*ng+i] += 0.0;
                f_udg[183*ng+i] += 0.0;
                f_udg[184*ng+i] += t80;
                f_udg[185*ng+i] += 0.0;
                f_udg[186*ng+i] += 0.0;
                f_udg[187*ng+i] += av;
                f_udg[188*ng+i] += 0.0;
                f_udg[189*ng+i] += t76-av*gam*rv*t2*t33;
                f_udg[190*ng+i] += 0.0;
                f_udg[191*ng+i] += 0.0;
                f_udg[192*ng+i] += 0.0;
                f_udg[193*ng+i] += av;
                f_udg[194*ng+i] += t81;
                f_udg[195*ng+i] += 0.0;
                f_udg[196*ng+i] += 0.0;
                f_udg[197*ng+i] += 0.0;
                f_udg[198*ng+i] += 0.0;
                f_udg[199*ng+i] += 0.0;
                f_udg[200*ng+i] += 0.0;
                f_udg[201*ng+i] += 0.0;
                f_udg[202*ng+i] += 0.0;
                f_udg[203*ng+i] += 0.0;
                f_udg[204*ng+i] += -av*gam*rw*t2*t33;
                f_udg[205*ng+i] += 0.0;
                f_udg[206*ng+i] += 0.0;
                f_udg[207*ng+i] += 0.0;
                f_udg[208*ng+i] += 0.0;
                f_udg[209*ng+i] += 0.0;
                f_udg[210*ng+i] += 0.0;
                f_udg[211*ng+i] += 0.0;
                f_udg[212*ng+i] += 0.0;
                f_udg[213*ng+i] += 0.0;
                f_udg[214*ng+i] += 0.0;
                f_udg[215*ng+i] += 0.0;
                f_udg[216*ng+i] += 0.0;
                f_udg[217*ng+i] += 0.0;
                f_udg[218*ng+i] += 0.0;
                f_udg[219*ng+i] += t82;
                f_udg[220*ng+i] += 0.0;
                f_udg[221*ng+i] += 0.0;
                f_udg[222*ng+i] += 0.0;
                f_udg[223*ng+i] += 0.0;
                f_udg[224*ng+i] += 0.0;
                f_udg[225*ng+i] += 0.0;
                f_udg[226*ng+i] += -t81;
                f_udg[227*ng+i] += 0.0;
                f_udg[228*ng+i] += 0.0;
                f_udg[229*ng+i] += -av*ru*rw*t4;
                f_udg[230*ng+i] += 0.0;
                f_udg[231*ng+i] += 0.0;
                f_udg[232*ng+i] += -t81;
                f_udg[233*ng+i] += 0.0;
                f_udg[234*ng+i] += -av*rv*rw*t4;
                f_udg[235*ng+i] += 0.0;
                f_udg[236*ng+i] += 0.0;
                f_udg[237*ng+i] += 0.0;
                f_udg[238*ng+i] += -t81;
                f_udg[239*ng+i] += -av*t4*t18-av*gam*t2*t33*t34*t79;
                f_udg[240*ng+i] += 0.0;
                f_udg[241*ng+i] += 0.0;
                f_udg[242*ng+i] += 0.0;
                f_udg[243*ng+i] += 0.0;
                f_udg[244*ng+i] += 0.0;
                f_udg[245*ng+i] += 0.0;
                f_udg[246*ng+i] += 0.0;
                f_udg[247*ng+i] += 0.0;
                f_udg[248*ng+i] += 0.0;
                f_udg[249*ng+i] += 0.0;
                f_udg[250*ng+i] += 0.0;
                f_udg[251*ng+i] += 0.0;
                f_udg[252*ng+i] += 0.0;
                f_udg[253*ng+i] += 0.0;
                f_udg[254*ng+i] += -av*gam*ru*t2*t33;
                f_udg[255*ng+i] += 0.0;
                f_udg[256*ng+i] += 0.0;
                f_udg[257*ng+i] += 0.0;
                f_udg[258*ng+i] += 0.0;
                f_udg[259*ng+i] += 0.0;
                f_udg[260*ng+i] += 0.0;
                f_udg[261*ng+i] += 0.0;
                f_udg[262*ng+i] += 0.0;
                f_udg[263*ng+i] += 0.0;
                f_udg[264*ng+i] += 0.0;
                f_udg[265*ng+i] += 0.0;
                f_udg[266*ng+i] += 0.0;
                f_udg[267*ng+i] += 0.0;
                f_udg[268*ng+i] += 0.0;
                f_udg[269*ng+i] += -av*gam*rv*t2*t33;
                f_udg[270*ng+i] += 0.0;
                f_udg[271*ng+i] += av;
                f_udg[272*ng+i] += 0.0;
                f_udg[273*ng+i] += 0.0;
                f_udg[274*ng+i] += t80;
                f_udg[275*ng+i] += 0.0;
                f_udg[276*ng+i] += 0.0;
                f_udg[277*ng+i] += av;
                f_udg[278*ng+i] += 0.0;
                f_udg[279*ng+i] += t76;
                f_udg[280*ng+i] += 0.0;
                f_udg[281*ng+i] += 0.0;
                f_udg[282*ng+i] += 0.0;
                f_udg[283*ng+i] += av;
                f_udg[284*ng+i] += t81-av*gam*rw*t2*t33;
                f_udg[285*ng+i] += 0.0;
                f_udg[286*ng+i] += 0.0;
                f_udg[287*ng+i] += 0.0;
                f_udg[288*ng+i] += 0.0;
                f_udg[289*ng+i] += 0.0;
                f_udg[290*ng+i] += 0.0;
                f_udg[291*ng+i] += 0.0;
                f_udg[292*ng+i] += 0.0;
                f_udg[293*ng+i] += 0.0;
                f_udg[294*ng+i] += 0.0;
                f_udg[295*ng+i] += 0.0;
                f_udg[296*ng+i] += 0.0;
                f_udg[297*ng+i] += 0.0;
                f_udg[298*ng+i] += 0.0;
                f_udg[299*ng+i] += t82;
            }
            else if (AVtype == 2) {       // Bulk viscosity and thermal conductivity
                double t2 = 1.0/r;
                double t8 = ru*rx*t2;
                double t3 = rux-t8;
                double t4 = 1.0/(r*r);
                double t10 = rv*ry*t2;
                double t5 = rvy-t10;
                double t12 = rw*rz*t2;
                double t6 = rwz-t12;
                double t7 = 1.0/(r*r*r);
                double t9 = t3*t4;
                double t11 = t4*t5;
                double t13 = t4*t6;
                double t45 = ru*rx*t7;
                double t46 = rv*ry*t7;
                double t47 = rw*rz*t7;
                double t14 = t9+t11+t13-t45-t46-t47;
                double t15 = ru*ru;
                double t16 = 1.0/(r*r*r*r);
                double t17 = rv*rv;
                double t18 = rw*rw;
                double t22 = rv*rx*t2;
                double t19 = rvx-t22;
                double t24 = rw*rx*t2;
                double t20 = rwx-t24;
                double t21 = ru*t3*t4;
                double t23 = rv*t4*t19;
                double t25 = rw*t4*t20;
                double t26 = t4*t15*(1.0/2.0);
                double t27 = t4*t17*(1.0/2.0);
                double t28 = t4*t18*(1.0/2.0);
                double t29 = t7*t15;
                double t30 = t7*t17;
                double t31 = t7*t18;
                double t32 = t29+t30+t31;
                double t33 = 1.0/Pr;
                double t34 = 1.0/gam1;
                double t35 = t26+t27+t28;
                double t36 = rx*t35;
                double t37 = t21+t23+t25;
                double t38 = r*t37;
                double t39 = -rEx+t36+t38;
                double t40 = t2*t3;
                double t41 = t2*t5;
                double t42 = t2*t6;
                double t43 = t40+t41+t42;
                double t44 = av*t43;
                double t62 = av*r*t14;
                double t48 = t44-t62;
                double t51 = ru*ry*t2;
                double t49 = ruy-t51;
                double t54 = rw*ry*t2;
                double t50 = rwy-t54;
                double t52 = ru*t4*t49;
                double t53 = rv*t4*t5;
                double t55 = rw*t4*t50;
                double t70 = r*t32;
                double t56 = t26+t27+t28-t70;
                double t71 = r*t35;
                double t57 = rE-t71;
                double t58 = ry*t35;
                double t59 = t52+t53+t55;
                double t60 = r*t59;
                double t61 = -rEy+t58+t60;
                double t65 = ru*rz*t2;
                double t63 = ruz-t65;
                double t67 = rv*rz*t2;
                double t64 = rvz-t67;
                double t66 = ru*t4*t63;
                double t68 = rv*t4*t64;
                double t69 = rw*t4*t6;
                double t72 = rz*t35;
                double t73 = t66+t68+t69;
                double t74 = r*t73;
                double t75 = -rEz+t72+t74;
                double t76 = av*rv*t2;
                double t77 = gam1*t57;
                double t78 = gam1*r*t56;
                double t79 = t77+t78;
                double t80 = av*ru*t2;
                double t81 = av*rw*t2;
                double t82 = av*gam*t33;
                
                f_udg[0*ng+i] += 0.0;
                f_udg[1*ng+i] += t48;
                f_udg[2*ng+i] += 0.0;
                f_udg[3*ng+i] += 0.0;
                f_udg[4*ng+i] += -av*ru*t14+av*gam*t4*t33*t34*(gam1*r*t39+gam1*rx*t57)-av*gam*t2*t33*t34*(gam1*t39-gam1*rx*t56+gam1*r*(t21+t23+t25-rx*t32-r*(ru*t3*t7*2.0+rv*t7*t19*2.0+rw*t7*t20*2.0-rx*t15*t16-rx*t16*t17-rx*t16*t18)));
                f_udg[5*ng+i] += 0.0;
                f_udg[6*ng+i] += 0.0;
                f_udg[7*ng+i] += t48;
                f_udg[8*ng+i] += 0.0;
                f_udg[9*ng+i] += -av*rv*t14+av*gam*t4*t33*t34*(gam1*r*t61+gam1*ry*t57)-av*gam*t2*t33*t34*(gam1*t61-gam1*ry*t56+gam1*r*(t52+t53+t55-ry*t32-r*(ru*t7*t49*2.0+rv*t5*t7*2.0+rw*t7*t50*2.0-ry*t15*t16-ry*t16*t17-ry*t16*t18)));
                f_udg[10*ng+i] += 0.0;
                f_udg[11*ng+i] += 0.0;
                f_udg[12*ng+i] += 0.0;
                f_udg[13*ng+i] += t48;
                f_udg[14*ng+i] += -av*rw*t14+av*gam*t4*t33*t34*(gam1*r*t75+gam1*rz*t57)-av*gam*t2*t33*t34*(gam1*t75-gam1*rz*t56+gam1*r*(t66+t68+t69-rz*t32-r*(ru*t7*t63*2.0+rv*t7*t64*2.0+rw*t6*t7*2.0-rz*t15*t16-rz*t16*t17-rz*t16*t18)));
                f_udg[15*ng+i] += 0.0;
                f_udg[16*ng+i] += -av*rx*t2;
                f_udg[17*ng+i] += 0.0;
                f_udg[18*ng+i] += 0.0;
                f_udg[19*ng+i] += t44-av*ru*rx*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t9-t45)+ru*rx*t4)-gam1*ru*rx*t2);
                f_udg[20*ng+i] += 0.0;
                f_udg[21*ng+i] += 0.0;
                f_udg[22*ng+i] += -av*rx*t2;
                f_udg[23*ng+i] += 0.0;
                f_udg[24*ng+i] += -av*rv*rx*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t49-ru*ry*t7)+ru*ry*t4)-gam1*ru*ry*t2);
                f_udg[25*ng+i] += 0.0;
                f_udg[26*ng+i] += 0.0;
                f_udg[27*ng+i] += 0.0;
                f_udg[28*ng+i] += -av*rx*t2;
                f_udg[29*ng+i] += -av*rw*rx*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t63-ru*rz*t7)+ru*rz*t4)-gam1*ru*rz*t2);
                f_udg[30*ng+i] += 0.0;
                f_udg[31*ng+i] += -av*ry*t2;
                f_udg[32*ng+i] += 0.0;
                f_udg[33*ng+i] += 0.0;
                f_udg[34*ng+i] += -av*ru*ry*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t19-rv*rx*t7)+rv*rx*t4)-gam1*rv*rx*t2);
                f_udg[35*ng+i] += 0.0;
                f_udg[36*ng+i] += 0.0;
                f_udg[37*ng+i] += -av*ry*t2;
                f_udg[38*ng+i] += 0.0;
                f_udg[39*ng+i] += t44-av*rv*ry*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t11-t46)+rv*ry*t4)-gam1*rv*ry*t2);
                f_udg[40*ng+i] += 0.0;
                f_udg[41*ng+i] += 0.0;
                f_udg[42*ng+i] += 0.0;
                f_udg[43*ng+i] += -av*ry*t2;
                f_udg[44*ng+i] += -av*rw*ry*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t64-rv*rz*t7)+rv*rz*t4)-gam1*rv*rz*t2);
                f_udg[45*ng+i] += 0.0;
                f_udg[46*ng+i] += -av*rz*t2;
                f_udg[47*ng+i] += 0.0;
                f_udg[48*ng+i] += 0.0;
                f_udg[49*ng+i] += -av*ru*rz*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t20-rw*rx*t7)+rw*rx*t4)-gam1*rw*rx*t2);
                f_udg[50*ng+i] += 0.0;
                f_udg[51*ng+i] += 0.0;
                f_udg[52*ng+i] += -av*rz*t2;
                f_udg[53*ng+i] += 0.0;
                f_udg[54*ng+i] += -av*rv*rz*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t4*t50-rw*ry*t7)+rw*ry*t4)-gam1*rw*ry*t2);
                f_udg[55*ng+i] += 0.0;
                f_udg[56*ng+i] += 0.0;
                f_udg[57*ng+i] += 0.0;
                f_udg[58*ng+i] += -av*rz*t2;
                f_udg[59*ng+i] += t44-av*rw*rz*t4-av*gam*t2*t33*t34*(gam1*r*(r*(t13-t47)+rw*rz*t4)-gam1*rw*rz*t2);
                f_udg[60*ng+i] += 0.0;
                f_udg[61*ng+i] += 0.0;
                f_udg[62*ng+i] += 0.0;
                f_udg[63*ng+i] += 0.0;
                f_udg[64*ng+i] += -av*gam*rx*t2*t33;
                f_udg[65*ng+i] += 0.0;
                f_udg[66*ng+i] += 0.0;
                f_udg[67*ng+i] += 0.0;
                f_udg[68*ng+i] += 0.0;
                f_udg[69*ng+i] += -av*gam*ry*t2*t33;
                f_udg[70*ng+i] += 0.0;
                f_udg[71*ng+i] += 0.0;
                f_udg[72*ng+i] += 0.0;
                f_udg[73*ng+i] += 0.0;
                f_udg[74*ng+i] += -av*gam*rz*t2*t33;
                f_udg[75*ng+i] += 0.0;
                f_udg[76*ng+i] += -av*ru*t2;
                f_udg[77*ng+i] += 0.0;
                f_udg[78*ng+i] += 0.0;
                f_udg[79*ng+i] += -av*t4*t15-av*gam*t2*t33*t34*t79;
                f_udg[80*ng+i] += 0.0;
                f_udg[81*ng+i] += 0.0;
                f_udg[82*ng+i] += -av*ru*t2;
                f_udg[83*ng+i] += 0.0;
                f_udg[84*ng+i] += -av*ru*rv*t4;
                f_udg[85*ng+i] += 0.0;
                f_udg[86*ng+i] += 0.0;
                f_udg[87*ng+i] += 0.0;
                f_udg[88*ng+i] += -av*ru*t2;
                f_udg[89*ng+i] += -av*ru*rw*t4;
                f_udg[90*ng+i] += 0.0;
                f_udg[91*ng+i] += av;
                f_udg[92*ng+i] += 0.0;
                f_udg[93*ng+i] += 0.0;
                f_udg[94*ng+i] += t80-av*gam*ru*t2*t33;
                f_udg[95*ng+i] += 0.0;
                f_udg[96*ng+i] += 0.0;
                f_udg[97*ng+i] += av;
                f_udg[98*ng+i] += 0.0;
                f_udg[99*ng+i] += t76;
                f_udg[100*ng+i] += 0.0;
                f_udg[101*ng+i] += 0.0;
                f_udg[102*ng+i] += 0.0;
                f_udg[103*ng+i] += av;
                f_udg[104*ng+i] += t81;
                f_udg[105*ng+i] += 0.0;
                f_udg[106*ng+i] += 0.0;
                f_udg[107*ng+i] += 0.0;
                f_udg[108*ng+i] += 0.0;
                f_udg[109*ng+i] += -av*gam*rv*t2*t33;
                f_udg[110*ng+i] += 0.0;
                f_udg[111*ng+i] += 0.0;
                f_udg[112*ng+i] += 0.0;
                f_udg[113*ng+i] += 0.0;
                f_udg[114*ng+i] += 0.0;
                f_udg[115*ng+i] += 0.0;
                f_udg[116*ng+i] += 0.0;
                f_udg[117*ng+i] += 0.0;
                f_udg[118*ng+i] += 0.0;
                f_udg[119*ng+i] += 0.0;
                f_udg[120*ng+i] += 0.0;
                f_udg[121*ng+i] += 0.0;
                f_udg[122*ng+i] += 0.0;
                f_udg[123*ng+i] += 0.0;
                f_udg[124*ng+i] += -av*gam*rw*t2*t33;
                f_udg[125*ng+i] += 0.0;
                f_udg[126*ng+i] += 0.0;
                f_udg[127*ng+i] += 0.0;
                f_udg[128*ng+i] += 0.0;
                f_udg[129*ng+i] += 0.0;
                f_udg[130*ng+i] += 0.0;
                f_udg[131*ng+i] += 0.0;
                f_udg[132*ng+i] += 0.0;
                f_udg[133*ng+i] += 0.0;
                f_udg[134*ng+i] += 0.0;
                f_udg[135*ng+i] += 0.0;
                f_udg[136*ng+i] += 0.0;
                f_udg[137*ng+i] += 0.0;
                f_udg[138*ng+i] += 0.0;
                f_udg[139*ng+i] += t82;
                f_udg[140*ng+i] += 0.0;
                f_udg[141*ng+i] += 0.0;
                f_udg[142*ng+i] += 0.0;
                f_udg[143*ng+i] += 0.0;
                f_udg[144*ng+i] += 0.0;
                f_udg[145*ng+i] += 0.0;
                f_udg[146*ng+i] += 0.0;
                f_udg[147*ng+i] += 0.0;
                f_udg[148*ng+i] += 0.0;
                f_udg[149*ng+i] += 0.0;
                f_udg[150*ng+i] += 0.0;
                f_udg[151*ng+i] += -t76;
                f_udg[152*ng+i] += 0.0;
                f_udg[153*ng+i] += 0.0;
                f_udg[154*ng+i] += -av*ru*rv*t4;
                f_udg[155*ng+i] += 0.0;
                f_udg[156*ng+i] += 0.0;
                f_udg[157*ng+i] += -t76;
                f_udg[158*ng+i] += 0.0;
                f_udg[159*ng+i] += -av*t4*t17-av*gam*t2*t33*t34*t79;
                f_udg[160*ng+i] += 0.0;
                f_udg[161*ng+i] += 0.0;
                f_udg[162*ng+i] += 0.0;
                f_udg[163*ng+i] += -t76;
                f_udg[164*ng+i] += -av*rv*rw*t4;
                f_udg[165*ng+i] += 0.0;
                f_udg[166*ng+i] += 0.0;
                f_udg[167*ng+i] += 0.0;
                f_udg[168*ng+i] += 0.0;
                f_udg[169*ng+i] += 0.0;
                f_udg[170*ng+i] += 0.0;
                f_udg[171*ng+i] += 0.0;
                f_udg[172*ng+i] += 0.0;
                f_udg[173*ng+i] += 0.0;
                f_udg[174*ng+i] += -av*gam*ru*t2*t33;
                f_udg[175*ng+i] += 0.0;
                f_udg[176*ng+i] += 0.0;
                f_udg[177*ng+i] += 0.0;
                f_udg[178*ng+i] += 0.0;
                f_udg[179*ng+i] += 0.0;
                f_udg[180*ng+i] += 0.0;
                f_udg[181*ng+i] += av;
                f_udg[182*ng+i] += 0.0;
                f_udg[183*ng+i] += 0.0;
                f_udg[184*ng+i] += t80;
                f_udg[185*ng+i] += 0.0;
                f_udg[186*ng+i] += 0.0;
                f_udg[187*ng+i] += av;
                f_udg[188*ng+i] += 0.0;
                f_udg[189*ng+i] += t76-av*gam*rv*t2*t33;
                f_udg[190*ng+i] += 0.0;
                f_udg[191*ng+i] += 0.0;
                f_udg[192*ng+i] += 0.0;
                f_udg[193*ng+i] += av;
                f_udg[194*ng+i] += t81;
                f_udg[195*ng+i] += 0.0;
                f_udg[196*ng+i] += 0.0;
                f_udg[197*ng+i] += 0.0;
                f_udg[198*ng+i] += 0.0;
                f_udg[199*ng+i] += 0.0;
                f_udg[200*ng+i] += 0.0;
                f_udg[201*ng+i] += 0.0;
                f_udg[202*ng+i] += 0.0;
                f_udg[203*ng+i] += 0.0;
                f_udg[204*ng+i] += -av*gam*rw*t2*t33;
                f_udg[205*ng+i] += 0.0;
                f_udg[206*ng+i] += 0.0;
                f_udg[207*ng+i] += 0.0;
                f_udg[208*ng+i] += 0.0;
                f_udg[209*ng+i] += 0.0;
                f_udg[210*ng+i] += 0.0;
                f_udg[211*ng+i] += 0.0;
                f_udg[212*ng+i] += 0.0;
                f_udg[213*ng+i] += 0.0;
                f_udg[214*ng+i] += 0.0;
                f_udg[215*ng+i] += 0.0;
                f_udg[216*ng+i] += 0.0;
                f_udg[217*ng+i] += 0.0;
                f_udg[218*ng+i] += 0.0;
                f_udg[219*ng+i] += t82;
                f_udg[220*ng+i] += 0.0;
                f_udg[221*ng+i] += 0.0;
                f_udg[222*ng+i] += 0.0;
                f_udg[223*ng+i] += 0.0;
                f_udg[224*ng+i] += 0.0;
                f_udg[225*ng+i] += 0.0;
                f_udg[226*ng+i] += -t81;
                f_udg[227*ng+i] += 0.0;
                f_udg[228*ng+i] += 0.0;
                f_udg[229*ng+i] += -av*ru*rw*t4;
                f_udg[230*ng+i] += 0.0;
                f_udg[231*ng+i] += 0.0;
                f_udg[232*ng+i] += -t81;
                f_udg[233*ng+i] += 0.0;
                f_udg[234*ng+i] += -av*rv*rw*t4;
                f_udg[235*ng+i] += 0.0;
                f_udg[236*ng+i] += 0.0;
                f_udg[237*ng+i] += 0.0;
                f_udg[238*ng+i] += -t81;
                f_udg[239*ng+i] += -av*t4*t18-av*gam*t2*t33*t34*t79;
                f_udg[240*ng+i] += 0.0;
                f_udg[241*ng+i] += 0.0;
                f_udg[242*ng+i] += 0.0;
                f_udg[243*ng+i] += 0.0;
                f_udg[244*ng+i] += 0.0;
                f_udg[245*ng+i] += 0.0;
                f_udg[246*ng+i] += 0.0;
                f_udg[247*ng+i] += 0.0;
                f_udg[248*ng+i] += 0.0;
                f_udg[249*ng+i] += 0.0;
                f_udg[250*ng+i] += 0.0;
                f_udg[251*ng+i] += 0.0;
                f_udg[252*ng+i] += 0.0;
                f_udg[253*ng+i] += 0.0;
                f_udg[254*ng+i] += -av*gam*ru*t2*t33;
                f_udg[255*ng+i] += 0.0;
                f_udg[256*ng+i] += 0.0;
                f_udg[257*ng+i] += 0.0;
                f_udg[258*ng+i] += 0.0;
                f_udg[259*ng+i] += 0.0;
                f_udg[260*ng+i] += 0.0;
                f_udg[261*ng+i] += 0.0;
                f_udg[262*ng+i] += 0.0;
                f_udg[263*ng+i] += 0.0;
                f_udg[264*ng+i] += 0.0;
                f_udg[265*ng+i] += 0.0;
                f_udg[266*ng+i] += 0.0;
                f_udg[267*ng+i] += 0.0;
                f_udg[268*ng+i] += 0.0;
                f_udg[269*ng+i] += -av*gam*rv*t2*t33;
                f_udg[270*ng+i] += 0.0;
                f_udg[271*ng+i] += av;
                f_udg[272*ng+i] += 0.0;
                f_udg[273*ng+i] += 0.0;
                f_udg[274*ng+i] += t80;
                f_udg[275*ng+i] += 0.0;
                f_udg[276*ng+i] += 0.0;
                f_udg[277*ng+i] += av;
                f_udg[278*ng+i] += 0.0;
                f_udg[279*ng+i] += t76;
                f_udg[280*ng+i] += 0.0;
                f_udg[281*ng+i] += 0.0;
                f_udg[282*ng+i] += 0.0;
                f_udg[283*ng+i] += av;
                f_udg[284*ng+i] += t81-av*gam*rw*t2*t33;
                f_udg[285*ng+i] += 0.0;
                f_udg[286*ng+i] += 0.0;
                f_udg[287*ng+i] += 0.0;
                f_udg[288*ng+i] += 0.0;
                f_udg[289*ng+i] += 0.0;
                f_udg[290*ng+i] += 0.0;
                f_udg[291*ng+i] += 0.0;
                f_udg[292*ng+i] += 0.0;
                f_udg[293*ng+i] += 0.0;
                f_udg[294*ng+i] += 0.0;
                f_udg[295*ng+i] += 0.0;
                f_udg[296*ng+i] += 0.0;
                f_udg[297*ng+i] += 0.0;
                f_udg[298*ng+i] += 0.0;
                f_udg[299*ng+i] += t82;
            }
            else if (AVtype == 3) {          // Physical model with thermal conductivity only
                double t2 = 1.0/(r*r);
                double t3 = 1.0/r;
                double t4 = ru*ru;
                double t5 = 1.0/(r*r*r*r);
                double t6 = rv*rv;
                double t7 = rw*rw;
                double t12 = ru*rx*t3;
                double t8 = rux-t12;
                double t9 = 1.0/(r*r*r);
                double t14 = rv*rx*t3;
                double t10 = rvx-t14;
                double t16 = rw*rx*t3;
                double t11 = rwx-t16;
                double t13 = ru*t2*t8;
                double t15 = rv*t2*t10;
                double t17 = rw*t2*t11;
                double t18 = t2*t4*(1.0/2.0);
                double t19 = t2*t6*(1.0/2.0);
                double t20 = t2*t7*(1.0/2.0);
                double t21 = t4*t9;
                double t22 = t6*t9;
                double t23 = t7*t9;
                double t24 = t21+t22+t23;
                double t25 = 1.0/gam1;
                double t26 = t18+t19+t20;
                double t27 = rx*t26;
                double t28 = t13+t15+t17;
                double t29 = r*t28;
                double t30 = -rEx+t27+t29;
                double t34 = ru*ry*t3;
                double t31 = ruy-t34;
                double t36 = rv*ry*t3;
                double t32 = rvy-t36;
                double t38 = rw*ry*t3;
                double t33 = rwy-t38;
                double t35 = ru*t2*t31;
                double t37 = rv*t2*t32;
                double t39 = rw*t2*t33;
                double t55 = r*t24;
                double t40 = t18+t19+t20-t55;
                double t56 = r*t26;
                double t41 = rE-t56;
                double t42 = ry*t26;
                double t43 = t35+t37+t39;
                double t44 = r*t43;
                double t45 = -rEy+t42+t44;
                double t49 = ru*rz*t3;
                double t46 = ruz-t49;
                double t51 = rv*rz*t3;
                double t47 = rvz-t51;
                double t53 = rw*rz*t3;
                double t48 = rwz-t53;
                double t50 = ru*t2*t46;
                double t52 = rv*t2*t47;
                double t54 = rw*t2*t48;
                double t57 = rz*t26;
                double t58 = t50+t52+t54;
                double t59 = r*t58;
                double t60 = -rEz+t57+t59;
                double t61 = gam1*t41;
                double t62 = gam1*r*t40;
                double t63 = t61+t62;
                
                f_udg[0*ng+i] += 0.0;
                f_udg[1*ng+i] += 0.0;
                f_udg[2*ng+i] += 0.0;
                f_udg[3*ng+i] += 0.0;
                f_udg[4*ng+i] += av*t2*t25*(gam1*r*t30+gam1*rx*t41)-av*t3*t25*(gam1*t30-gam1*rx*t40+gam1*r*(t13+t15+t17-rx*t24-r*(ru*t8*t9*2.0+rv*t9*t10*2.0+rw*t9*t11*2.0-rx*t4*t5-rx*t5*t6-rx*t5*t7)));
                f_udg[5*ng+i] += 0.0;
                f_udg[6*ng+i] += 0.0;
                f_udg[7*ng+i] += 0.0;
                f_udg[8*ng+i] += 0.0;
                f_udg[9*ng+i] += av*t2*t25*(gam1*r*t45+gam1*ry*t41)-av*t3*t25*(gam1*t45-gam1*ry*t40+gam1*r*(t35+t37+t39-ry*t24-r*(ru*t9*t31*2.0+rv*t9*t32*2.0+rw*t9*t33*2.0-ry*t4*t5-ry*t5*t6-ry*t5*t7)));
                f_udg[10*ng+i] += 0.0;
                f_udg[11*ng+i] += 0.0;
                f_udg[12*ng+i] += 0.0;
                f_udg[13*ng+i] += 0.0;
                f_udg[14*ng+i] += av*t2*t25*(gam1*r*t60+gam1*rz*t41)-av*t3*t25*(gam1*t60-gam1*rz*t40+gam1*r*(t50+t52+t54-rz*t24-r*(ru*t9*t46*2.0+rv*t9*t47*2.0+rw*t9*t48*2.0-rz*t4*t5-rz*t5*t6-rz*t5*t7)));
                f_udg[15*ng+i] += 0.0;
                f_udg[16*ng+i] += 0.0;
                f_udg[17*ng+i] += 0.0;
                f_udg[18*ng+i] += 0.0;
                f_udg[19*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t8-ru*rx*t9)+ru*rx*t2)-gam1*ru*rx*t3);
                f_udg[20*ng+i] += 0.0;
                f_udg[21*ng+i] += 0.0;
                f_udg[22*ng+i] += 0.0;
                f_udg[23*ng+i] += 0.0;
                f_udg[24*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t31-ru*ry*t9)+ru*ry*t2)-gam1*ru*ry*t3);
                f_udg[25*ng+i] += 0.0;
                f_udg[26*ng+i] += 0.0;
                f_udg[27*ng+i] += 0.0;
                f_udg[28*ng+i] += 0.0;
                f_udg[29*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t46-ru*rz*t9)+ru*rz*t2)-gam1*ru*rz*t3);
                f_udg[30*ng+i] += 0.0;
                f_udg[31*ng+i] += 0.0;
                f_udg[32*ng+i] += 0.0;
                f_udg[33*ng+i] += 0.0;
                f_udg[34*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t10-rv*rx*t9)+rv*rx*t2)-gam1*rv*rx*t3);
                f_udg[35*ng+i] += 0.0;
                f_udg[36*ng+i] += 0.0;
                f_udg[37*ng+i] += 0.0;
                f_udg[38*ng+i] += 0.0;
                f_udg[39*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t32-rv*ry*t9)+rv*ry*t2)-gam1*rv*ry*t3);
                f_udg[40*ng+i] += 0.0;
                f_udg[41*ng+i] += 0.0;
                f_udg[42*ng+i] += 0.0;
                f_udg[43*ng+i] += 0.0;
                f_udg[44*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t47-rv*rz*t9)+rv*rz*t2)-gam1*rv*rz*t3);
                f_udg[45*ng+i] += 0.0;
                f_udg[46*ng+i] += 0.0;
                f_udg[47*ng+i] += 0.0;
                f_udg[48*ng+i] += 0.0;
                f_udg[49*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t11-rw*rx*t9)+rw*rx*t2)-gam1*rw*rx*t3);
                f_udg[50*ng+i] += 0.0;
                f_udg[51*ng+i] += 0.0;
                f_udg[52*ng+i] += 0.0;
                f_udg[53*ng+i] += 0.0;
                f_udg[54*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t33-rw*ry*t9)+rw*ry*t2)-gam1*rw*ry*t3);
                f_udg[55*ng+i] += 0.0;
                f_udg[56*ng+i] += 0.0;
                f_udg[57*ng+i] += 0.0;
                f_udg[58*ng+i] += 0.0;
                f_udg[59*ng+i] += -av*t3*t25*(gam1*r*(r*(t2*t48-rw*rz*t9)+rw*rz*t2)-gam1*rw*rz*t3);
                f_udg[60*ng+i] += 0.0;
                f_udg[61*ng+i] += 0.0;
                f_udg[62*ng+i] += 0.0;
                f_udg[63*ng+i] += 0.0;
                f_udg[64*ng+i] += -av*rx*t3;
                f_udg[65*ng+i] += 0.0;
                f_udg[66*ng+i] += 0.0;
                f_udg[67*ng+i] += 0.0;
                f_udg[68*ng+i] += 0.0;
                f_udg[69*ng+i] += -av*ry*t3;
                f_udg[70*ng+i] += 0.0;
                f_udg[71*ng+i] += 0.0;
                f_udg[72*ng+i] += 0.0;
                f_udg[73*ng+i] += 0.0;
                f_udg[74*ng+i] += -av*rz*t3;
                f_udg[75*ng+i] += 0.0;
                f_udg[76*ng+i] += 0.0;
                f_udg[77*ng+i] += 0.0;
                f_udg[78*ng+i] += 0.0;
                f_udg[79*ng+i] += -av*t3*t25*t63;
                f_udg[80*ng+i] += 0.0;
                f_udg[81*ng+i] += 0.0;
                f_udg[82*ng+i] += 0.0;
                f_udg[83*ng+i] += 0.0;
                f_udg[84*ng+i] += 0.0;
                f_udg[85*ng+i] += 0.0;
                f_udg[86*ng+i] += 0.0;
                f_udg[87*ng+i] += 0.0;
                f_udg[88*ng+i] += 0.0;
                f_udg[89*ng+i] += 0.0;
                f_udg[90*ng+i] += 0.0;
                f_udg[91*ng+i] += 0.0;
                f_udg[92*ng+i] += 0.0;
                f_udg[93*ng+i] += 0.0;
                f_udg[94*ng+i] += -av*ru*t3;
                f_udg[95*ng+i] += 0.0;
                f_udg[96*ng+i] += 0.0;
                f_udg[97*ng+i] += 0.0;
                f_udg[98*ng+i] += 0.0;
                f_udg[99*ng+i] += 0.0;
                f_udg[100*ng+i] += 0.0;
                f_udg[101*ng+i] += 0.0;
                f_udg[102*ng+i] += 0.0;
                f_udg[103*ng+i] += 0.0;
                f_udg[104*ng+i] += 0.0;
                f_udg[105*ng+i] += 0.0;
                f_udg[106*ng+i] += 0.0;
                f_udg[107*ng+i] += 0.0;
                f_udg[108*ng+i] += 0.0;
                f_udg[109*ng+i] += -av*rv*t3;
                f_udg[110*ng+i] += 0.0;
                f_udg[111*ng+i] += 0.0;
                f_udg[112*ng+i] += 0.0;
                f_udg[113*ng+i] += 0.0;
                f_udg[114*ng+i] += 0.0;
                f_udg[115*ng+i] += 0.0;
                f_udg[116*ng+i] += 0.0;
                f_udg[117*ng+i] += 0.0;
                f_udg[118*ng+i] += 0.0;
                f_udg[119*ng+i] += 0.0;
                f_udg[120*ng+i] += 0.0;
                f_udg[121*ng+i] += 0.0;
                f_udg[122*ng+i] += 0.0;
                f_udg[123*ng+i] += 0.0;
                f_udg[124*ng+i] += -av*rw*t3;
                f_udg[125*ng+i] += 0.0;
                f_udg[126*ng+i] += 0.0;
                f_udg[127*ng+i] += 0.0;
                f_udg[128*ng+i] += 0.0;
                f_udg[129*ng+i] += 0.0;
                f_udg[130*ng+i] += 0.0;
                f_udg[131*ng+i] += 0.0;
                f_udg[132*ng+i] += 0.0;
                f_udg[133*ng+i] += 0.0;
                f_udg[134*ng+i] += 0.0;
                f_udg[135*ng+i] += 0.0;
                f_udg[136*ng+i] += 0.0;
                f_udg[137*ng+i] += 0.0;
                f_udg[138*ng+i] += 0.0;
                f_udg[139*ng+i] += av;
                f_udg[140*ng+i] += 0.0;
                f_udg[141*ng+i] += 0.0;
                f_udg[142*ng+i] += 0.0;
                f_udg[143*ng+i] += 0.0;
                f_udg[144*ng+i] += 0.0;
                f_udg[145*ng+i] += 0.0;
                f_udg[146*ng+i] += 0.0;
                f_udg[147*ng+i] += 0.0;
                f_udg[148*ng+i] += 0.0;
                f_udg[149*ng+i] += 0.0;
                f_udg[150*ng+i] += 0.0;
                f_udg[151*ng+i] += 0.0;
                f_udg[152*ng+i] += 0.0;
                f_udg[153*ng+i] += 0.0;
                f_udg[154*ng+i] += 0.0;
                f_udg[155*ng+i] += 0.0;
                f_udg[156*ng+i] += 0.0;
                f_udg[157*ng+i] += 0.0;
                f_udg[158*ng+i] += 0.0;
                f_udg[159*ng+i] += -av*t3*t25*t63;
                f_udg[160*ng+i] += 0.0;
                f_udg[161*ng+i] += 0.0;
                f_udg[162*ng+i] += 0.0;
                f_udg[163*ng+i] += 0.0;
                f_udg[164*ng+i] += 0.0;
                f_udg[165*ng+i] += 0.0;
                f_udg[166*ng+i] += 0.0;
                f_udg[167*ng+i] += 0.0;
                f_udg[168*ng+i] += 0.0;
                f_udg[169*ng+i] += 0.0;
                f_udg[170*ng+i] += 0.0;
                f_udg[171*ng+i] += 0.0;
                f_udg[172*ng+i] += 0.0;
                f_udg[173*ng+i] += 0.0;
                f_udg[174*ng+i] += -av*ru*t3;
                f_udg[175*ng+i] += 0.0;
                f_udg[176*ng+i] += 0.0;
                f_udg[177*ng+i] += 0.0;
                f_udg[178*ng+i] += 0.0;
                f_udg[179*ng+i] += 0.0;
                f_udg[180*ng+i] += 0.0;
                f_udg[181*ng+i] += 0.0;
                f_udg[182*ng+i] += 0.0;
                f_udg[183*ng+i] += 0.0;
                f_udg[184*ng+i] += 0.0;
                f_udg[185*ng+i] += 0.0;
                f_udg[186*ng+i] += 0.0;
                f_udg[187*ng+i] += 0.0;
                f_udg[188*ng+i] += 0.0;
                f_udg[189*ng+i] += -av*rv*t3;
                f_udg[190*ng+i] += 0.0;
                f_udg[191*ng+i] += 0.0;
                f_udg[192*ng+i] += 0.0;
                f_udg[193*ng+i] += 0.0;
                f_udg[194*ng+i] += 0.0;
                f_udg[195*ng+i] += 0.0;
                f_udg[196*ng+i] += 0.0;
                f_udg[197*ng+i] += 0.0;
                f_udg[198*ng+i] += 0.0;
                f_udg[199*ng+i] += 0.0;
                f_udg[200*ng+i] += 0.0;
                f_udg[201*ng+i] += 0.0;
                f_udg[202*ng+i] += 0.0;
                f_udg[203*ng+i] += 0.0;
                f_udg[204*ng+i] += -av*rw*t3;
                f_udg[205*ng+i] += 0.0;
                f_udg[206*ng+i] += 0.0;
                f_udg[207*ng+i] += 0.0;
                f_udg[208*ng+i] += 0.0;
                f_udg[209*ng+i] += 0.0;
                f_udg[210*ng+i] += 0.0;
                f_udg[211*ng+i] += 0.0;
                f_udg[212*ng+i] += 0.0;
                f_udg[213*ng+i] += 0.0;
                f_udg[214*ng+i] += 0.0;
                f_udg[215*ng+i] += 0.0;
                f_udg[216*ng+i] += 0.0;
                f_udg[217*ng+i] += 0.0;
                f_udg[218*ng+i] += 0.0;
                f_udg[219*ng+i] += av;
                f_udg[220*ng+i] += 0.0;
                f_udg[221*ng+i] += 0.0;
                f_udg[222*ng+i] += 0.0;
                f_udg[223*ng+i] += 0.0;
                f_udg[224*ng+i] += 0.0;
                f_udg[225*ng+i] += 0.0;
                f_udg[226*ng+i] += 0.0;
                f_udg[227*ng+i] += 0.0;
                f_udg[228*ng+i] += 0.0;
                f_udg[229*ng+i] += 0.0;
                f_udg[230*ng+i] += 0.0;
                f_udg[231*ng+i] += 0.0;
                f_udg[232*ng+i] += 0.0;
                f_udg[233*ng+i] += 0.0;
                f_udg[234*ng+i] += 0.0;
                f_udg[235*ng+i] += 0.0;
                f_udg[236*ng+i] += 0.0;
                f_udg[237*ng+i] += 0.0;
                f_udg[238*ng+i] += 0.0;
                f_udg[239*ng+i] += -av*t3*t25*t63;
                f_udg[240*ng+i] += 0.0;
                f_udg[241*ng+i] += 0.0;
                f_udg[242*ng+i] += 0.0;
                f_udg[243*ng+i] += 0.0;
                f_udg[244*ng+i] += 0.0;
                f_udg[245*ng+i] += 0.0;
                f_udg[246*ng+i] += 0.0;
                f_udg[247*ng+i] += 0.0;
                f_udg[248*ng+i] += 0.0;
                f_udg[249*ng+i] += 0.0;
                f_udg[250*ng+i] += 0.0;
                f_udg[251*ng+i] += 0.0;
                f_udg[252*ng+i] += 0.0;
                f_udg[253*ng+i] += 0.0;
                f_udg[254*ng+i] += -av*ru*t3;
                f_udg[255*ng+i] += 0.0;
                f_udg[256*ng+i] += 0.0;
                f_udg[257*ng+i] += 0.0;
                f_udg[258*ng+i] += 0.0;
                f_udg[259*ng+i] += 0.0;
                f_udg[260*ng+i] += 0.0;
                f_udg[261*ng+i] += 0.0;
                f_udg[262*ng+i] += 0.0;
                f_udg[263*ng+i] += 0.0;
                f_udg[264*ng+i] += 0.0;
                f_udg[265*ng+i] += 0.0;
                f_udg[266*ng+i] += 0.0;
                f_udg[267*ng+i] += 0.0;
                f_udg[268*ng+i] += 0.0;
                f_udg[269*ng+i] += -av*rv*t3;
                f_udg[270*ng+i] += 0.0;
                f_udg[271*ng+i] += 0.0;
                f_udg[272*ng+i] += 0.0;
                f_udg[273*ng+i] += 0.0;
                f_udg[274*ng+i] += 0.0;
                f_udg[275*ng+i] += 0.0;
                f_udg[276*ng+i] += 0.0;
                f_udg[277*ng+i] += 0.0;
                f_udg[278*ng+i] += 0.0;
                f_udg[279*ng+i] += 0.0;
                f_udg[280*ng+i] += 0.0;
                f_udg[281*ng+i] += 0.0;
                f_udg[282*ng+i] += 0.0;
                f_udg[283*ng+i] += 0.0;
                f_udg[284*ng+i] += -av*rw*t3;
                f_udg[285*ng+i] += 0.0;
                f_udg[286*ng+i] += 0.0;
                f_udg[287*ng+i] += 0.0;
                f_udg[288*ng+i] += 0.0;
                f_udg[289*ng+i] += 0.0;
                f_udg[290*ng+i] += 0.0;
                f_udg[291*ng+i] += 0.0;
                f_udg[292*ng+i] += 0.0;
                f_udg[293*ng+i] += 0.0;
                f_udg[294*ng+i] += 0.0;
                f_udg[295*ng+i] += 0.0;
                f_udg[296*ng+i] += 0.0;
                f_udg[297*ng+i] += 0.0;
                f_udg[298*ng+i] += 0.0;
                f_udg[299*ng+i] += av;
            }
            else if (AVtype == 4) {             // Physical model with molecular viscosity only
                double t2 = 1.0/r;
                double t12 = ru*rx*t2;
                double t3 = rux-t12;
                double t4 = 1.0/(r*r);
                double t14 = rv*ry*t2;
                double t5 = rvy-t14;
                double t15 = rw*rz*t2;
                double t6 = rwz-t15;
                double t7 = 1.0/(r*r*r);
                double t19 = ru*ry*t2;
                double t8 = ruy-t19;
                double t21 = rv*rx*t2;
                double t9 = rvx-t21;
                double t24 = ru*rz*t2;
                double t10 = ruz-t24;
                double t26 = rw*rx*t2;
                double t11 = rwx-t26;
                double t13 = t3*t4*(4.0/3.0);
                double t16 = rv*ry*t7*(2.0/3.0);
                double t17 = rw*rz*t7*(2.0/3.0);
                double t37 = t4*t6*(2.0/3.0);
                double t65 = t4*t5*(2.0/3.0);
                double t18 = t13+t16+t17-t37-t65-ru*rx*t7*(4.0/3.0);
                double t20 = t4*t8;
                double t22 = t4*t9;
                double t33 = ru*ry*t7;
                double t34 = rv*rx*t7;
                double t23 = t20+t22-t33-t34;
                double t25 = t4*t10;
                double t27 = t4*t11;
                double t52 = ru*rz*t7;
                double t53 = rw*rx*t7;
                double t28 = t25+t27-t52-t53;
                double t29 = t2*t8;
                double t30 = t2*t9;
                double t31 = t29+t30;
                double t32 = av*t31;
                double t35 = t32-av*r*t23;
                double t36 = t2*t6*(2.0/3.0);
                double t43 = rv*rz*t2;
                double t38 = rvz-t43;
                double t45 = rw*ry*t2;
                double t39 = rwy-t45;
                double t40 = t4*t5*(4.0/3.0);
                double t41 = ru*rx*t7*(2.0/3.0);
                double t64 = t3*t4*(2.0/3.0);
                double t42 = t17-t37+t40+t41-t64-rv*ry*t7*(4.0/3.0);
                double t44 = t4*t38;
                double t46 = t4*t39;
                double t59 = rv*rz*t7;
                double t60 = rw*ry*t7;
                double t47 = t44+t46-t59-t60;
                double t48 = t2*t10;
                double t49 = t2*t11;
                double t50 = t48+t49;
                double t51 = av*t50;
                double t54 = t51-av*r*t28;
                double t55 = t2*t38;
                double t56 = t2*t39;
                double t57 = t55+t56;
                double t58 = av*t57;
                double t61 = t58-av*r*t47;
                double t62 = t2*t3*(2.0/3.0);
                double t63 = t2*t5*(2.0/3.0);
                double t66 = t4*t6*(4.0/3.0);
                double t67 = t16+t41-t64-t65+t66-rw*rz*t7*(4.0/3.0);
                double t68 = t36+t63-t2*t3*(4.0/3.0);
                double t69 = av*rx*t2*(2.0/3.0);
                double t70 = t36+t62-t2*t5*(4.0/3.0);
                double t71 = av*ry*t2*(2.0/3.0);
                double t72 = av*rz*t2*(2.0/3.0);
                double t73 = t62+t63-t2*t6*(4.0/3.0);
                double t74 = av*ru*t2*(2.0/3.0);
                double t75 = av*ru*t2;
                double t76 = av*rw*t2;
                double t77 = ru*ru;
                double t78 = rv*rv;
                double t79 = rw*rw;
                double t80 = av*rv*t2*(2.0/3.0);
                double t81 = av*rv*t2;
                double t82 = av*(4.0/3.0);
                double t83 = av*rw*t2*(2.0/3.0);
                
                f_udg[0*ng+i] += 0.0;
                f_udg[1*ng+i] += -av*t68-av*r*t18;
                f_udg[2*ng+i] += t35;
                f_udg[3*ng+i] += t54;
                f_udg[4*ng+i] += -av*ru*t18-av*rv*t23-av*rw*t28;
                f_udg[5*ng+i] += 0.0;
                f_udg[6*ng+i] += t35;
                f_udg[7*ng+i] += -av*t70-av*r*t42;
                f_udg[8*ng+i] += t61;
                f_udg[9*ng+i] += -av*ru*t23-av*rv*t42-av*rw*t47;
                f_udg[10*ng+i] += 0.0;
                f_udg[11*ng+i] += t54;
                f_udg[12*ng+i] += t61;
                f_udg[13*ng+i] += -av*t73-av*r*t67;
                f_udg[14*ng+i] += -av*ru*t28-av*rv*t47-av*rw*t67;
                f_udg[15*ng+i] += 0.0;
                f_udg[16*ng+i] += av*rx*t2*(-4.0/3.0);
                f_udg[17*ng+i] += -av*ry*t2;
                f_udg[18*ng+i] += -av*rz*t2;
                f_udg[19*ng+i] += -av*t68-av*ru*rx*t4*(4.0/3.0)-av*rv*ry*t4-av*rw*rz*t4;
                f_udg[20*ng+i] += 0.0;
                f_udg[21*ng+i] += -av*ry*t2;
                f_udg[22*ng+i] += t69;
                f_udg[23*ng+i] += 0.0;
                f_udg[24*ng+i] += t32-av*ru*ry*t4+av*rv*rx*t4*(2.0/3.0);
                f_udg[25*ng+i] += 0.0;
                f_udg[26*ng+i] += -av*rz*t2;
                f_udg[27*ng+i] += 0.0;
                f_udg[28*ng+i] += t69;
                f_udg[29*ng+i] += t51-av*ru*rz*t4+av*rw*rx*t4*(2.0/3.0);
                f_udg[30*ng+i] += 0.0;
                f_udg[31*ng+i] += t71;
                f_udg[32*ng+i] += -av*rx*t2;
                f_udg[33*ng+i] += 0.0;
                f_udg[34*ng+i] += t32+av*ru*ry*t4*(2.0/3.0)-av*rv*rx*t4;
                f_udg[35*ng+i] += 0.0;
                f_udg[36*ng+i] += -av*rx*t2;
                f_udg[37*ng+i] += av*ry*t2*(-4.0/3.0);
                f_udg[38*ng+i] += -av*rz*t2;
                f_udg[39*ng+i] += -av*t70-av*ru*rx*t4-av*rv*ry*t4*(4.0/3.0)-av*rw*rz*t4;
                f_udg[40*ng+i] += 0.0;
                f_udg[41*ng+i] += 0.0;
                f_udg[42*ng+i] += -av*rz*t2;
                f_udg[43*ng+i] += t71;
                f_udg[44*ng+i] += t58-av*rv*rz*t4+av*rw*ry*t4*(2.0/3.0);
                f_udg[45*ng+i] += 0.0;
                f_udg[46*ng+i] += t72;
                f_udg[47*ng+i] += 0.0;
                f_udg[48*ng+i] += -av*rx*t2;
                f_udg[49*ng+i] += t51+av*ru*rz*t4*(2.0/3.0)-av*rw*rx*t4;
                f_udg[50*ng+i] += 0.0;
                f_udg[51*ng+i] += 0.0;
                f_udg[52*ng+i] += t72;
                f_udg[53*ng+i] += -av*ry*t2;
                f_udg[54*ng+i] += t58+av*rv*rz*t4*(2.0/3.0)-av*rw*ry*t4;
                f_udg[55*ng+i] += 0.0;
                f_udg[56*ng+i] += -av*rx*t2;
                f_udg[57*ng+i] += -av*ry*t2;
                f_udg[58*ng+i] += av*rz*t2*(-4.0/3.0);
                f_udg[59*ng+i] += -av*t73-av*ru*rx*t4-av*rv*ry*t4-av*rw*rz*t4*(4.0/3.0);
                f_udg[60*ng+i] += 0.0;
                f_udg[61*ng+i] += 0.0;
                f_udg[62*ng+i] += 0.0;
                f_udg[63*ng+i] += 0.0;
                f_udg[64*ng+i] += 0.0;
                f_udg[65*ng+i] += 0.0;
                f_udg[66*ng+i] += 0.0;
                f_udg[67*ng+i] += 0.0;
                f_udg[68*ng+i] += 0.0;
                f_udg[69*ng+i] += 0.0;
                f_udg[70*ng+i] += 0.0;
                f_udg[71*ng+i] += 0.0;
                f_udg[72*ng+i] += 0.0;
                f_udg[73*ng+i] += 0.0;
                f_udg[74*ng+i] += 0.0;
                f_udg[75*ng+i] += 0.0;
                f_udg[76*ng+i] += av*ru*t2*(-4.0/3.0);
                f_udg[77*ng+i] += -av*rv*t2;
                f_udg[78*ng+i] += -av*rw*t2;
                f_udg[79*ng+i] += av*t4*t77*(-4.0/3.0)-av*t4*t78-av*t4*t79;
                f_udg[80*ng+i] += 0.0;
                f_udg[81*ng+i] += -av*rv*t2;
                f_udg[82*ng+i] += t74;
                f_udg[83*ng+i] += 0.0;
                f_udg[84*ng+i] += av*ru*rv*t4*(-1.0/3.0);
                f_udg[85*ng+i] += 0.0;
                f_udg[86*ng+i] += -av*rw*t2;
                f_udg[87*ng+i] += 0.0;
                f_udg[88*ng+i] += t74;
                f_udg[89*ng+i] += av*ru*rw*t4*(-1.0/3.0);
                f_udg[90*ng+i] += 0.0;
                f_udg[91*ng+i] += t82;
                f_udg[92*ng+i] += 0.0;
                f_udg[93*ng+i] += 0.0;
                f_udg[94*ng+i] += av*ru*t2*(4.0/3.0);
                f_udg[95*ng+i] += 0.0;
                f_udg[96*ng+i] += 0.0;
                f_udg[97*ng+i] += av*(-2.0/3.0);
                f_udg[98*ng+i] += 0.0;
                f_udg[99*ng+i] += av*rv*t2*(-2.0/3.0);
                f_udg[100*ng+i] += 0.0;
                f_udg[101*ng+i] += 0.0;
                f_udg[102*ng+i] += 0.0;
                f_udg[103*ng+i] += av*(-2.0/3.0);
                f_udg[104*ng+i] += av*rw*t2*(-2.0/3.0);
                f_udg[105*ng+i] += 0.0;
                f_udg[106*ng+i] += 0.0;
                f_udg[107*ng+i] += av;
                f_udg[108*ng+i] += 0.0;
                f_udg[109*ng+i] += t81;
                f_udg[110*ng+i] += 0.0;
                f_udg[111*ng+i] += av;
                f_udg[112*ng+i] += 0.0;
                f_udg[113*ng+i] += 0.0;
                f_udg[114*ng+i] += t75;
                f_udg[115*ng+i] += 0.0;
                f_udg[116*ng+i] += 0.0;
                f_udg[117*ng+i] += 0.0;
                f_udg[118*ng+i] += 0.0;
                f_udg[119*ng+i] += 0.0;
                f_udg[120*ng+i] += 0.0;
                f_udg[121*ng+i] += 0.0;
                f_udg[122*ng+i] += 0.0;
                f_udg[123*ng+i] += av;
                f_udg[124*ng+i] += t76;
                f_udg[125*ng+i] += 0.0;
                f_udg[126*ng+i] += 0.0;
                f_udg[127*ng+i] += 0.0;
                f_udg[128*ng+i] += 0.0;
                f_udg[129*ng+i] += 0.0;
                f_udg[130*ng+i] += 0.0;
                f_udg[131*ng+i] += av;
                f_udg[132*ng+i] += 0.0;
                f_udg[133*ng+i] += 0.0;
                f_udg[134*ng+i] += t75;
                f_udg[135*ng+i] += 0.0;
                f_udg[136*ng+i] += 0.0;
                f_udg[137*ng+i] += 0.0;
                f_udg[138*ng+i] += 0.0;
                f_udg[139*ng+i] += 0.0;
                f_udg[140*ng+i] += 0.0;
                f_udg[141*ng+i] += 0.0;
                f_udg[142*ng+i] += 0.0;
                f_udg[143*ng+i] += 0.0;
                f_udg[144*ng+i] += 0.0;
                f_udg[145*ng+i] += 0.0;
                f_udg[146*ng+i] += 0.0;
                f_udg[147*ng+i] += 0.0;
                f_udg[148*ng+i] += 0.0;
                f_udg[149*ng+i] += 0.0;
                f_udg[150*ng+i] += 0.0;
                f_udg[151*ng+i] += t80;
                f_udg[152*ng+i] += -t75;
                f_udg[153*ng+i] += 0.0;
                f_udg[154*ng+i] += av*ru*rv*t4*(-1.0/3.0);
                f_udg[155*ng+i] += 0.0;
                f_udg[156*ng+i] += -t75;
                f_udg[157*ng+i] += av*rv*t2*(-4.0/3.0);
                f_udg[158*ng+i] += -t76;
                f_udg[159*ng+i] += -av*t4*t77-av*t4*t78*(4.0/3.0)-av*t4*t79;
                f_udg[160*ng+i] += 0.0;
                f_udg[161*ng+i] += 0.0;
                f_udg[162*ng+i] += -t76;
                f_udg[163*ng+i] += t80;
                f_udg[164*ng+i] += av*rv*rw*t4*(-1.0/3.0);
                f_udg[165*ng+i] += 0.0;
                f_udg[166*ng+i] += 0.0;
                f_udg[167*ng+i] += av;
                f_udg[168*ng+i] += 0.0;
                f_udg[169*ng+i] += t81;
                f_udg[170*ng+i] += 0.0;
                f_udg[171*ng+i] += av;
                f_udg[172*ng+i] += 0.0;
                f_udg[173*ng+i] += 0.0;
                f_udg[174*ng+i] += t75;
                f_udg[175*ng+i] += 0.0;
                f_udg[176*ng+i] += 0.0;
                f_udg[177*ng+i] += 0.0;
                f_udg[178*ng+i] += 0.0;
                f_udg[179*ng+i] += 0.0;
                f_udg[180*ng+i] += 0.0;
                f_udg[181*ng+i] += av*(-2.0/3.0);
                f_udg[182*ng+i] += 0.0;
                f_udg[183*ng+i] += 0.0;
                f_udg[184*ng+i] += -t74;
                f_udg[185*ng+i] += 0.0;
                f_udg[186*ng+i] += 0.0;
                f_udg[187*ng+i] += t82;
                f_udg[188*ng+i] += 0.0;
                f_udg[189*ng+i] += av*rv*t2*(4.0/3.0);
                f_udg[190*ng+i] += 0.0;
                f_udg[191*ng+i] += 0.0;
                f_udg[192*ng+i] += 0.0;
                f_udg[193*ng+i] += av*(-2.0/3.0);
                f_udg[194*ng+i] += av*rw*t2*(-2.0/3.0);
                f_udg[195*ng+i] += 0.0;
                f_udg[196*ng+i] += 0.0;
                f_udg[197*ng+i] += 0.0;
                f_udg[198*ng+i] += 0.0;
                f_udg[199*ng+i] += 0.0;
                f_udg[200*ng+i] += 0.0;
                f_udg[201*ng+i] += 0.0;
                f_udg[202*ng+i] += 0.0;
                f_udg[203*ng+i] += av;
                f_udg[204*ng+i] += t76;
                f_udg[205*ng+i] += 0.0;
                f_udg[206*ng+i] += 0.0;
                f_udg[207*ng+i] += av;
                f_udg[208*ng+i] += 0.0;
                f_udg[209*ng+i] += t81;
                f_udg[210*ng+i] += 0.0;
                f_udg[211*ng+i] += 0.0;
                f_udg[212*ng+i] += 0.0;
                f_udg[213*ng+i] += 0.0;
                f_udg[214*ng+i] += 0.0;
                f_udg[215*ng+i] += 0.0;
                f_udg[216*ng+i] += 0.0;
                f_udg[217*ng+i] += 0.0;
                f_udg[218*ng+i] += 0.0;
                f_udg[219*ng+i] += 0.0;
                f_udg[220*ng+i] += 0.0;
                f_udg[221*ng+i] += 0.0;
                f_udg[222*ng+i] += 0.0;
                f_udg[223*ng+i] += 0.0;
                f_udg[224*ng+i] += 0.0;
                f_udg[225*ng+i] += 0.0;
                f_udg[226*ng+i] += t83;
                f_udg[227*ng+i] += 0.0;
                f_udg[228*ng+i] += -t75;
                f_udg[229*ng+i] += av*ru*rw*t4*(-1.0/3.0);
                f_udg[230*ng+i] += 0.0;
                f_udg[231*ng+i] += 0.0;
                f_udg[232*ng+i] += t83;
                f_udg[233*ng+i] += -t81;
                f_udg[234*ng+i] += av*rv*rw*t4*(-1.0/3.0);
                f_udg[235*ng+i] += 0.0;
                f_udg[236*ng+i] += -t75;
                f_udg[237*ng+i] += -t81;
                f_udg[238*ng+i] += av*rw*t2*(-4.0/3.0);
                f_udg[239*ng+i] += -av*t4*t77-av*t4*t78-av*t4*t79*(4.0/3.0);
                f_udg[240*ng+i] += 0.0;
                f_udg[241*ng+i] += 0.0;
                f_udg[242*ng+i] += 0.0;
                f_udg[243*ng+i] += av;
                f_udg[244*ng+i] += t76;
                f_udg[245*ng+i] += 0.0;
                f_udg[246*ng+i] += 0.0;
                f_udg[247*ng+i] += 0.0;
                f_udg[248*ng+i] += 0.0;
                f_udg[249*ng+i] += 0.0;
                f_udg[250*ng+i] += 0.0;
                f_udg[251*ng+i] += av;
                f_udg[252*ng+i] += 0.0;
                f_udg[253*ng+i] += 0.0;
                f_udg[254*ng+i] += t75;
                f_udg[255*ng+i] += 0.0;
                f_udg[256*ng+i] += 0.0;
                f_udg[257*ng+i] += 0.0;
                f_udg[258*ng+i] += 0.0;
                f_udg[259*ng+i] += 0.0;
                f_udg[260*ng+i] += 0.0;
                f_udg[261*ng+i] += 0.0;
                f_udg[262*ng+i] += 0.0;
                f_udg[263*ng+i] += av;
                f_udg[264*ng+i] += t76;
                f_udg[265*ng+i] += 0.0;
                f_udg[266*ng+i] += 0.0;
                f_udg[267*ng+i] += av;
                f_udg[268*ng+i] += 0.0;
                f_udg[269*ng+i] += t81;
                f_udg[270*ng+i] += 0.0;
                f_udg[271*ng+i] += av*(-2.0/3.0);
                f_udg[272*ng+i] += 0.0;
                f_udg[273*ng+i] += 0.0;
                f_udg[274*ng+i] += -t74;
                f_udg[275*ng+i] += 0.0;
                f_udg[276*ng+i] += 0.0;
                f_udg[277*ng+i] += av*(-2.0/3.0);
                f_udg[278*ng+i] += 0.0;
                f_udg[279*ng+i] += -t80;
                f_udg[280*ng+i] += 0.0;
                f_udg[281*ng+i] += 0.0;
                f_udg[282*ng+i] += 0.0;
                f_udg[283*ng+i] += t82;
                f_udg[284*ng+i] += av*rw*t2*(4.0/3.0);
            }
		}
	}
}
