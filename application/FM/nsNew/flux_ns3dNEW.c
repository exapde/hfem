
// Written by: C. Nguyen & P. Fernandez

void flux_ns3dNEW(double *f, double *f_udg, double *pg, double *udg, appstruct &app, double *param,
			   double time, int ng, int nc, int ncu, int nd, int ncd, int computeJacobian)
{
	double param1 = param[0];
	double param2 = param[1];
	double param3 = param[2];
	double param4 = param[3];
	double param5 = param[4];
	double param6 = param[5];

	/* Allocate dynamic memory */
	double * mu  = new double [ng];
	double * mu_udg;
	double * f_mu;
	if (computeJacobian == 1 && app.viscosityModel != 0) {
		mu_udg = new double [ng * nc];
		f_mu = new double [ng * ncu * nd];
	}

	getViscosity(mu, mu_udg, pg, udg, param, app.viscosityModel, ng, nc, ncu, nd, computeJacobian);


	for (int i = 0; i <ng; i++) {
        double x1 = pg[0*ng+i];
        double x2 = pg[1*ng+i];
        double x3 = pg[2*ng+i];

        double u1 = udg[0*ng+i];
        double u2 = udg[1*ng+i];
        double u3 = udg[2*ng+i];
        double u4 = udg[3*ng+i];
        double u5 = udg[4*ng+i];
        double u6 = udg[5*ng+i];
        double u7 = udg[6*ng+i];
        double u8 = udg[7*ng+i];
        double u9 = udg[8*ng+i];
        double u10 = udg[9*ng+i];
        double u11 = udg[10*ng+i];
        double u12 = udg[11*ng+i];
        double u13 = udg[12*ng+i];
        double u14 = udg[13*ng+i];
        double u15 = udg[14*ng+i];
        double u16 = udg[15*ng+i];
        double u17 = udg[16*ng+i];
        double u18 = udg[17*ng+i];
        double u19 = udg[18*ng+i];
        double u20 = udg[19*ng+i];

        double t2 = u2*u2;
        double t3 = 1.0/(u1*u1);
        double t4 = 1.0/u1;
        double t5 = 1.0/param3;
        double t6 = t2*t3*(1.0/2.0);
        double t7 = u3*u3;
        double t8 = t3*t7*(1.0/2.0);
        double t9 = u4*u4;
        double t10 = t3*t9*(1.0/2.0);
        double t11 = t6+t8+t10;
        double t33 = t11*u1;
        double t12 = -t33+u5;
        double t13 = param1-1.0;
        double t31 = t4*u3*u6;
        double t14 = -t31+u8;
        double t15 = t4*t14;
        double t35 = t4*u2*u11;
        double t16 = -t35+u12;
        double t17 = t4*t16;
        double t18 = t15+t17;
        double t32 = t4*u4*u6;
        double t19 = -t32+u9;
        double t20 = t4*t19;
        double t55 = t4*u2*u16;
        double t21 = -t55+u17;
        double t22 = t4*t21;
        double t23 = t20+t22;
        double t30 = t4*u2*u6;
        double t24 = -t30+u7;
        double t39 = t4*u3*u11;
        double t25 = -t39+u13;
        double t26 = t4*t25*(2.0/3.0);
        double t40 = t4*u4*u16;
        double t27 = -t40+u19;
        double t28 = t4*t27*(2.0/3.0);
        double t29 = t26+t28-t4*t24*(4.0/3.0);
        double t34 = t4*u2*u3;
        double t36 = mu[i]*t5*t18;
        double t37 = t34+t36;
        double t38 = t12*t13;
        double t41 = t4*u5;
        double t42 = t4*t12*t13;
        double t43 = t41+t42;
        double t52 = t4*u4*u11;
        double t44 = -t52+u14;
        double t45 = t4*t44;
        double t59 = t4*u3*u16;
        double t46 = -t59+u18;
        double t47 = t4*t46;
        double t48 = t45+t47;
        double t49 = t4*t24*(2.0/3.0);
        double t50 = t28+t49-t4*t25*(4.0/3.0);
        double t51 = 1.0/param4;
        double t53 = 1.0/t13;
        double t54 = t4*u2*u4;
        double t56 = mu[i]*t5*t23;
        double t57 = t54+t56;
        double t58 = t4*u3*u4;
        double t60 = mu[i]*t5*t48;
        double t61 = t58+t60;
        double t62 = t26+t49-t4*t27*(4.0/3.0);

        f[0*ng+i] = u2;
        f[1*ng+i] = t38+t2*t4-mu[i]*t5*t29;
        f[2*ng+i] = t37;
        f[3*ng+i] = t57;
        f[4*ng+i] = t43*u2+mu[i]*t4*t5*t18*u3+mu[i]*t4*t5*t23*u4-mu[i]*t4*t5*t29*u2-mu[i]*param1*t3*t5*t51*t53*(t13*u1*(-u10+t11*u6+u1*(t3*t14*u3+t3*t19*u4+t3*t24*u2))+t12*t13*u6);
        f[5*ng+i] = u3;
        f[6*ng+i] = t37;
        f[7*ng+i] = t38+t4*t7-mu[i]*t5*t50;
        f[8*ng+i] = t61;
        f[9*ng+i] = t43*u3+mu[i]*t4*t5*t18*u2+mu[i]*t4*t5*t48*u4-mu[i]*t4*t5*t50*u3-mu[i]*param1*t3*t5*t51*t53*(t13*u1*(-u15+t11*u11+u1*(t3*t16*u2+t3*t25*u3+t3*t44*u4))+t12*t13*u11);
        f[10*ng+i] = u4;
        f[11*ng+i] = t57;
        f[12*ng+i] = t61;
        f[13*ng+i] = t38+t4*t9-mu[i]*t5*t62;
        f[14*ng+i] = t43*u4+mu[i]*t4*t5*t23*u2+mu[i]*t4*t5*t48*u3-mu[i]*t4*t5*t62*u4-mu[i]*param1*t3*t5*t51*t53*(t13*u1*(-u20+t11*u16+u1*(t3*t21*u2+t3*t27*u4+t3*t46*u3))+t12*t13*u16);
	}

	if (computeJacobian == 1) {

        for (int i = 0; i <ng; i++) {
            double x1 = pg[0*ng+i];
            double x2 = pg[1*ng+i];
            double x3 = pg[2*ng+i];

            double u1 = udg[0*ng+i];
            double u2 = udg[1*ng+i];
            double u3 = udg[2*ng+i];
            double u4 = udg[3*ng+i];
            double u5 = udg[4*ng+i];
            double u6 = udg[5*ng+i];
            double u7 = udg[6*ng+i];
            double u8 = udg[7*ng+i];
            double u9 = udg[8*ng+i];
            double u10 = udg[9*ng+i];
            double u11 = udg[10*ng+i];
            double u12 = udg[11*ng+i];
            double u13 = udg[12*ng+i];
            double u14 = udg[13*ng+i];
            double u15 = udg[14*ng+i];
            double u16 = udg[15*ng+i];
            double u17 = udg[16*ng+i];
            double u18 = udg[17*ng+i];
            double u19 = udg[18*ng+i];
            double u20 = udg[19*ng+i];

            double t2 = 1.0/(u1*u1);
            double t3 = u2*u2;
            double t4 = 1.0/(u1*u1*u1);
            double t5 = u3*u3;
            double t6 = u4*u4;
            double t7 = 1.0/u1;
            double t8 = 1.0/param3;
            double t9 = t2*t3*(1.0/2.0);
            double t10 = t2*t5*(1.0/2.0);
            double t11 = t2*t6*(1.0/2.0);
            double t12 = param1-1.0;
            double t13 = t3*t4;
            double t14 = t4*t5;
            double t15 = t4*t6;
            double t16 = t13+t14+t15;
            double t53 = t16*u1;
            double t17 = t9+t10+t11-t53;
            double t29 = t7*u2*u6;
            double t18 = -t29+u7;
            double t19 = t2*t18*(4.0/3.0);
            double t30 = t7*u3*u11;
            double t20 = -t30+u13;
            double t31 = t7*u4*u16;
            double t21 = -t31+u19;
            double t22 = t4*u3*u11*(2.0/3.0);
            double t23 = t4*u4*u16*(2.0/3.0);
            double t58 = t2*t21*(2.0/3.0);
            double t92 = t2*t20*(2.0/3.0);
            double t24 = t19+t22+t23-t58-t92-t4*u2*u6*(4.0/3.0);
            double t32 = t7*u3*u6;
            double t25 = -t32+u8;
            double t34 = t7*u2*u11;
            double t26 = -t34+u12;
            double t37 = t7*u4*u6;
            double t27 = -t37+u9;
            double t39 = t7*u2*u16;
            double t28 = -t39+u17;
            double t33 = t2*t25;
            double t35 = t2*t26;
            double t55 = t4*u3*u6;
            double t56 = t4*u2*u11;
            double t36 = t33+t35-t55-t56;
            double t38 = t2*t27;
            double t40 = t2*t28;
            double t85 = t4*u4*u6;
            double t86 = t4*u2*u16;
            double t41 = t38+t40-t85-t86;
            double t42 = t9+t10+t11;
            double t60 = t42*u1;
            double t43 = -t60+u5;
            double t44 = 1.0/param4;
            double t45 = 1.0/t12;
            double t46 = t2*t18*u2;
            double t47 = t2*t25*u3;
            double t48 = t2*t27*u4;
            double t49 = t46+t47+t48;
            double t50 = t49*u1;
            double t51 = t42*u6;
            double t52 = t50+t51-u10;
            double t54 = 1.0/(u1*u1*u1*u1);
            double t57 = -mu[i]*t8*t36-t2*u2*u3;
            double t59 = t2*u5;
            double t61 = t2*t12*t43;
            double t62 = t7*t12*t17;
            double t63 = t59+t61+t62;
            double t64 = t2*t20*(4.0/3.0);
            double t65 = t4*u2*u6*(2.0/3.0);
            double t91 = t2*t18*(2.0/3.0);
            double t66 = t23-t58+t64+t65-t91-t4*u3*u11*(4.0/3.0);
            double t67 = t7*t25;
            double t68 = t7*t26;
            double t69 = t67+t68;
            double t73 = t7*u4*u11;
            double t70 = -t73+u14;
            double t75 = t7*u3*u16;
            double t71 = -t75+u18;
            double t72 = t7*t21*(2.0/3.0);
            double t74 = t2*t70;
            double t76 = t2*t71;
            double t88 = t4*u4*u11;
            double t89 = t4*u3*u16;
            double t77 = t74+t76-t88-t89;
            double t78 = t2*t26*u2;
            double t79 = t2*t20*u3;
            double t80 = t2*t70*u4;
            double t81 = t78+t79+t80;
            double t82 = t81*u1;
            double t83 = t42*u11;
            double t84 = t82+t83-u15;
            double t87 = -mu[i]*t8*t41-t2*u2*u4;
            double t90 = -mu[i]*t8*t77-t2*u3*u4;
            double t93 = t2*t21*(4.0/3.0);
            double t94 = t22+t65-t91-t92+t93-t4*u4*u16*(4.0/3.0);
            double t95 = t7*t27;
            double t96 = t7*t28;
            double t97 = t95+t96;
            double t98 = t7*t70;
            double t99 = t7*t71;
            double t100 = t98+t99;
            double t101 = t7*t18*(2.0/3.0);
            double t102 = t7*t20*(2.0/3.0);
            double t103 = t2*t28*u2;
            double t104 = t2*t71*u3;
            double t105 = t2*t21*u4;
            double t106 = t103+t104+t105;
            double t107 = t106*u1;
            double t108 = t42*u16;
            double t109 = t107+t108-u20;
            double t110 = t72+t102-t7*t18*(4.0/3.0);
            double t111 = t7*u3;
            double t130 = mu[i]*t2*t8*u11;
            double t112 = t111-t130;
            double t113 = t7*u4;
            double t120 = mu[i]*t2*t8*u16;
            double t114 = t113-t120;
            double t115 = mu[i]*t2*t8*u6*(2.0/3.0);
            double t116 = t115-t7*t12*u2;
            double t117 = mu[i]*t7*t8*t69;
            double t118 = t7*u2;
            double t126 = mu[i]*t2*t8*u6;
            double t119 = t118-t126;
            double t121 = t7*u5;
            double t122 = t7*t12*t43;
            double t123 = t72+t101-t7*t20*(4.0/3.0);
            double t124 = mu[i]*t2*t8*u11*(2.0/3.0);
            double t125 = t124-t7*t12*u3;
            double t127 = mu[i]*t7*t8*t97;
            double t128 = mu[i]*t2*t8*u16*(2.0/3.0);
            double t132 = t7*t12*u4;
            double t129 = t128-t132;
            double t131 = mu[i]*t7*t8*t100;
            double t133 = t101+t102-t7*t21*(4.0/3.0);
            double t134 = t7*t12;
            double t135 = t7+t134;
            double t136 = mu[i]*t2*t8*u2*(2.0/3.0);
            double t137 = mu[i]*t7*t8;
            double t138 = mu[i]*t2*t8*u2;
            double t139 = mu[i]*t2*t8*u4;
            double t140 = t12*t43;
            double t141 = t12*t17*u1;
            double t142 = t140+t141;
            double t143 = mu[i]*t2*t8*u3*(2.0/3.0);
            double t144 = mu[i]*t2*t8*u3;
            double t145 = mu[i]*t7*t8*(4.0/3.0);
            double t151 = mu[i]*param1*t2*t8*t44*u4;
            double t146 = t139-t151;
            double t147 = mu[i]*param1*t7*t8*t44;
            double t148 = mu[i]*t2*t8*u4*(2.0/3.0);
            double t149 = t138-mu[i]*param1*t2*t8*t44*u2;
            double t150 = t144-mu[i]*param1*t2*t8*t44*u3;


            f_udg[0*ng+i] = 0.0;
            f_udg[1*ng+i] = -t2*t3-t12*t17-mu[i]*t8*t24;
            f_udg[2*ng+i] = t57;
            f_udg[3*ng+i] = t87;
            f_udg[4*ng+i] = -t63*u2-mu[i]*t7*t8*t24*u2-mu[i]*t7*t8*t36*u3-mu[i]*t7*t8*t41*u4-mu[i]*t2*t8*t69*u3-mu[i]*t2*t8*t97*u4+mu[i]*t2*t8*t110*u2-mu[i]*param1*t2*t8*t44*t45*(t12*t52-t12*t17*u6+t12*u1*(t46+t47+t48-t16*u6-u1*(t4*t18*u2*2.0+t4*t25*u3*2.0+t4*t27*u4*2.0-t3*t54*u6-t5*t54*u6-t6*t54*u6)))+mu[i]*param1*t4*t8*t44*t45*(t12*t43*u6+t12*t52*u1)*2.0;
            f_udg[5*ng+i] = 0.0;
            f_udg[6*ng+i] = t57;
            f_udg[7*ng+i] = -t2*t5-t12*t17-mu[i]*t8*t66;
            f_udg[8*ng+i] = t90;
            f_udg[9*ng+i] = -t63*u3-mu[i]*t7*t8*t36*u2-mu[i]*t2*t8*t69*u2-mu[i]*t7*t8*t66*u3-mu[i]*t7*t8*t77*u4-mu[i]*t2*t8*t100*u4+mu[i]*t2*t8*t123*u3-mu[i]*param1*t2*t8*t44*t45*(t12*t84-t12*t17*u11+t12*u1*(t78+t79+t80-t16*u11-u1*(t4*t20*u3*2.0+t4*t26*u2*2.0-t3*t54*u11-t5*t54*u11-t6*t54*u11+t4*t70*u4*2.0)))+mu[i]*param1*t4*t8*t44*t45*(t12*t43*u11+t12*t84*u1)*2.0;
            f_udg[10*ng+i] = 0.0;
            f_udg[11*ng+i] = t87;
            f_udg[12*ng+i] = t90;
            f_udg[13*ng+i] = -t2*t6-t12*t17-mu[i]*t8*t94;
            f_udg[14*ng+i] = -t63*u4-mu[i]*t7*t8*t41*u2-mu[i]*t7*t8*t77*u3-mu[i]*t2*t8*t97*u2-mu[i]*t2*t8*t100*u3-mu[i]*t7*t8*t94*u4+mu[i]*t2*t8*t133*u4-mu[i]*param1*t2*t8*t44*t45*(t12*t109-t12*t17*u16+t12*u1*(t103+t104+t105-t16*u16-u1*(t4*t21*u4*2.0+t4*t28*u2*2.0-t3*t54*u16-t5*t54*u16-t6*t54*u16+t4*t71*u3*2.0)))+mu[i]*param1*t4*t8*t44*t45*(t12*t43*u16+t12*t109*u1)*2.0;
            f_udg[15*ng+i] = 1.0;
            f_udg[16*ng+i] = t7*u2*2.0-t7*t12*u2-mu[i]*t2*t8*u6*(4.0/3.0);
            f_udg[17*ng+i] = t112;
            f_udg[18*ng+i] = t114;
            f_udg[19*ng+i] = t121+t122-t2*t3*t12-mu[i]*t7*t8*t110-mu[i]*t4*t8*u2*u6*(4.0/3.0)-mu[i]*t4*t8*u3*u11-mu[i]*t4*t8*u4*u16-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t2*t18-t4*u2*u6)+t2*u2*u6)-t7*t12*u2*u6);
            f_udg[20*ng+i] = 0.0;
            f_udg[21*ng+i] = t112;
            f_udg[22*ng+i] = t116;
            f_udg[23*ng+i] = 0.0;
            f_udg[24*ng+i] = t117-t2*t12*u2*u3+mu[i]*t4*t8*u3*u6*(2.0/3.0)-mu[i]*t4*t8*u2*u11-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t35-t56)+t2*u2*u11)-t7*t12*u2*u11);
            f_udg[25*ng+i] = 0.0;
            f_udg[26*ng+i] = t114;
            f_udg[27*ng+i] = 0.0;
            f_udg[28*ng+i] = t116;
            f_udg[29*ng+i] = t127-t2*t12*u2*u4+mu[i]*t4*t8*u4*u6*(2.0/3.0)-mu[i]*t4*t8*u2*u16-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t40-t86)+t2*u2*u16)-t7*t12*u2*u16);
            f_udg[30*ng+i] = 0.0;
            f_udg[31*ng+i] = t125;
            f_udg[32*ng+i] = t119;
            f_udg[33*ng+i] = 0.0;
            f_udg[34*ng+i] = t117-t2*t12*u2*u3-mu[i]*t4*t8*u3*u6+mu[i]*t4*t8*u2*u11*(2.0/3.0)-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t33-t55)+t2*u3*u6)-t7*t12*u3*u6);
            f_udg[35*ng+i] = 1.0;
            f_udg[36*ng+i] = t119;
            f_udg[37*ng+i] = t7*u3*2.0-t7*t12*u3-mu[i]*t2*t8*u11*(4.0/3.0);
            f_udg[38*ng+i] = t114;
            f_udg[39*ng+i] = t121+t122-t2*t5*t12-mu[i]*t7*t8*t123-mu[i]*t4*t8*u2*u6-mu[i]*t4*t8*u3*u11*(4.0/3.0)-mu[i]*t4*t8*u4*u16-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t2*t20-t4*u3*u11)+t2*u3*u11)-t7*t12*u3*u11);
            f_udg[40*ng+i] = 0.0;
            f_udg[41*ng+i] = 0.0;
            f_udg[42*ng+i] = t114;
            f_udg[43*ng+i] = t125;
            f_udg[44*ng+i] = t131-t2*t12*u3*u4+mu[i]*t4*t8*u4*u11*(2.0/3.0)-mu[i]*t4*t8*u3*u16-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t76-t89)+t2*u3*u16)-t7*t12*u3*u16);
            f_udg[45*ng+i] = 0.0;
            f_udg[46*ng+i] = t129;
            f_udg[47*ng+i] = 0.0;
            f_udg[48*ng+i] = t119;
            f_udg[49*ng+i] = t127-t2*t12*u2*u4-mu[i]*t4*t8*u4*u6+mu[i]*t4*t8*u2*u16*(2.0/3.0)-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t38-t85)+t2*u4*u6)-t7*t12*u4*u6);
            f_udg[50*ng+i] = 0.0;
            f_udg[51*ng+i] = 0.0;
            f_udg[52*ng+i] = t129;
            f_udg[53*ng+i] = t112;
            f_udg[54*ng+i] = t131-t2*t12*u3*u4-mu[i]*t4*t8*u4*u11+mu[i]*t4*t8*u3*u16*(2.0/3.0)-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t74-t88)+t2*u4*u11)-t7*t12*u4*u11);
            f_udg[55*ng+i] = 1.0;
            f_udg[56*ng+i] = t119;
            f_udg[57*ng+i] = t112;
            f_udg[58*ng+i] = -t132+t7*u4*2.0-mu[i]*t2*t8*u16*(4.0/3.0);
            f_udg[59*ng+i] = t121+t122-t2*t6*t12-mu[i]*t7*t8*t133-mu[i]*t4*t8*u2*u6-mu[i]*t4*t8*u3*u11-mu[i]*t4*t8*u4*u16*(4.0/3.0)-mu[i]*param1*t2*t8*t44*t45*(t12*u1*(u1*(t2*t21-t4*u4*u16)+t2*u4*u16)-t7*t12*u4*u16);
            f_udg[60*ng+i] = 0.0;
            f_udg[61*ng+i] = t12;
            f_udg[62*ng+i] = 0.0;
            f_udg[63*ng+i] = 0.0;
            f_udg[64*ng+i] = t135*u2-mu[i]*param1*t2*t8*t44*u6;
            f_udg[65*ng+i] = 0.0;
            f_udg[66*ng+i] = 0.0;
            f_udg[67*ng+i] = t12;
            f_udg[68*ng+i] = 0.0;
            f_udg[69*ng+i] = t135*u3-mu[i]*param1*t2*t8*t44*u11;
            f_udg[70*ng+i] = 0.0;
            f_udg[71*ng+i] = 0.0;
            f_udg[72*ng+i] = 0.0;
            f_udg[73*ng+i] = t12;
            f_udg[74*ng+i] = t135*u4-mu[i]*param1*t2*t8*t44*u16;
            f_udg[75*ng+i] = 0.0;
            f_udg[76*ng+i] = mu[i]*t2*t8*u2*(-4.0/3.0);
            f_udg[77*ng+i] = -mu[i]*t2*t8*u3;
            f_udg[78*ng+i] = -mu[i]*t2*t8*u4;
            f_udg[79*ng+i] = mu[i]*t3*t4*t8*(-4.0/3.0)-mu[i]*t4*t5*t8-mu[i]*t4*t6*t8-mu[i]*param1*t2*t8*t44*t45*t142;
            f_udg[80*ng+i] = 0.0;
            f_udg[81*ng+i] = -mu[i]*t2*t8*u3;
            f_udg[82*ng+i] = t136;
            f_udg[83*ng+i] = 0.0;
            f_udg[84*ng+i] = mu[i]*t4*t8*u2*u3*(-1.0/3.0);
            f_udg[85*ng+i] = 0.0;
            f_udg[86*ng+i] = -mu[i]*t2*t8*u4;
            f_udg[87*ng+i] = 0.0;
            f_udg[88*ng+i] = t136;
            f_udg[89*ng+i] = mu[i]*t4*t8*u2*u4*(-1.0/3.0);
            f_udg[90*ng+i] = 0.0;
            f_udg[91*ng+i] = t145;
            f_udg[92*ng+i] = 0.0;
            f_udg[93*ng+i] = 0.0;
            f_udg[94*ng+i] = mu[i]*t2*t8*u2*(4.0/3.0)-mu[i]*param1*t2*t8*t44*u2;
            f_udg[95*ng+i] = 0.0;
            f_udg[96*ng+i] = 0.0;
            f_udg[97*ng+i] = mu[i]*t7*t8*(-2.0/3.0);
            f_udg[98*ng+i] = 0.0;
            f_udg[99*ng+i] = mu[i]*t2*t8*u3*(-2.0/3.0);
            f_udg[100*ng+i] = 0.0;
            f_udg[101*ng+i] = 0.0;
            f_udg[102*ng+i] = 0.0;
            f_udg[103*ng+i] = mu[i]*t7*t8*(-2.0/3.0);
            f_udg[104*ng+i] = mu[i]*t2*t8*u4*(-2.0/3.0);
            f_udg[105*ng+i] = 0.0;
            f_udg[106*ng+i] = 0.0;
            f_udg[107*ng+i] = t137;
            f_udg[108*ng+i] = 0.0;
            f_udg[109*ng+i] = t150;
            f_udg[110*ng+i] = 0.0;
            f_udg[111*ng+i] = t137;
            f_udg[112*ng+i] = 0.0;
            f_udg[113*ng+i] = 0.0;
            f_udg[114*ng+i] = t138;
            f_udg[115*ng+i] = 0.0;
            f_udg[116*ng+i] = 0.0;
            f_udg[117*ng+i] = 0.0;
            f_udg[118*ng+i] = 0.0;
            f_udg[119*ng+i] = 0.0;
            f_udg[120*ng+i] = 0.0;
            f_udg[121*ng+i] = 0.0;
            f_udg[122*ng+i] = 0.0;
            f_udg[123*ng+i] = t137;
            f_udg[124*ng+i] = t146;
            f_udg[125*ng+i] = 0.0;
            f_udg[126*ng+i] = 0.0;
            f_udg[127*ng+i] = 0.0;
            f_udg[128*ng+i] = 0.0;
            f_udg[129*ng+i] = 0.0;
            f_udg[130*ng+i] = 0.0;
            f_udg[131*ng+i] = t137;
            f_udg[132*ng+i] = 0.0;
            f_udg[133*ng+i] = 0.0;
            f_udg[134*ng+i] = t138;
            f_udg[135*ng+i] = 0.0;
            f_udg[136*ng+i] = 0.0;
            f_udg[137*ng+i] = 0.0;
            f_udg[138*ng+i] = 0.0;
            f_udg[139*ng+i] = t147;
            f_udg[140*ng+i] = 0.0;
            f_udg[141*ng+i] = 0.0;
            f_udg[142*ng+i] = 0.0;
            f_udg[143*ng+i] = 0.0;
            f_udg[144*ng+i] = 0.0;
            f_udg[145*ng+i] = 0.0;
            f_udg[146*ng+i] = 0.0;
            f_udg[147*ng+i] = 0.0;
            f_udg[148*ng+i] = 0.0;
            f_udg[149*ng+i] = 0.0;
            f_udg[150*ng+i] = 0.0;
            f_udg[151*ng+i] = t143;
            f_udg[152*ng+i] = -t138;
            f_udg[153*ng+i] = 0.0;
            f_udg[154*ng+i] = mu[i]*t4*t8*u2*u3*(-1.0/3.0);
            f_udg[155*ng+i] = 0.0;
            f_udg[156*ng+i] = -t138;
            f_udg[157*ng+i] = mu[i]*t2*t8*u3*(-4.0/3.0);
            f_udg[158*ng+i] = -t139;
            f_udg[159*ng+i] = -mu[i]*t3*t4*t8-mu[i]*t4*t5*t8*(4.0/3.0)-mu[i]*t4*t6*t8-mu[i]*param1*t2*t8*t44*t45*t142;
            f_udg[160*ng+i] = 0.0;
            f_udg[161*ng+i] = 0.0;
            f_udg[162*ng+i] = -t139;
            f_udg[163*ng+i] = t143;
            f_udg[164*ng+i] = mu[i]*t4*t8*u3*u4*(-1.0/3.0);
            f_udg[165*ng+i] = 0.0;
            f_udg[166*ng+i] = 0.0;
            f_udg[167*ng+i] = t137;
            f_udg[168*ng+i] = 0.0;
            f_udg[169*ng+i] = t144;
            f_udg[170*ng+i] = 0.0;
            f_udg[171*ng+i] = t137;
            f_udg[172*ng+i] = 0.0;
            f_udg[173*ng+i] = 0.0;
            f_udg[174*ng+i] = t149;
            f_udg[175*ng+i] = 0.0;
            f_udg[176*ng+i] = 0.0;
            f_udg[177*ng+i] = 0.0;
            f_udg[178*ng+i] = 0.0;
            f_udg[179*ng+i] = 0.0;
            f_udg[180*ng+i] = 0.0;
            f_udg[181*ng+i] = mu[i]*t7*t8*(-2.0/3.0);
            f_udg[182*ng+i] = 0.0;
            f_udg[183*ng+i] = 0.0;
            f_udg[184*ng+i] = -t136;
            f_udg[185*ng+i] = 0.0;
            f_udg[186*ng+i] = 0.0;
            f_udg[187*ng+i] = t145;
            f_udg[188*ng+i] = 0.0;
            f_udg[189*ng+i] = mu[i]*t2*t8*u3*(4.0/3.0)-mu[i]*param1*t2*t8*t44*u3;
            f_udg[190*ng+i] = 0.0;
            f_udg[191*ng+i] = 0.0;
            f_udg[192*ng+i] = 0.0;
            f_udg[193*ng+i] = mu[i]*t7*t8*(-2.0/3.0);
            f_udg[194*ng+i] = mu[i]*t2*t8*u4*(-2.0/3.0);
            f_udg[195*ng+i] = 0.0;
            f_udg[196*ng+i] = 0.0;
            f_udg[197*ng+i] = 0.0;
            f_udg[198*ng+i] = 0.0;
            f_udg[199*ng+i] = 0.0;
            f_udg[200*ng+i] = 0.0;
            f_udg[201*ng+i] = 0.0;
            f_udg[202*ng+i] = 0.0;
            f_udg[203*ng+i] = t137;
            f_udg[204*ng+i] = t146;
            f_udg[205*ng+i] = 0.0;
            f_udg[206*ng+i] = 0.0;
            f_udg[207*ng+i] = t137;
            f_udg[208*ng+i] = 0.0;
            f_udg[209*ng+i] = t144;
            f_udg[210*ng+i] = 0.0;
            f_udg[211*ng+i] = 0.0;
            f_udg[212*ng+i] = 0.0;
            f_udg[213*ng+i] = 0.0;
            f_udg[214*ng+i] = 0.0;
            f_udg[215*ng+i] = 0.0;
            f_udg[216*ng+i] = 0.0;
            f_udg[217*ng+i] = 0.0;
            f_udg[218*ng+i] = 0.0;
            f_udg[219*ng+i] = t147;
            f_udg[220*ng+i] = 0.0;
            f_udg[221*ng+i] = 0.0;
            f_udg[222*ng+i] = 0.0;
            f_udg[223*ng+i] = 0.0;
            f_udg[224*ng+i] = 0.0;
            f_udg[225*ng+i] = 0.0;
            f_udg[226*ng+i] = t148;
            f_udg[227*ng+i] = 0.0;
            f_udg[228*ng+i] = -t138;
            f_udg[229*ng+i] = mu[i]*t4*t8*u2*u4*(-1.0/3.0);
            f_udg[230*ng+i] = 0.0;
            f_udg[231*ng+i] = 0.0;
            f_udg[232*ng+i] = t148;
            f_udg[233*ng+i] = -t144;
            f_udg[234*ng+i] = mu[i]*t4*t8*u3*u4*(-1.0/3.0);
            f_udg[235*ng+i] = 0.0;
            f_udg[236*ng+i] = -t138;
            f_udg[237*ng+i] = -t144;
            f_udg[238*ng+i] = mu[i]*t2*t8*u4*(-4.0/3.0);
            f_udg[239*ng+i] = -mu[i]*t3*t4*t8-mu[i]*t4*t5*t8-mu[i]*t4*t6*t8*(4.0/3.0)-mu[i]*param1*t2*t8*t44*t45*t142;
            f_udg[240*ng+i] = 0.0;
            f_udg[241*ng+i] = 0.0;
            f_udg[242*ng+i] = 0.0;
            f_udg[243*ng+i] = t137;
            f_udg[244*ng+i] = t139;
            f_udg[245*ng+i] = 0.0;
            f_udg[246*ng+i] = 0.0;
            f_udg[247*ng+i] = 0.0;
            f_udg[248*ng+i] = 0.0;
            f_udg[249*ng+i] = 0.0;
            f_udg[250*ng+i] = 0.0;
            f_udg[251*ng+i] = t137;
            f_udg[252*ng+i] = 0.0;
            f_udg[253*ng+i] = 0.0;
            f_udg[254*ng+i] = t149;
            f_udg[255*ng+i] = 0.0;
            f_udg[256*ng+i] = 0.0;
            f_udg[257*ng+i] = 0.0;
            f_udg[258*ng+i] = 0.0;
            f_udg[259*ng+i] = 0.0;
            f_udg[260*ng+i] = 0.0;
            f_udg[261*ng+i] = 0.0;
            f_udg[262*ng+i] = 0.0;
            f_udg[263*ng+i] = t137;
            f_udg[264*ng+i] = t139;
            f_udg[265*ng+i] = 0.0;
            f_udg[266*ng+i] = 0.0;
            f_udg[267*ng+i] = t137;
            f_udg[268*ng+i] = 0.0;
            f_udg[269*ng+i] = t150;
            f_udg[270*ng+i] = 0.0;
            f_udg[271*ng+i] = mu[i]*t7*t8*(-2.0/3.0);
            f_udg[272*ng+i] = 0.0;
            f_udg[273*ng+i] = 0.0;
            f_udg[274*ng+i] = -t136;
            f_udg[275*ng+i] = 0.0;
            f_udg[276*ng+i] = 0.0;
            f_udg[277*ng+i] = mu[i]*t7*t8*(-2.0/3.0);
            f_udg[278*ng+i] = 0.0;
            f_udg[279*ng+i] = -t143;
            f_udg[280*ng+i] = 0.0;
            f_udg[281*ng+i] = 0.0;
            f_udg[282*ng+i] = 0.0;
            f_udg[283*ng+i] = t145;
            f_udg[284*ng+i] = -t151+mu[i]*t2*t8*u4*(4.0/3.0);
            f_udg[285*ng+i] = 0.0;
            f_udg[286*ng+i] = 0.0;
            f_udg[287*ng+i] = 0.0;
            f_udg[288*ng+i] = 0.0;
            f_udg[289*ng+i] = 0.0;
            f_udg[290*ng+i] = 0.0;
            f_udg[291*ng+i] = 0.0;
            f_udg[292*ng+i] = 0.0;
            f_udg[293*ng+i] = 0.0;
            f_udg[294*ng+i] = 0.0;
            f_udg[295*ng+i] = 0.0;
            f_udg[296*ng+i] = 0.0;
            f_udg[297*ng+i] = 0.0;
            f_udg[298*ng+i] = 0.0;
            f_udg[299*ng+i] = t147;
        }

        if (app.viscosityModel != 0) {

            for (int i = 0; i <ng; i++) {
                double x1 = pg[0*ng+i];
                double x2 = pg[1*ng+i];
                double x3 = pg[2*ng+i];

                double u1 = udg[0*ng+i];
                double u2 = udg[1*ng+i];
                double u3 = udg[2*ng+i];
                double u4 = udg[3*ng+i];
                double u5 = udg[4*ng+i];
                double u6 = udg[5*ng+i];
                double u7 = udg[6*ng+i];
                double u8 = udg[7*ng+i];
                double u9 = udg[8*ng+i];
                double u10 = udg[9*ng+i];
                double u11 = udg[10*ng+i];
                double u12 = udg[11*ng+i];
                double u13 = udg[12*ng+i];
                double u14 = udg[13*ng+i];
                double u15 = udg[14*ng+i];
                double u16 = udg[15*ng+i];
                double u17 = udg[16*ng+i];
                double u18 = udg[17*ng+i];
                double u19 = udg[18*ng+i];
                double u20 = udg[19*ng+i];

                double t2 = 1.0/u1;
                double t3 = 1.0/param3;
                double t22 = t2*u3*u6;
                double t4 = -t22+u8;
                double t5 = t2*t4;
                double t32 = t2*u2*u11;
                double t6 = -t32+u12;
                double t7 = t2*t6;
                double t8 = t5+t7;
                double t23 = t2*u4*u6;
                double t9 = -t23+u9;
                double t10 = t2*t9;
                double t47 = t2*u2*u16;
                double t11 = -t47+u17;
                double t12 = t2*t11;
                double t13 = t10+t12;
                double t21 = t2*u2*u6;
                double t14 = -t21+u7;
                double t34 = t2*u3*u11;
                double t15 = -t34+u13;
                double t16 = t2*t15*(2.0/3.0);
                double t35 = t2*u4*u16;
                double t17 = -t35+u19;
                double t18 = t2*t17*(2.0/3.0);
                double t19 = t16+t18-t2*t14*(4.0/3.0);
                double t20 = 1.0/(u1*u1);
                double t24 = u2*u2;
                double t25 = t20*t24*(1.0/2.0);
                double t26 = u3*u3;
                double t27 = t20*t26*(1.0/2.0);
                double t28 = u4*u4;
                double t29 = t20*t28*(1.0/2.0);
                double t30 = t25+t27+t29;
                double t31 = param1-1.0;
                double t33 = t3*t8;
                double t44 = t2*u4*u11;
                double t36 = -t44+u14;
                double t37 = t2*t36;
                double t49 = t2*u3*u16;
                double t38 = -t49+u18;
                double t39 = t2*t38;
                double t40 = t37+t39;
                double t41 = t2*t14*(2.0/3.0);
                double t42 = t18+t41-t2*t15*(4.0/3.0);
                double t43 = 1.0/param4;
                double t52 = t30*u1;
                double t45 = -t52+u5;
                double t46 = 1.0/t31;
                double t48 = t3*t13;
                double t50 = t3*t40;
                double t51 = t16+t41-t2*t17*(4.0/3.0);

                f_mu[0*ng+i] = 0.0;
                f_mu[1*ng+i] = -t3*t19;
                f_mu[2*ng+i] = t33;
                f_mu[3*ng+i] = t48;
                f_mu[4*ng+i] = t2*t3*t8*u3+t2*t3*t13*u4-t2*t3*t19*u2-param1*t3*t20*t43*t46*(t31*u1*(-u10+t30*u6+u1*(t4*t20*u3+t9*t20*u4+t14*t20*u2))+t31*t45*u6);
                f_mu[5*ng+i] = 0.0;
                f_mu[6*ng+i] = t33;
                f_mu[7*ng+i] = -t3*t42;
                f_mu[8*ng+i] = t50;
                f_mu[9*ng+i] = t2*t3*t8*u2+t2*t3*t40*u4-t2*t3*t42*u3-param1*t3*t20*t43*t46*(t31*u1*(-u15+t30*u11+u1*(t6*t20*u2+t15*t20*u3+t20*t36*u4))+t31*t45*u11);
                f_mu[10*ng+i] = 0.0;
                f_mu[11*ng+i] = t48;
                f_mu[12*ng+i] = t50;
                f_mu[13*ng+i] = -t3*t51;
                f_mu[14*ng+i] = t2*t3*t13*u2+t2*t3*t40*u3-t2*t3*t51*u4-param1*t3*t20*t43*t46*(t31*u1*(-u20+t30*u16+u1*(t11*t20*u2+t17*t20*u4+t20*t38*u3))+t31*t45*u16);
            }

            chainRule_f_udg(f_udg, f_mu, mu_udg, ng, nc, ncu, nd);
        }
    }

//	for (int i = 0; i <ng; i++) {
//		double x1 = pg[0*ng+i];
//		double x2 = pg[1*ng+i];
//		double x3 = pg[2*ng+i];
//
//		double u1 = udg[0*ng+i];
//		double u2 = udg[1*ng+i];
//		double u3 = udg[2*ng+i];
//		double u4 = udg[3*ng+i];
//		double u5 = udg[4*ng+i];
//		double u6 = udg[5*ng+i];
//		double u7 = udg[6*ng+i];
//		double u8 = udg[7*ng+i];
//		double u9 = udg[8*ng+i];
//		double u10 = udg[9*ng+i];
//		double u11 = udg[10*ng+i];
//		double u12 = udg[11*ng+i];
//		double u13 = udg[12*ng+i];
//		double u14 = udg[13*ng+i];
//		double u15 = udg[14*ng+i];
//		double u16 = udg[15*ng+i];
//		double u17 = udg[16*ng+i];
//		double u18 = udg[17*ng+i];
//		double u19 = udg[18*ng+i];
//		double u20 = udg[19*ng+i];
//
//		double t2 = u2*u2;
//		double t3 = 1.0/(u1*u1);
//		double t4 = 1.0/u1;
//		double t5 = 1.0/param3;
//		double t6 = t2*t3*(1.0/2.0);
//		double t7 = u3*u3;
//		double t8 = t3*t7*(1.0/2.0);
//		double t9 = u4*u4;
//		double t10 = t3*t9*(1.0/2.0);
//		double t11 = t6+t8+t10;
//		double t33 = t11*u1;
//		double t12 = -t33+u5;
//		double t13 = param1-1.0;
//		double t31 = t4*u3*u6;
//		double t14 = -t31+u8;
//		double t15 = t4*t14;
//		double t35 = t4*u2*u11;
//		double t16 = -t35+u12;
//		double t17 = t4*t16;
//		double t18 = t15+t17;
//		double t32 = t4*u4*u6;
//		double t19 = -t32+u9;
//		double t20 = t4*t19;
//		double t55 = t4*u2*u16;
//		double t21 = -t55+u17;
//		double t22 = t4*t21;
//		double t23 = t20+t22;
//		double t30 = t4*u2*u6;
//		double t24 = -t30+u7;
//		double t39 = t4*u3*u11;
//		double t25 = -t39+u13;
//		double t26 = t4*t25*(2.0/3.0);
//		double t40 = t4*u4*u16;
//		double t27 = -t40+u19;
//		double t28 = t4*t27*(2.0/3.0);
//		double t29 = t26+t28-t4*t24*(4.0/3.0);
//		double t34 = t4*u2*u3;
//		double t36 = nu[i]*t5*t18*u1;
//		double t37 = t34+t36;
//		double t38 = t12*t13;
//		double t41 = t4*u5;
//		double t42 = t4*t12*t13;
//		double t43 = t41+t42;
//		double t52 = t4*u4*u11;
//		double t44 = -t52+u14;
//		double t45 = t4*t44;
//		double t59 = t4*u3*u16;
//		double t46 = -t59+u18;
//		double t47 = t4*t46;
//		double t48 = t45+t47;
//		double t49 = t4*t24*(2.0/3.0);
//		double t50 = t28+t49-t4*t25*(4.0/3.0);
//		double t51 = 1.0/param4;
//		double t53 = 1.0/t13;
//		double t54 = t4*u2*u4;
//		double t56 = nu[i]*t5*t23*u1;
//		double t57 = t54+t56;
//		double t58 = t4*u3*u4;
//		double t60 = nu[i]*t5*t48*u1;
//		double t61 = t58+t60;
//		double t62 = t26+t49-t4*t27*(4.0/3.0);
//
//		f[0*ng+i] = u2;
//		f[1*ng+i] = t38+t2*t4-nu[i]*t5*t29*u1;
//		f[2*ng+i] = t37;
//		f[3*ng+i] = t57;
//		f[4*ng+i] = t43*u2+nu[i]*t5*t18*u3+nu[i]*t5*t23*u4-nu[i]*t5*t29*u2-nu[i]*param1*t4*t5*t51*t53*(t13*u1*(-u10+t11*u6+u1*(t3*t14*u3+t3*t19*u4+t3*t24*u2))+t12*t13*u6);
//		f[5*ng+i] = u3;
//		f[6*ng+i] = t37;
//		f[7*ng+i] = t38+t4*t7-nu[i]*t5*t50*u1;
//		f[8*ng+i] = t61;
//		f[9*ng+i] = t43*u3+nu[i]*t5*t18*u2+nu[i]*t5*t48*u4-nu[i]*t5*t50*u3-nu[i]*param1*t4*t5*t51*t53*(t13*u1*(-u15+t11*u11+u1*(t3*t16*u2+t3*t25*u3+t3*t44*u4))+t12*t13*u11);
//		f[10*ng+i] = u4;
//		f[11*ng+i] = t57;
//		f[12*ng+i] = t61;
//		f[13*ng+i] = t38+t4*t9-nu[i]*t5*t62*u1;
//		f[14*ng+i] = t43*u4+nu[i]*t5*t23*u2+nu[i]*t5*t48*u3-nu[i]*t5*t62*u4-nu[i]*param1*t4*t5*t51*t53*(t13*u1*(-u20+t11*u16+u1*(t3*t21*u2+t3*t27*u4+t3*t46*u3))+t12*t13*u16);
//	}
//
//	if (computeJacobian == 1) {
//
//		for (int i = 0; i <ng; i++) {
//			double x1 = pg[0*ng+i];
//			double x2 = pg[1*ng+i];
//			double x3 = pg[2*ng+i];
//
//			double u1 = udg[0*ng+i];
//			double u2 = udg[1*ng+i];
//			double u3 = udg[2*ng+i];
//			double u4 = udg[3*ng+i];
//			double u5 = udg[4*ng+i];
//			double u6 = udg[5*ng+i];
//			double u7 = udg[6*ng+i];
//			double u8 = udg[7*ng+i];
//			double u9 = udg[8*ng+i];
//			double u10 = udg[9*ng+i];
//			double u11 = udg[10*ng+i];
//			double u12 = udg[11*ng+i];
//			double u13 = udg[12*ng+i];
//			double u14 = udg[13*ng+i];
//			double u15 = udg[14*ng+i];
//			double u16 = udg[15*ng+i];
//			double u17 = udg[16*ng+i];
//			double u18 = udg[17*ng+i];
//			double u19 = udg[18*ng+i];
//			double u20 = udg[19*ng+i];
//
//			double t2 = 1.0/(u1*u1);
//			double t3 = u2*u2;
//			double t4 = 1.0/(u1*u1*u1);
//			double t5 = u3*u3;
//			double t6 = u4*u4;
//			double t7 = 1.0/u1;
//			double t8 = 1.0/param3;
//			double t25 = t7*u2*u6;
//			double t9 = -t25+u7;
//			double t27 = t7*u3*u11;
//			double t10 = -t27+u13;
//			double t28 = t7*u4*u16;
//			double t11 = -t28+u19;
//			double t32 = t7*u3*u6;
//			double t12 = -t32+u8;
//			double t34 = t7*u2*u11;
//			double t13 = -t34+u12;
//			double t37 = t7*u4*u6;
//			double t14 = -t37+u9;
//			double t39 = t7*u2*u16;
//			double t15 = -t39+u17;
//			double t16 = t2*t3*(1.0/2.0);
//			double t17 = t2*t5*(1.0/2.0);
//			double t18 = t2*t6*(1.0/2.0);
//			double t19 = param1-1.0;
//			double t20 = t3*t4;
//			double t21 = t4*t5;
//			double t22 = t4*t6;
//			double t23 = t20+t21+t22;
//			double t53 = t23*u1;
//			double t24 = t16+t17+t18-t53;
//			double t26 = t2*t9*(4.0/3.0);
//			double t29 = t4*u3*u11*(2.0/3.0);
//			double t30 = t4*u4*u16*(2.0/3.0);
//			double t63 = t2*t11*(2.0/3.0);
//			double t103 = t2*t10*(2.0/3.0);
//			double t31 = t26+t29+t30-t63-t103-t4*u2*u6*(4.0/3.0);
//			double t33 = t2*t12;
//			double t35 = t2*t13;
//			double t59 = t4*u3*u6;
//			double t60 = t4*u2*u11;
//			double t36 = t33+t35-t59-t60;
//			double t38 = t2*t14;
//			double t40 = t2*t15;
//			double t90 = t4*u4*u6;
//			double t91 = t4*u2*u16;
//			double t41 = t38+t40-t90-t91;
//			double t42 = t16+t17+t18;
//			double t67 = t42*u1;
//			double t43 = -t67+u5;
//			double t44 = 1.0/param4;
//			double t45 = 1.0/t19;
//			double t46 = t2*t9*u2;
//			double t47 = t2*t12*u3;
//			double t48 = t2*t14*u4;
//			double t49 = t46+t47+t48;
//			double t50 = t49*u1;
//			double t51 = t42*u6;
//			double t52 = t50+t51-u10;
//			double t54 = 1.0/(u1*u1*u1*u1);
//			double t55 = t7*t12;
//			double t56 = t7*t13;
//			double t57 = t55+t56;
//			double t58 = nu[i]*t8*t57;
//			double t61 = t58-t2*u2*u3-nu[i]*t8*t36*u1;
//			double t62 = t7*t11*(2.0/3.0);
//			double t74 = t7*u4*u11;
//			double t64 = -t74+u14;
//			double t76 = t7*u3*u16;
//			double t65 = -t76+u18;
//			double t66 = t2*u5;
//			double t68 = t2*t19*t43;
//			double t69 = t7*t19*t24;
//			double t70 = t66+t68+t69;
//			double t71 = t2*t10*(4.0/3.0);
//			double t72 = t4*u2*u6*(2.0/3.0);
//			double t102 = t2*t9*(2.0/3.0);
//			double t73 = t30-t63+t71+t72-t102-t4*u3*u11*(4.0/3.0);
//			double t75 = t2*t64;
//			double t77 = t2*t65;
//			double t97 = t4*u4*u11;
//			double t98 = t4*u3*u16;
//			double t78 = t75+t77-t97-t98;
//			double t79 = t2*t13*u2;
//			double t80 = t2*t10*u3;
//			double t81 = t2*t64*u4;
//			double t82 = t79+t80+t81;
//			double t83 = t82*u1;
//			double t84 = t42*u11;
//			double t85 = t83+t84-u15;
//			double t86 = t7*t14;
//			double t87 = t7*t15;
//			double t88 = t86+t87;
//			double t89 = nu[i]*t8*t88;
//			double t92 = t89-t2*u2*u4-nu[i]*t8*t41*u1;
//			double t93 = t7*t64;
//			double t94 = t7*t65;
//			double t95 = t93+t94;
//			double t96 = nu[i]*t8*t95;
//			double t99 = t96-t2*u3*u4-nu[i]*t8*t78*u1;
//			double t100 = t7*t9*(2.0/3.0);
//			double t101 = t7*t10*(2.0/3.0);
//			double t104 = t2*t11*(4.0/3.0);
//			double t105 = t29+t72-t102-t103+t104-t4*u4*u16*(4.0/3.0);
//			double t106 = t2*t15*u2;
//			double t107 = t2*t65*u3;
//			double t108 = t2*t11*u4;
//			double t109 = t106+t107+t108;
//			double t110 = t109*u1;
//			double t111 = t42*u16;
//			double t112 = t110+t111-u20;
//			double t113 = t62+t101-t7*t9*(4.0/3.0);
//			double t114 = t7*u3;
//			double t131 = nu[i]*t7*t8*u11;
//			double t115 = t114-t131;
//			double t116 = t7*u4;
//			double t122 = nu[i]*t7*t8*u16;
//			double t117 = t116-t122;
//			double t118 = nu[i]*t7*t8*u6*(2.0/3.0);
//			double t119 = t118-t7*t19*u2;
//			double t120 = t7*u2;
//			double t128 = nu[i]*t7*t8*u6;
//			double t121 = t120-t128;
//			double t123 = t7*u5;
//			double t124 = t7*t19*t43;
//			double t125 = t62+t100-t7*t10*(4.0/3.0);
//			double t126 = nu[i]*t7*t8*u11*(2.0/3.0);
//			double t127 = t126-t7*t19*u3;
//			double t129 = nu[i]*t7*t8*u16*(2.0/3.0);
//			double t132 = t7*t19*u4;
//			double t130 = t129-t132;
//			double t133 = t100+t101-t7*t11*(4.0/3.0);
//			double t134 = t7*t19;
//			double t135 = t7+t134;
//			double t136 = nu[i]*t7*t8*u2*(2.0/3.0);
//			double t137 = nu[i]*t8;
//			double t138 = nu[i]*t7*t8*u2;
//			double t139 = nu[i]*t7*t8*u4;
//			double t140 = t19*t43;
//			double t141 = t19*t24*u1;
//			double t142 = t140+t141;
//			double t143 = nu[i]*t7*t8*u3*(2.0/3.0);
//			double t144 = nu[i]*t7*t8*u3;
//			double t145 = nu[i]*t8*(4.0/3.0);
//			double t151 = nu[i]*param1*t7*t8*t44*u4;
//			double t146 = t139-t151;
//			double t147 = nu[i]*param1*t8*t44;
//			double t148 = nu[i]*t7*t8*u4*(2.0/3.0);
//			double t149 = t138-nu[i]*param1*t7*t8*t44*u2;
//			double t150 = t144-nu[i]*param1*t7*t8*t44*u3;
//
//			f_udg[0*ng+i] = 0.0;
//			f_udg[1*ng+i] = -t2*t3-t19*t24-nu[i]*t8*t113-nu[i]*t8*t31*u1;
//			f_udg[2*ng+i] = t61;
//			f_udg[3*ng+i] = t92;
//			f_udg[4*ng+i] = -t70*u2-nu[i]*t8*t31*u2-nu[i]*t8*t36*u3-nu[i]*t8*t41*u4-nu[i]*param1*t7*t8*t44*t45*(t19*t52-t19*t24*u6+t19*u1*(t46+t47+t48-t23*u6-u1*(t4*t9*u2*2.0+t4*t12*u3*2.0+t4*t14*u4*2.0-t3*t54*u6-t5*t54*u6-t6*t54*u6)))+nu[i]*param1*t2*t8*t44*t45*(t19*t43*u6+t19*t52*u1);
//			f_udg[5*ng+i] = 0.0;
//			f_udg[6*ng+i] = t61;
//			f_udg[7*ng+i] = -t2*t5-t19*t24-nu[i]*t8*t125-nu[i]*t8*t73*u1;
//			f_udg[8*ng+i] = t99;
//			f_udg[9*ng+i] = -t70*u3-nu[i]*t8*t36*u2-nu[i]*t8*t73*u3-nu[i]*t8*t78*u4-nu[i]*param1*t7*t8*t44*t45*(t19*t85-t19*t24*u11+t19*u1*(t79+t80+t81-t23*u11-u1*(t4*t10*u3*2.0+t4*t13*u2*2.0-t3*t54*u11-t5*t54*u11-t6*t54*u11+t4*t64*u4*2.0)))+nu[i]*param1*t2*t8*t44*t45*(t19*t43*u11+t19*t85*u1);
//			f_udg[10*ng+i] = 0.0;
//			f_udg[11*ng+i] = t92;
//			f_udg[12*ng+i] = t99;
//			f_udg[13*ng+i] = -t2*t6-t19*t24-nu[i]*t8*t133-nu[i]*t8*t105*u1;
//			f_udg[14*ng+i] = -t70*u4-nu[i]*t8*t41*u2-nu[i]*t8*t78*u3-nu[i]*t8*t105*u4-nu[i]*param1*t7*t8*t44*t45*(t19*t112-t19*t24*u16+t19*u1*(t106+t107+t108-t23*u16-u1*(t4*t11*u4*2.0+t4*t15*u2*2.0+t4*t65*u3*2.0-t3*t54*u16-t5*t54*u16-t6*t54*u16)))+nu[i]*param1*t2*t8*t44*t45*(t19*t43*u16+t19*t112*u1);
//			f_udg[15*ng+i] = 1.0;
//			f_udg[16*ng+i] = t7*u2*2.0-t7*t19*u2-nu[i]*t7*t8*u6*(4.0/3.0);
//			f_udg[17*ng+i] = t115;
//			f_udg[18*ng+i] = t117;
//			f_udg[19*ng+i] = t123+t124-nu[i]*t8*t113-t2*t3*t19-nu[i]*t2*t8*u2*u6*(4.0/3.0)-nu[i]*t2*t8*u3*u11-nu[i]*t2*t8*u4*u16-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t2*t9-t4*u2*u6)+t2*u2*u6)-t7*t19*u2*u6);
//			f_udg[20*ng+i] = 0.0;
//			f_udg[21*ng+i] = t115;
//			f_udg[22*ng+i] = t119;
//			f_udg[23*ng+i] = 0.0;
//			f_udg[24*ng+i] = t58-t2*t19*u2*u3+nu[i]*t2*t8*u3*u6*(2.0/3.0)-nu[i]*t2*t8*u2*u11-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t35-t60)+t2*u2*u11)-t7*t19*u2*u11);
//			f_udg[25*ng+i] = 0.0;
//			f_udg[26*ng+i] = t117;
//			f_udg[27*ng+i] = 0.0;
//			f_udg[28*ng+i] = t119;
//			f_udg[29*ng+i] = t89-t2*t19*u2*u4+nu[i]*t2*t8*u4*u6*(2.0/3.0)-nu[i]*t2*t8*u2*u16-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t40-t91)+t2*u2*u16)-t7*t19*u2*u16);
//			f_udg[30*ng+i] = 0.0;
//			f_udg[31*ng+i] = t127;
//			f_udg[32*ng+i] = t121;
//			f_udg[33*ng+i] = 0.0;
//			f_udg[34*ng+i] = t58-t2*t19*u2*u3-nu[i]*t2*t8*u3*u6+nu[i]*t2*t8*u2*u11*(2.0/3.0)-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t33-t59)+t2*u3*u6)-t7*t19*u3*u6);
//			f_udg[35*ng+i] = 1.0;
//			f_udg[36*ng+i] = t121;
//			f_udg[37*ng+i] = t7*u3*2.0-t7*t19*u3-nu[i]*t7*t8*u11*(4.0/3.0);
//			f_udg[38*ng+i] = t117;
//			f_udg[39*ng+i] = t123+t124-nu[i]*t8*t125-t2*t5*t19-nu[i]*t2*t8*u2*u6-nu[i]*t2*t8*u3*u11*(4.0/3.0)-nu[i]*t2*t8*u4*u16-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t2*t10-t4*u3*u11)+t2*u3*u11)-t7*t19*u3*u11);
//			f_udg[40*ng+i] = 0.0;
//			f_udg[41*ng+i] = 0.0;
//			f_udg[42*ng+i] = t117;
//			f_udg[43*ng+i] = t127;
//			f_udg[44*ng+i] = t96-t2*t19*u3*u4+nu[i]*t2*t8*u4*u11*(2.0/3.0)-nu[i]*t2*t8*u3*u16-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t77-t98)+t2*u3*u16)-t7*t19*u3*u16);
//			f_udg[45*ng+i] = 0.0;
//			f_udg[46*ng+i] = t130;
//			f_udg[47*ng+i] = 0.0;
//			f_udg[48*ng+i] = t121;
//			f_udg[49*ng+i] = t89-t2*t19*u2*u4-nu[i]*t2*t8*u4*u6+nu[i]*t2*t8*u2*u16*(2.0/3.0)-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t38-t90)+t2*u4*u6)-t7*t19*u4*u6);
//			f_udg[50*ng+i] = 0.0;
//			f_udg[51*ng+i] = 0.0;
//			f_udg[52*ng+i] = t130;
//			f_udg[53*ng+i] = t115;
//			f_udg[54*ng+i] = t96-t2*t19*u3*u4-nu[i]*t2*t8*u4*u11+nu[i]*t2*t8*u3*u16*(2.0/3.0)-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t75-t97)+t2*u4*u11)-t7*t19*u4*u11);
//			f_udg[55*ng+i] = 1.0;
//			f_udg[56*ng+i] = t121;
//			f_udg[57*ng+i] = t115;
//			f_udg[58*ng+i] = -t132+t7*u4*2.0-nu[i]*t7*t8*u16*(4.0/3.0);
//			f_udg[59*ng+i] = t123+t124-nu[i]*t8*t133-t2*t6*t19-nu[i]*t2*t8*u2*u6-nu[i]*t2*t8*u3*u11-nu[i]*t2*t8*u4*u16*(4.0/3.0)-nu[i]*param1*t7*t8*t44*t45*(t19*u1*(u1*(t2*t11-t4*u4*u16)+t2*u4*u16)-t7*t19*u4*u16);
//			f_udg[60*ng+i] = 0.0;
//			f_udg[61*ng+i] = t19;
//			f_udg[62*ng+i] = 0.0;
//			f_udg[63*ng+i] = 0.0;
//			f_udg[64*ng+i] = t135*u2-nu[i]*param1*t7*t8*t44*u6;
//			f_udg[65*ng+i] = 0.0;
//			f_udg[66*ng+i] = 0.0;
//			f_udg[67*ng+i] = t19;
//			f_udg[68*ng+i] = 0.0;
//			f_udg[69*ng+i] = t135*u3-nu[i]*param1*t7*t8*t44*u11;
//			f_udg[70*ng+i] = 0.0;
//			f_udg[71*ng+i] = 0.0;
//			f_udg[72*ng+i] = 0.0;
//			f_udg[73*ng+i] = t19;
//			f_udg[74*ng+i] = t135*u4-nu[i]*param1*t7*t8*t44*u16;
//			f_udg[75*ng+i] = 0.0;
//			f_udg[76*ng+i] = nu[i]*t7*t8*u2*(-4.0/3.0);
//			f_udg[77*ng+i] = -nu[i]*t7*t8*u3;
//			f_udg[78*ng+i] = -nu[i]*t7*t8*u4;
//			f_udg[79*ng+i] = nu[i]*t2*t3*t8*(-4.0/3.0)-nu[i]*t2*t5*t8-nu[i]*t2*t6*t8-nu[i]*param1*t7*t8*t44*t45*t142;
//			f_udg[80*ng+i] = 0.0;
//			f_udg[81*ng+i] = -nu[i]*t7*t8*u3;
//			f_udg[82*ng+i] = t136;
//			f_udg[83*ng+i] = 0.0;
//			f_udg[84*ng+i] = nu[i]*t2*t8*u2*u3*(-1.0/3.0);
//			f_udg[85*ng+i] = 0.0;
//			f_udg[86*ng+i] = -nu[i]*t7*t8*u4;
//			f_udg[87*ng+i] = 0.0;
//			f_udg[88*ng+i] = t136;
//			f_udg[89*ng+i] = nu[i]*t2*t8*u2*u4*(-1.0/3.0);
//			f_udg[90*ng+i] = 0.0;
//			f_udg[91*ng+i] = t145;
//			f_udg[92*ng+i] = 0.0;
//			f_udg[93*ng+i] = 0.0;
//			f_udg[94*ng+i] = nu[i]*t7*t8*u2*(4.0/3.0)-nu[i]*param1*t7*t8*t44*u2;
//			f_udg[95*ng+i] = 0.0;
//			f_udg[96*ng+i] = 0.0;
//			f_udg[97*ng+i] = nu[i]*t8*(-2.0/3.0);
//			f_udg[98*ng+i] = 0.0;
//			f_udg[99*ng+i] = nu[i]*t7*t8*u3*(-2.0/3.0);
//			f_udg[100*ng+i] = 0.0;
//			f_udg[101*ng+i] = 0.0;
//			f_udg[102*ng+i] = 0.0;
//			f_udg[103*ng+i] = nu[i]*t8*(-2.0/3.0);
//			f_udg[104*ng+i] = nu[i]*t7*t8*u4*(-2.0/3.0);
//			f_udg[105*ng+i] = 0.0;
//			f_udg[106*ng+i] = 0.0;
//			f_udg[107*ng+i] = t137;
//			f_udg[108*ng+i] = 0.0;
//			f_udg[109*ng+i] = t150;
//			f_udg[110*ng+i] = 0.0;
//			f_udg[111*ng+i] = t137;
//			f_udg[112*ng+i] = 0.0;
//			f_udg[113*ng+i] = 0.0;
//			f_udg[114*ng+i] = t138;
//			f_udg[115*ng+i] = 0.0;
//			f_udg[116*ng+i] = 0.0;
//			f_udg[117*ng+i] = 0.0;
//			f_udg[118*ng+i] = 0.0;
//			f_udg[119*ng+i] = 0.0;
//			f_udg[120*ng+i] = 0.0;
//			f_udg[121*ng+i] = 0.0;
//			f_udg[122*ng+i] = 0.0;
//			f_udg[123*ng+i] = t137;
//			f_udg[124*ng+i] = t146;
//			f_udg[125*ng+i] = 0.0;
//			f_udg[126*ng+i] = 0.0;
//			f_udg[127*ng+i] = 0.0;
//			f_udg[128*ng+i] = 0.0;
//			f_udg[129*ng+i] = 0.0;
//			f_udg[130*ng+i] = 0.0;
//			f_udg[131*ng+i] = t137;
//			f_udg[132*ng+i] = 0.0;
//			f_udg[133*ng+i] = 0.0;
//			f_udg[134*ng+i] = t138;
//			f_udg[135*ng+i] = 0.0;
//			f_udg[136*ng+i] = 0.0;
//			f_udg[137*ng+i] = 0.0;
//			f_udg[138*ng+i] = 0.0;
//			f_udg[139*ng+i] = t147;
//			f_udg[140*ng+i] = 0.0;
//			f_udg[141*ng+i] = 0.0;
//			f_udg[142*ng+i] = 0.0;
//			f_udg[143*ng+i] = 0.0;
//			f_udg[144*ng+i] = 0.0;
//			f_udg[145*ng+i] = 0.0;
//			f_udg[146*ng+i] = 0.0;
//			f_udg[147*ng+i] = 0.0;
//			f_udg[148*ng+i] = 0.0;
//			f_udg[149*ng+i] = 0.0;
//			f_udg[150*ng+i] = 0.0;
//			f_udg[151*ng+i] = t143;
//			f_udg[152*ng+i] = -t138;
//			f_udg[153*ng+i] = 0.0;
//			f_udg[154*ng+i] = nu[i]*t2*t8*u2*u3*(-1.0/3.0);
//			f_udg[155*ng+i] = 0.0;
//			f_udg[156*ng+i] = -t138;
//			f_udg[157*ng+i] = nu[i]*t7*t8*u3*(-4.0/3.0);
//			f_udg[158*ng+i] = -t139;
//			f_udg[159*ng+i] = -nu[i]*t2*t3*t8-nu[i]*t2*t5*t8*(4.0/3.0)-nu[i]*t2*t6*t8-nu[i]*param1*t7*t8*t44*t45*t142;
//			f_udg[160*ng+i] = 0.0;
//			f_udg[161*ng+i] = 0.0;
//			f_udg[162*ng+i] = -t139;
//			f_udg[163*ng+i] = t143;
//			f_udg[164*ng+i] = nu[i]*t2*t8*u3*u4*(-1.0/3.0);
//			f_udg[165*ng+i] = 0.0;
//			f_udg[166*ng+i] = 0.0;
//			f_udg[167*ng+i] = t137;
//			f_udg[168*ng+i] = 0.0;
//			f_udg[169*ng+i] = t144;
//			f_udg[170*ng+i] = 0.0;
//			f_udg[171*ng+i] = t137;
//			f_udg[172*ng+i] = 0.0;
//			f_udg[173*ng+i] = 0.0;
//			f_udg[174*ng+i] = t149;
//			f_udg[175*ng+i] = 0.0;
//			f_udg[176*ng+i] = 0.0;
//			f_udg[177*ng+i] = 0.0;
//			f_udg[178*ng+i] = 0.0;
//			f_udg[179*ng+i] = 0.0;
//			f_udg[180*ng+i] = 0.0;
//			f_udg[181*ng+i] = nu[i]*t8*(-2.0/3.0);
//			f_udg[182*ng+i] = 0.0;
//			f_udg[183*ng+i] = 0.0;
//			f_udg[184*ng+i] = -t136;
//			f_udg[185*ng+i] = 0.0;
//			f_udg[186*ng+i] = 0.0;
//			f_udg[187*ng+i] = t145;
//			f_udg[188*ng+i] = 0.0;
//			f_udg[189*ng+i] = nu[i]*t7*t8*u3*(4.0/3.0)-nu[i]*param1*t7*t8*t44*u3;
//			f_udg[190*ng+i] = 0.0;
//			f_udg[191*ng+i] = 0.0;
//			f_udg[192*ng+i] = 0.0;
//			f_udg[193*ng+i] = nu[i]*t8*(-2.0/3.0);
//			f_udg[194*ng+i] = nu[i]*t7*t8*u4*(-2.0/3.0);
//			f_udg[195*ng+i] = 0.0;
//			f_udg[196*ng+i] = 0.0;
//			f_udg[197*ng+i] = 0.0;
//			f_udg[198*ng+i] = 0.0;
//			f_udg[199*ng+i] = 0.0;
//			f_udg[200*ng+i] = 0.0;
//			f_udg[201*ng+i] = 0.0;
//			f_udg[202*ng+i] = 0.0;
//			f_udg[203*ng+i] = t137;
//			f_udg[204*ng+i] = t146;
//			f_udg[205*ng+i] = 0.0;
//			f_udg[206*ng+i] = 0.0;
//			f_udg[207*ng+i] = t137;
//			f_udg[208*ng+i] = 0.0;
//			f_udg[209*ng+i] = t144;
//			f_udg[210*ng+i] = 0.0;
//			f_udg[211*ng+i] = 0.0;
//			f_udg[212*ng+i] = 0.0;
//			f_udg[213*ng+i] = 0.0;
//			f_udg[214*ng+i] = 0.0;
//			f_udg[215*ng+i] = 0.0;
//			f_udg[216*ng+i] = 0.0;
//			f_udg[217*ng+i] = 0.0;
//			f_udg[218*ng+i] = 0.0;
//			f_udg[219*ng+i] = t147;
//			f_udg[220*ng+i] = 0.0;
//			f_udg[221*ng+i] = 0.0;
//			f_udg[222*ng+i] = 0.0;
//			f_udg[223*ng+i] = 0.0;
//			f_udg[224*ng+i] = 0.0;
//			f_udg[225*ng+i] = 0.0;
//			f_udg[226*ng+i] = t148;
//			f_udg[227*ng+i] = 0.0;
//			f_udg[228*ng+i] = -t138;
//			f_udg[229*ng+i] = nu[i]*t2*t8*u2*u4*(-1.0/3.0);
//			f_udg[230*ng+i] = 0.0;
//			f_udg[231*ng+i] = 0.0;
//			f_udg[232*ng+i] = t148;
//			f_udg[233*ng+i] = -t144;
//			f_udg[234*ng+i] = nu[i]*t2*t8*u3*u4*(-1.0/3.0);
//			f_udg[235*ng+i] = 0.0;
//			f_udg[236*ng+i] = -t138;
//			f_udg[237*ng+i] = -t144;
//			f_udg[238*ng+i] = nu[i]*t7*t8*u4*(-4.0/3.0);
//			f_udg[239*ng+i] = -nu[i]*t2*t3*t8-nu[i]*t2*t5*t8-nu[i]*t2*t6*t8*(4.0/3.0)-nu[i]*param1*t7*t8*t44*t45*t142;
//			f_udg[240*ng+i] = 0.0;
//			f_udg[241*ng+i] = 0.0;
//			f_udg[242*ng+i] = 0.0;
//			f_udg[243*ng+i] = t137;
//			f_udg[244*ng+i] = t139;
//			f_udg[245*ng+i] = 0.0;
//			f_udg[246*ng+i] = 0.0;
//			f_udg[247*ng+i] = 0.0;
//			f_udg[248*ng+i] = 0.0;
//			f_udg[249*ng+i] = 0.0;
//			f_udg[250*ng+i] = 0.0;
//			f_udg[251*ng+i] = t137;
//			f_udg[252*ng+i] = 0.0;
//			f_udg[253*ng+i] = 0.0;
//			f_udg[254*ng+i] = t149;
//			f_udg[255*ng+i] = 0.0;
//			f_udg[256*ng+i] = 0.0;
//			f_udg[257*ng+i] = 0.0;
//			f_udg[258*ng+i] = 0.0;
//			f_udg[259*ng+i] = 0.0;
//			f_udg[260*ng+i] = 0.0;
//			f_udg[261*ng+i] = 0.0;
//			f_udg[262*ng+i] = 0.0;
//			f_udg[263*ng+i] = t137;
//			f_udg[264*ng+i] = t139;
//			f_udg[265*ng+i] = 0.0;
//			f_udg[266*ng+i] = 0.0;
//			f_udg[267*ng+i] = t137;
//			f_udg[268*ng+i] = 0.0;
//			f_udg[269*ng+i] = t150;
//			f_udg[270*ng+i] = 0.0;
//			f_udg[271*ng+i] = nu[i]*t8*(-2.0/3.0);
//			f_udg[272*ng+i] = 0.0;
//			f_udg[273*ng+i] = 0.0;
//			f_udg[274*ng+i] = -t136;
//			f_udg[275*ng+i] = 0.0;
//			f_udg[276*ng+i] = 0.0;
//			f_udg[277*ng+i] = nu[i]*t8*(-2.0/3.0);
//			f_udg[278*ng+i] = 0.0;
//			f_udg[279*ng+i] = -t143;
//			f_udg[280*ng+i] = 0.0;
//			f_udg[281*ng+i] = 0.0;
//			f_udg[282*ng+i] = 0.0;
//			f_udg[283*ng+i] = t145;
//			f_udg[284*ng+i] = -t151+nu[i]*t7*t8*u4*(4.0/3.0);
//			f_udg[285*ng+i] = 0.0;
//			f_udg[286*ng+i] = 0.0;
//			f_udg[287*ng+i] = 0.0;
//			f_udg[288*ng+i] = 0.0;
//			f_udg[289*ng+i] = 0.0;
//			f_udg[290*ng+i] = 0.0;
//			f_udg[291*ng+i] = 0.0;
//			f_udg[292*ng+i] = 0.0;
//			f_udg[293*ng+i] = 0.0;
//			f_udg[294*ng+i] = 0.0;
//			f_udg[295*ng+i] = 0.0;
//			f_udg[296*ng+i] = 0.0;
//			f_udg[297*ng+i] = 0.0;
//			f_udg[298*ng+i] = 0.0;
//			f_udg[299*ng+i] = t147;
//		}
//
//		if (app.viscosityModel != 0) {
//
//			for (int i = 0; i <ng; i++) {
//				double x1 = pg[0*ng+i];
//				double x2 = pg[1*ng+i];
//				double x3 = pg[2*ng+i];
//
//				double u1 = udg[0*ng+i];
//				double u2 = udg[1*ng+i];
//				double u3 = udg[2*ng+i];
//				double u4 = udg[3*ng+i];
//				double u5 = udg[4*ng+i];
//				double u6 = udg[5*ng+i];
//				double u7 = udg[6*ng+i];
//				double u8 = udg[7*ng+i];
//				double u9 = udg[8*ng+i];
//				double u10 = udg[9*ng+i];
//				double u11 = udg[10*ng+i];
//				double u12 = udg[11*ng+i];
//				double u13 = udg[12*ng+i];
//				double u14 = udg[13*ng+i];
//				double u15 = udg[14*ng+i];
//				double u16 = udg[15*ng+i];
//				double u17 = udg[16*ng+i];
//				double u18 = udg[17*ng+i];
//				double u19 = udg[18*ng+i];
//				double u20 = udg[19*ng+i];
//
//				double t2 = 1.0/u1;
//				double t3 = 1.0/param3;
//				double t22 = t2*u3*u6;
//				double t4 = -t22+u8;
//				double t5 = t2*t4;
//				double t32 = t2*u2*u11;
//				double t6 = -t32+u12;
//				double t7 = t2*t6;
//				double t8 = t5+t7;
//				double t23 = t2*u4*u6;
//				double t9 = -t23+u9;
//				double t10 = t2*t9;
//				double t47 = t2*u2*u16;
//				double t11 = -t47+u17;
//				double t12 = t2*t11;
//				double t13 = t10+t12;
//				double t20 = t2*u2*u6;
//				double t14 = -t20+u7;
//				double t34 = t2*u3*u11;
//				double t15 = -t34+u13;
//				double t16 = t2*t15*(2.0/3.0);
//				double t35 = t2*u4*u16;
//				double t17 = -t35+u19;
//				double t18 = t2*t17*(2.0/3.0);
//				double t19 = t16+t18-t2*t14*(4.0/3.0);
//				double t21 = 1.0/(u1*u1);
//				double t24 = u2*u2;
//				double t25 = t21*t24*(1.0/2.0);
//				double t26 = u3*u3;
//				double t27 = t21*t26*(1.0/2.0);
//				double t28 = u4*u4;
//				double t29 = t21*t28*(1.0/2.0);
//				double t30 = t25+t27+t29;
//				double t31 = param1-1.0;
//				double t33 = t3*t8*u1;
//				double t44 = t2*u4*u11;
//				double t36 = -t44+u14;
//				double t37 = t2*t36;
//				double t49 = t2*u3*u16;
//				double t38 = -t49+u18;
//				double t39 = t2*t38;
//				double t40 = t37+t39;
//				double t41 = t2*t14*(2.0/3.0);
//				double t42 = t18+t41-t2*t15*(4.0/3.0);
//				double t43 = 1.0/param4;
//				double t52 = t30*u1;
//				double t45 = -t52+u5;
//				double t46 = 1.0/t31;
//				double t48 = t3*t13*u1;
//				double t50 = t3*t40*u1;
//				double t51 = t16+t41-t2*t17*(4.0/3.0);
//
//				f_nu[0*ng+i] = 0.0;
//				f_nu[1*ng+i] = -t3*t19*u1;
//				f_nu[2*ng+i] = t33;
//				f_nu[3*ng+i] = t48;
//				f_nu[4*ng+i] = t3*t8*u3+t3*t13*u4-t3*t19*u2-param1*t2*t3*t43*t46*(t31*u1*(-u10+t30*u6+u1*(t4*t21*u3+t9*t21*u4+t14*t21*u2))+t31*t45*u6);
//				f_nu[5*ng+i] = 0.0;
//				f_nu[6*ng+i] = t33;
//				f_nu[7*ng+i] = -t3*t42*u1;
//				f_nu[8*ng+i] = t50;
//				f_nu[9*ng+i] = t3*t8*u2+t3*t40*u4-t3*t42*u3-param1*t2*t3*t43*t46*(t31*u1*(-u15+t30*u11+u1*(t6*t21*u2+t15*t21*u3+t21*t36*u4))+t31*t45*u11);
//				f_nu[10*ng+i] = 0.0;
//				f_nu[11*ng+i] = t48;
//				f_nu[12*ng+i] = t50;
//				f_nu[13*ng+i] = -t3*t51*u1;
//				f_nu[14*ng+i] = t3*t13*u2+t3*t40*u3-t3*t51*u4-param1*t2*t3*t43*t46*(t31*u1*(-u20+t30*u16+u1*(t11*t21*u2+t17*t21*u4+t21*t38*u3))+t31*t45*u16);
//			}
//
//			chainRule_f_udg(f_udg, f_nu, nu_udg, ng, nc, ncu, nd);
//		}
//	}

	/* Deallocate dynamic memory */
	delete[] mu;
	if (computeJacobian == 1 && app.viscosityModel != 0) {
		delete[] mu_udg;
		delete[] f_mu;
	}
}
