function [fh,fh_udg,fh_uh] = fhat3d(nl,pg,udg,uh,param,time)
%FHAT3D
%    [FH,FH_UDG,FH_UH] = FHAT3D(NL,PG,UDG,UH,PARAM,TIME)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    06-Nov-2012 11:00:48
[ng,nc] = size(udg);
nch = 5;
nd = 3;
nl1 = nl(:,1);
nl2 = nl(:,2);
nl3 = nl(:,3);
one = ones(ng,1);
param1 = param{1};
param3 = param{3};
param4 = param{4};
param6 = param{6};
u1 = udg(:,1);
u2 = udg(:,2);
u3 = udg(:,3);
u4 = udg(:,4);
u5 = udg(:,5);
u6 = udg(:,6);
u7 = udg(:,7);
u8 = udg(:,8);
u9 = udg(:,9);
u10 = udg(:,10);
u11 = udg(:,11);
u12 = udg(:,12);
u13 = udg(:,13);
u14 = udg(:,14);
u15 = udg(:,15);
u16 = udg(:,16);
u17 = udg(:,17);
u18 = udg(:,18);
u19 = udg(:,19);
u20 = udg(:,20);
uh1 = uh(:,1);
uh2 = uh(:,2);
uh3 = uh(:,3);
uh4 = uh(:,4);
uh5 = uh(:,5);
zero = zeros(ng,1);
t2 = uh2.^2;
t3 = uh3.^2;
t4 = uh4.^2;
t5 = 1.0./uh1;
t6 = 1.0./param3;
t7 = 1.0./uh1.^2;
t8 = uh1.^2;
t9 = 1.0./uh1.^3;
t10 = one.*param6;
t11 = nl1.*t3;
t12 = nl1.*t4;
t13 = 1.0./param4;
t14 = nl1.*one.*t5.*t6;
t15 = nl3.*uh4.*3.0;
t16 = nl2.*t2;
t17 = nl2.*t4;
t18 = nl2.*one.*t5.*t6;
t19 = nl1.*uh1.*uh3;
t20 = nl2.*uh1.*uh2;
t21 = t19+t20;
t22 = t6.*t9.*t21;
t23 = nl3.*uh1.*uh4.*(2.0./3.0);
t24 = nl3.*one.*t5.*t6;
t25 = nl1.*uh2.*3.0;
t26 = nl2.*uh3.*3.0;
t27 = nl3.*t2;
t28 = nl3.*t3;
t29 = nl1.*uh1.*uh4;
t30 = nl3.*uh1.*uh2;
t31 = t29+t30;
t32 = t6.*t9.*t31;
t33 = nl2.*uh1.*uh4;
t34 = nl3.*uh1.*uh3;
t35 = t33+t34;
t36 = t6.*t9.*t35;
t37 = nl1.*uh1.*uh2.*(2.0./3.0);
t38 = nl2.*uh1.*uh3.*(2.0./3.0);
t39 = nl1.*t2.*3.0;
t40 = nl1.*param1.*t2;
t41 = nl1.*param1.*t3;
t42 = nl1.*param1.*t4;
t43 = nl2.*uh2.*uh3.*2.0;
t44 = nl3.*uh2.*uh4.*2.0;
t45 = param6.*u2.*uh1.*2.0;
t46 = nl1.*param1.*uh1.*uh5.*2.0;
t47 = nl1.*u6.*uh2.*4.0;
t48 = nl2.*u6.*uh3.*3.0;
t49 = nl3.*u6.*uh4.*3.0;
t50 = nl1.*u13.*uh1.*2.0;
t51 = nl2.*u11.*uh2.*3.0;
t52 = nl1.*u19.*uh1.*2.0;
t53 = nl3.*u16.*uh2.*3.0;
t54 = t47+t48+t49+t50+t51+t52+t53-nl1.*u7.*uh1.*4.0-nl2.*u8.*uh1.*3.0-nl3.*u9.*uh1.*3.0-nl1.*u11.*uh3.*2.0-nl2.*u12.*uh1.*3.0-nl1.*u16.*uh4.*2.0-nl3.*u17.*uh1.*3.0;
t55 = nl2.*t3.*3.0;
t56 = nl2.*param1.*t2;
t57 = nl2.*param1.*t3;
t58 = nl2.*param1.*t4;
t59 = nl1.*uh2.*uh3.*2.0;
t60 = nl3.*uh3.*uh4.*2.0;
t61 = param6.*u3.*uh1.*2.0;
t62 = nl2.*param1.*uh1.*uh5.*2.0;
t63 = nl1.*u6.*uh3.*3.0;
t64 = nl2.*u7.*uh1.*2.0;
t65 = nl1.*u11.*uh2.*3.0;
t66 = nl2.*u11.*uh3.*4.0;
t67 = nl3.*u11.*uh4.*3.0;
t68 = nl2.*u19.*uh1.*2.0;
t69 = nl3.*u16.*uh3.*3.0;
t70 = t63+t64+t65+t66+t67+t68+t69-nl1.*u8.*uh1.*3.0-nl2.*u6.*uh2.*2.0-nl1.*u12.*uh1.*3.0-nl2.*u13.*uh1.*4.0-nl3.*u14.*uh1.*3.0-nl2.*u16.*uh4.*2.0-nl3.*u18.*uh1.*3.0;
t71 = nl3.*t4.*3.0;
t72 = nl3.*param1.*t2;
t73 = nl3.*param1.*t3;
t74 = nl3.*param1.*t4;
t75 = nl1.*uh2.*uh4.*2.0;
t76 = nl2.*uh3.*uh4.*2.0;
t77 = param6.*u4.*uh1.*2.0;
t78 = nl3.*param1.*uh1.*uh5.*2.0;
t79 = nl1.*u6.*uh4.*3.0;
t80 = nl3.*u7.*uh1.*2.0;
t81 = nl2.*u11.*uh4.*3.0;
t82 = nl3.*u13.*uh1.*2.0;
t83 = nl1.*u16.*uh2.*3.0;
t84 = nl2.*u16.*uh3.*3.0;
t85 = nl3.*u16.*uh4.*4.0;
t86 = t79+t80+t81+t82+t83+t84+t85-nl1.*u9.*uh1.*3.0-nl3.*u6.*uh2.*2.0-nl2.*u14.*uh1.*3.0-nl3.*u11.*uh3.*2.0-nl1.*u17.*uh1.*3.0-nl2.*u18.*uh1.*3.0-nl3.*u19.*uh1.*4.0;
t87 = nl1.*t2.*u6.*(4.0./3.0);
t88 = nl1.*t3.*u6;
t89 = nl1.*t4.*u6;
t90 = nl2.*t2.*u11;
t91 = nl2.*t3.*u11.*(4.0./3.0);
t92 = nl2.*t4.*u11;
t93 = nl3.*t2.*u16;
t94 = nl3.*t3.*u16;
t95 = nl3.*t4.*u16.*(4.0./3.0);
t96 = nl2.*u6.*uh2.*uh3.*(1.0./3.0);
t97 = nl2.*u7.*uh1.*uh3.*(2.0./3.0);
t98 = nl3.*u6.*uh2.*uh4.*(1.0./3.0);
t99 = nl3.*u7.*uh1.*uh4.*(2.0./3.0);
t100 = nl1.*u11.*uh2.*uh3.*(1.0./3.0);
t101 = nl1.*u13.*uh1.*uh2.*(2.0./3.0);
t102 = nl3.*u11.*uh3.*uh4.*(1.0./3.0);
t103 = nl3.*u13.*uh1.*uh4.*(2.0./3.0);
t104 = nl1.*u16.*uh2.*uh4.*(1.0./3.0);
t105 = nl1.*u19.*uh1.*uh2.*(2.0./3.0);
t106 = nl2.*u16.*uh3.*uh4.*(1.0./3.0);
t107 = nl2.*u19.*uh1.*uh3.*(2.0./3.0);
t108 = param3.*param6.*t8.*uh1.*uh5;
t109 = nl1.*param1.*param3.*t2.*uh1.*uh2.*(1.0./2.0);
t110 = nl2.*param1.*param3.*t3.*uh1.*uh3.*(1.0./2.0);
t111 = nl3.*param1.*param3.*t4.*uh1.*uh4.*(1.0./2.0);
t112 = nl1.*param1.*param3.*t3.*uh1.*uh2.*(1.0./2.0);
t113 = nl1.*param1.*param3.*t4.*uh1.*uh2.*(1.0./2.0);
t114 = nl2.*param1.*param3.*t2.*uh1.*uh3.*(1.0./2.0);
t115 = nl2.*param1.*param3.*t4.*uh1.*uh3.*(1.0./2.0);
t116 = nl3.*param1.*param3.*t2.*uh1.*uh4.*(1.0./2.0);
t117 = nl3.*param1.*param3.*t3.*uh1.*uh4.*(1.0./2.0);
t118 = t87+t88+t89+t90+t91+t92+t93+t94+t95+t96+t97+t98+t99+t100+t101+t102+t103+t104+t105+t106+t107+t108+t109+t110+t111+t112+t113+t114+t115+t116+t117-nl1.*u7.*uh1.*uh2.*(4.0./3.0)-nl1.*u8.*uh1.*uh3-nl2.*u8.*uh1.*uh2-nl1.*u9.*uh1.*uh4-nl3.*u9.*uh1.*uh2-nl1.*u12.*uh1.*uh3-nl2.*u12.*uh1.*uh2-nl2.*u13.*uh1.*uh3.*(4.0./3.0)-nl2.*u14.*uh1.*uh4-nl3.*u14.*uh1.*uh3-nl1.*u17.*uh1.*uh4-nl3.*u17.*uh1.*uh2-nl2.*u18.*uh1.*uh4-nl3.*u18.*uh1.*uh3-nl3.*u19.*uh1.*uh4.*(4.0./3.0)-nl1.*param3.*t2.*uh1.*uh2.*(1.0./2.0)-nl1.*param3.*t3.*uh1.*uh2.*(1.0./2.0)-nl1.*param3.*t4.*uh1.*uh2.*(1.0./2.0)-nl2.*param3.*t2.*uh1.*uh3.*(1.0./2.0)-nl2.*param3.*t3.*uh1.*uh3.*(1.0./2.0)-nl2.*param3.*t4.*uh1.*uh3.*(1.0./2.0)-nl3.*param3.*t2.*uh1.*uh4.*(1.0./2.0)-nl3.*param3.*t3.*uh1.*uh4.*(1.0./2.0)-nl3.*param3.*t4.*uh1.*uh4.*(1.0./2.0)-param3.*param6.*t8.*u5.*uh1-nl1.*param1.*param3.*t8.*uh2.*uh5-nl2.*param1.*param3.*t8.*uh3.*uh5-nl3.*param1.*param3.*t8.*uh4.*uh5;
t119 = 1.0./uh1.^4;
t120 = nl1.*param1.*t2.*u6;
t121 = nl1.*param1.*t3.*u6;
t122 = nl1.*param1.*t4.*u6;
t123 = nl1.*param1.*t8.*u10;
t124 = nl2.*param1.*t2.*u11;
t125 = nl2.*param1.*t3.*u11;
t126 = nl2.*param1.*t4.*u11;
t127 = nl2.*param1.*t8.*u15;
t128 = nl3.*param1.*t2.*u16;
t129 = nl3.*param1.*t3.*u16;
t130 = nl3.*param1.*t4.*u16;
t131 = nl3.*param1.*t8.*u20;
t132 = t120+t121+t122+t123+t124+t125+t126+t127+t128+t129+t130+t131-nl1.*param1.*u7.*uh1.*uh2-nl1.*param1.*u6.*uh1.*uh5-nl1.*param1.*u8.*uh1.*uh3-nl1.*param1.*u9.*uh1.*uh4-nl2.*param1.*u12.*uh1.*uh2-nl2.*param1.*u11.*uh1.*uh5-nl2.*param1.*u13.*uh1.*uh3-nl2.*param1.*u14.*uh1.*uh4-nl3.*param1.*u17.*uh1.*uh2-nl3.*param1.*u16.*uh1.*uh5-nl3.*param1.*u18.*uh1.*uh3-nl3.*param1.*u19.*uh1.*uh4;
fh = [nl1.*uh2+nl2.*uh3+nl3.*uh4+param6.*(u1-uh1);t5.*(t11+t12+t39+t43+t44+t45+t46-nl1.*param1.*t2-nl1.*param1.*t3-nl1.*param1.*t4-nl1.*uh1.*uh5.*2.0-param6.*uh1.*uh2.*2.0).*(1.0./2.0)-t6.*t7.*t54.*(1.0./3.0);t5.*(t16+t17+t55+t59+t60+t61+t62-nl2.*param1.*t2-nl2.*param1.*t3-nl2.*param1.*t4-nl2.*uh1.*uh5.*2.0-param6.*uh1.*uh3.*2.0).*(1.0./2.0)-t6.*t7.*t70.*(1.0./3.0);t5.*(t27+t28+t71+t75+t76+t77+t78-nl3.*param1.*t2-nl3.*param1.*t3-nl3.*param1.*t4-nl3.*uh1.*uh5.*2.0-param6.*uh1.*uh4.*2.0).*(1.0./2.0)-t6.*t7.*t86.*(1.0./3.0);-t6.*t9.*t118+t6.*t9.*t13.*t132];
if nargout > 1
    t133 = nl1.*uh3.*2.0;
    t134 = nl1.*uh4.*2.0;
    t135 = nl2.*uh2.*2.0;
    t136 = nl3.*uh4.*2.0;
    t137 = nl3.*u16.*3.0;
    t138 = nl2.*uh4.*2.0;
    fh_udg = [t10;zero;zero;zero;zero;zero;t10;zero;zero;zero;zero;zero;t10;zero;zero;zero;zero;zero;t10;zero;zero;zero;zero;zero;t10;zero;one.*t6.*t7.*(t15+t26+nl1.*uh2.*4.0).*(-1.0./3.0);one.*t6.*t7.*(nl1.*uh3.*3.0-nl2.*uh2.*2.0).*(-1.0./3.0);one.*t6.*t7.*(nl1.*uh4.*3.0-nl3.*uh2.*2.0).*(-1.0./3.0);-one.*(t6.*t9.*(t11+t12+nl1.*t2.*(4.0./3.0)+nl2.*uh2.*uh3.*(1.0./3.0)+nl3.*uh2.*uh4.*(1.0./3.0))-t6.*t9.*t13.*(t40+t41+t42-nl1.*param1.*uh1.*uh5));zero;nl1.*one.*t5.*t6.*(4.0./3.0);nl2.*one.*t5.*t6.*(-2.0./3.0);nl3.*one.*t5.*t6.*(-2.0./3.0);-one.*(t6.*t9.*(t23+t38-nl1.*uh1.*uh2.*(4.0./3.0))+nl1.*param1.*t6.*t7.*t13.*uh2);zero;t18;t14;zero;one.*(t22-nl1.*param1.*t6.*t7.*t13.*uh3);zero;t24;zero;t14;one.*(t32-nl1.*param1.*t6.*t7.*t13.*uh4);zero;zero;zero;zero;nl1.*one.*param1.*t5.*t6.*t13;zero;one.*t6.*t7.*(t133-nl2.*uh2.*3.0).*(1.0./3.0);one.*t6.*t7.*(t15+t25+nl2.*uh3.*4.0).*(-1.0./3.0);one.*t6.*t7.*(nl2.*uh4.*3.0-nl3.*uh3.*2.0).*(-1.0./3.0);-one.*(t6.*t9.*(t16+t17+nl2.*t3.*(4.0./3.0)+nl1.*uh2.*uh3.*(1.0./3.0)+nl3.*uh3.*uh4.*(1.0./3.0))-t6.*t9.*t13.*(t56+t57+t58-nl2.*param1.*uh1.*uh5));zero;t18;t14;zero;one.*(t22-nl2.*param1.*t6.*t7.*t13.*uh2);zero;nl1.*one.*t5.*t6.*(-2.0./3.0);nl2.*one.*t5.*t6.*(4.0./3.0);nl3.*one.*t5.*t6.*(-2.0./3.0);-one.*(t6.*t9.*(t23+t37-nl2.*uh1.*uh3.*(4.0./3.0))+nl2.*param1.*t6.*t7.*t13.*uh3);zero;zero;t24;t18;one.*(t36-nl2.*param1.*t6.*t7.*t13.*uh4);zero;zero;zero;zero;nl2.*one.*param1.*t5.*t6.*t13;zero;one.*t6.*t7.*(t134-nl3.*uh2.*3.0).*(1.0./3.0);one.*t6.*t7.*(t138-nl3.*uh3.*3.0).*(1.0./3.0);one.*t6.*t7.*(t25+t26+nl3.*uh4.*4.0).*(-1.0./3.0);-one.*(t6.*t9.*(t27+t28+nl3.*t4.*(4.0./3.0)+nl1.*uh2.*uh4.*(1.0./3.0)+nl2.*uh3.*uh4.*(1.0./3.0))-t6.*t9.*t13.*(t72+t73+t74-nl3.*param1.*uh1.*uh5));zero;t24;zero;t14;one.*(t32-nl3.*param1.*t6.*t7.*t13.*uh2);zero;zero;t24;t18;one.*(t36-nl3.*param1.*t6.*t7.*t13.*uh3);zero;nl1.*one.*t5.*t6.*(-2.0./3.0);nl2.*one.*t5.*t6.*(-2.0./3.0);nl3.*one.*t5.*t6.*(4.0./3.0);-one.*(t6.*t9.*(t37+t38-nl3.*uh1.*uh4.*(4.0./3.0))+nl3.*param1.*t6.*t7.*t13.*uh4);zero;zero;zero;zero;nl3.*one.*param1.*t5.*t6.*t13];
end
if nargout > 2
    t139 = nl3.*uh2.*2.0;
    t140 = nl3.*uh3.*2.0;
    t141 = nl1.*uh2.*2.0;
    t142 = nl2.*uh3.*2.0;
    t143 = nl1.*u6.*3.0;
    t144 = nl2.*u11.*3.0;
    fh_uh = [-t10;t7.*(t11+t12+t39-t40-t41-t42+t43+t44+t45+t46-nl1.*uh1.*uh5.*2.0-param6.*uh1.*uh2.*2.0).*(-1.0./2.0)-t5.*(nl1.*uh5.*2.0-param6.*u2.*2.0+param6.*uh2.*2.0-nl1.*param1.*uh5.*2.0).*(1.0./2.0)+t6.*t7.*(nl1.*u7.*4.0+nl2.*u8.*3.0+nl3.*u9.*3.0-nl1.*u13.*2.0+nl2.*u12.*3.0-nl1.*u19.*2.0+nl3.*u17.*3.0).*(1.0./3.0)+t6.*t9.*t54.*(2.0./3.0);t7.*(t16+t17+t55-t56-t57-t58+t59+t60+t61+t62-nl2.*uh1.*uh5.*2.0-param6.*uh1.*uh3.*2.0).*(-1.0./2.0)-t5.*(nl2.*uh5.*2.0-param6.*u3.*2.0+param6.*uh3.*2.0-nl2.*param1.*uh5.*2.0).*(1.0./2.0)+t6.*t7.*(nl1.*u8.*3.0-nl2.*u7.*2.0+nl1.*u12.*3.0+nl2.*u13.*4.0+nl3.*u14.*3.0-nl2.*u19.*2.0+nl3.*u18.*3.0).*(1.0./3.0)+t6.*t9.*t70.*(2.0./3.0);t7.*(t27+t28+t71-t72-t73-t74+t75+t76+t77+t78-nl3.*uh1.*uh5.*2.0-param6.*uh1.*uh4.*2.0).*(-1.0./2.0)-t5.*(nl3.*uh5.*2.0-param6.*u4.*2.0+param6.*uh4.*2.0-nl3.*param1.*uh5.*2.0).*(1.0./2.0)+t6.*t7.*(nl1.*u9.*3.0-nl3.*u7.*2.0+nl2.*u14.*3.0-nl3.*u13.*2.0+nl1.*u17.*3.0+nl2.*u18.*3.0+nl3.*u19.*4.0).*(1.0./3.0)+t6.*t9.*t86.*(2.0./3.0);t6.*t9.*(nl1.*u7.*uh2.*(4.0./3.0)+nl1.*u8.*uh3-nl2.*u7.*uh3.*(2.0./3.0)+nl2.*u8.*uh2+nl1.*u9.*uh4-nl3.*u7.*uh4.*(2.0./3.0)+nl3.*u9.*uh2+nl1.*u12.*uh3-nl1.*u13.*uh2.*(2.0./3.0)+nl2.*u12.*uh2+nl2.*u13.*uh3.*(4.0./3.0)+nl2.*u14.*uh4-nl3.*u13.*uh4.*(2.0./3.0)+nl3.*u14.*uh3+nl1.*u17.*uh4-nl1.*u19.*uh2.*(2.0./3.0)+nl3.*u17.*uh2+nl2.*u18.*uh4-nl2.*u19.*uh3.*(2.0./3.0)+nl3.*u18.*uh3+nl3.*u19.*uh4.*(4.0./3.0)+nl1.*param3.*t2.*uh2.*(1.0./2.0)+nl1.*param3.*t3.*uh2.*(1.0./2.0)+nl1.*param3.*t4.*uh2.*(1.0./2.0)+nl2.*param3.*t2.*uh3.*(1.0./2.0)+nl2.*param3.*t3.*uh3.*(1.0./2.0)+nl2.*param3.*t4.*uh3.*(1.0./2.0)+nl3.*param3.*t2.*uh4.*(1.0./2.0)+nl3.*param3.*t3.*uh4.*(1.0./2.0)+nl3.*param3.*t4.*uh4.*(1.0./2.0)+param3.*param6.*t8.*u5.*3.0-param3.*param6.*t8.*uh5.*3.0-nl1.*param1.*param3.*t2.*uh2.*(1.0./2.0)-nl1.*param1.*param3.*t3.*uh2.*(1.0./2.0)-nl1.*param1.*param3.*t4.*uh2.*(1.0./2.0)-nl2.*param1.*param3.*t2.*uh3.*(1.0./2.0)-nl2.*param1.*param3.*t3.*uh3.*(1.0./2.0)-nl2.*param1.*param3.*t4.*uh3.*(1.0./2.0)-nl3.*param1.*param3.*t2.*uh4.*(1.0./2.0)-nl3.*param1.*param3.*t3.*uh4.*(1.0./2.0)-nl3.*param1.*param3.*t4.*uh4.*(1.0./2.0)+nl1.*param1.*param3.*uh1.*uh2.*uh5.*2.0+nl2.*param1.*param3.*uh1.*uh3.*uh5.*2.0+nl3.*param1.*param3.*uh1.*uh4.*uh5.*2.0)+t6.*t118.*t119.*3.0-t6.*t13.*t119.*t132.*3.0-t6.*t9.*t13.*(nl1.*param1.*u7.*uh2+nl1.*param1.*u6.*uh5+nl1.*param1.*u8.*uh3-nl1.*param1.*u10.*uh1.*2.0+nl1.*param1.*u9.*uh4+nl2.*param1.*u12.*uh2+nl2.*param1.*u11.*uh5+nl2.*param1.*u13.*uh3-nl2.*param1.*u15.*uh1.*2.0+nl2.*param1.*u14.*uh4+nl3.*param1.*u17.*uh2+nl3.*param1.*u16.*uh5+nl3.*param1.*u18.*uh3-nl3.*param1.*u20.*uh1.*2.0+nl3.*param1.*u19.*uh4);nl1.*one;t5.*(t136+t142+nl1.*uh2.*6.0-param6.*uh1.*2.0-nl1.*param1.*uh2.*2.0).*(1.0./2.0)-t6.*t7.*(t137+t144+nl1.*u6.*4.0).*(1.0./3.0);t5.*(t133+t135-nl2.*param1.*uh2.*2.0).*(1.0./2.0)+t6.*t7.*(nl2.*u6.*2.0-nl1.*u11.*3.0).*(1.0./3.0);t5.*(t134+t139-nl3.*param1.*uh2.*2.0).*(1.0./2.0)+t6.*t7.*(nl3.*u6.*2.0-nl1.*u16.*3.0).*(1.0./3.0);-t6.*t9.*(nl1.*u6.*uh2.*(8.0./3.0)-nl1.*u7.*uh1.*(4.0./3.0)+nl2.*u6.*uh3.*(1.0./3.0)-nl2.*u8.*uh1+nl3.*u6.*uh4.*(1.0./3.0)-nl3.*u9.*uh1+nl1.*u11.*uh3.*(1.0./3.0)+nl1.*u13.*uh1.*(2.0./3.0)+nl2.*u11.*uh2.*2.0-nl2.*u12.*uh1+nl1.*u16.*uh4.*(1.0./3.0)+nl1.*u19.*uh1.*(2.0./3.0)+nl3.*u16.*uh2.*2.0-nl3.*u17.*uh1-nl1.*param3.*t2.*uh1.*(3.0./2.0)-nl1.*param3.*t3.*uh1.*(1.0./2.0)-nl1.*param3.*t4.*uh1.*(1.0./2.0)+nl1.*param1.*param3.*t2.*uh1.*(3.0./2.0)+nl1.*param1.*param3.*t3.*uh1.*(1.0./2.0)+nl1.*param1.*param3.*t4.*uh1.*(1.0./2.0)-nl1.*param1.*param3.*t8.*uh5-nl2.*param3.*uh1.*uh2.*uh3-nl3.*param3.*uh1.*uh2.*uh4+nl2.*param1.*param3.*uh1.*uh2.*uh3+nl3.*param1.*param3.*uh1.*uh2.*uh4)+t6.*t9.*t13.*(nl1.*param1.*u6.*uh2.*2.0-nl1.*param1.*u7.*uh1+nl2.*param1.*u11.*uh2.*2.0-nl2.*param1.*u12.*uh1+nl3.*param1.*u16.*uh2.*2.0-nl3.*param1.*u17.*uh1);nl2.*one;t5.*(t133+t135-nl1.*param1.*uh3.*2.0).*(1.0./2.0)-t6.*t7.*(nl2.*u6.*3.0-nl1.*u11.*2.0).*(1.0./3.0);t5.*(t136+t141+nl2.*uh3.*6.0-param6.*uh1.*2.0-nl2.*param1.*uh3.*2.0).*(1.0./2.0)-t6.*t7.*(t137+t143+nl2.*u11.*4.0).*(1.0./3.0);t5.*(t138+t140-nl3.*param1.*uh3.*2.0).*(1.0./2.0)+t6.*t7.*(nl3.*u11.*2.0-nl2.*u16.*3.0).*(1.0./3.0);-t6.*t9.*(nl1.*u6.*uh3.*2.0-nl1.*u8.*uh1+nl2.*u6.*uh2.*(1.0./3.0)+nl2.*u7.*uh1.*(2.0./3.0)+nl1.*u11.*uh2.*(1.0./3.0)-nl1.*u12.*uh1+nl2.*u11.*uh3.*(8.0./3.0)-nl2.*u13.*uh1.*(4.0./3.0)+nl3.*u11.*uh4.*(1.0./3.0)-nl3.*u14.*uh1+nl2.*u16.*uh4.*(1.0./3.0)+nl2.*u19.*uh1.*(2.0./3.0)+nl3.*u16.*uh3.*2.0-nl3.*u18.*uh1-nl2.*param3.*t2.*uh1.*(1.0./2.0)-nl2.*param3.*t3.*uh1.*(3.0./2.0)-nl2.*param3.*t4.*uh1.*(1.0./2.0)+nl2.*param1.*param3.*t2.*uh1.*(1.0./2.0)+nl2.*param1.*param3.*t3.*uh1.*(3.0./2.0)+nl2.*param1.*param3.*t4.*uh1.*(1.0./2.0)-nl2.*param1.*param3.*t8.*uh5-nl1.*param3.*uh1.*uh2.*uh3-nl3.*param3.*uh1.*uh3.*uh4+nl1.*param1.*param3.*uh1.*uh2.*uh3+nl3.*param1.*param3.*uh1.*uh3.*uh4)+t6.*t9.*t13.*(nl1.*param1.*u6.*uh3.*2.0-nl1.*param1.*u8.*uh1+nl2.*param1.*u11.*uh3.*2.0-nl2.*param1.*u13.*uh1+nl3.*param1.*u16.*uh3.*2.0-nl3.*param1.*u18.*uh1);nl3.*one;t5.*(t134+t139-nl1.*param1.*uh4.*2.0).*(1.0./2.0)-t6.*t7.*(nl3.*u6.*3.0-nl1.*u16.*2.0).*(1.0./3.0);t5.*(t138+t140-nl2.*param1.*uh4.*2.0).*(1.0./2.0)-t6.*t7.*(nl3.*u11.*3.0-nl2.*u16.*2.0).*(1.0./3.0);t5.*(t141+t142+nl3.*uh4.*6.0-param6.*uh1.*2.0-nl3.*param1.*uh4.*2.0).*(1.0./2.0)-t6.*t7.*(t143+t144+nl3.*u16.*4.0).*(1.0./3.0);-t6.*t9.*(nl1.*u6.*uh4.*2.0-nl1.*u9.*uh1+nl3.*u6.*uh2.*(1.0./3.0)+nl3.*u7.*uh1.*(2.0./3.0)+nl2.*u11.*uh4.*2.0-nl2.*u14.*uh1+nl3.*u11.*uh3.*(1.0./3.0)+nl3.*u13.*uh1.*(2.0./3.0)+nl1.*u16.*uh2.*(1.0./3.0)-nl1.*u17.*uh1+nl2.*u16.*uh3.*(1.0./3.0)-nl2.*u18.*uh1+nl3.*u16.*uh4.*(8.0./3.0)-nl3.*u19.*uh1.*(4.0./3.0)-nl3.*param3.*t2.*uh1.*(1.0./2.0)-nl3.*param3.*t3.*uh1.*(1.0./2.0)-nl3.*param3.*t4.*uh1.*(3.0./2.0)+nl3.*param1.*param3.*t2.*uh1.*(1.0./2.0)+nl3.*param1.*param3.*t3.*uh1.*(1.0./2.0)+nl3.*param1.*param3.*t4.*uh1.*(3.0./2.0)-nl3.*param1.*param3.*t8.*uh5-nl1.*param3.*uh1.*uh2.*uh4-nl2.*param3.*uh1.*uh3.*uh4+nl1.*param1.*param3.*uh1.*uh2.*uh4+nl2.*param1.*param3.*uh1.*uh3.*uh4)+t6.*t9.*t13.*(nl1.*param1.*u6.*uh4.*2.0-nl1.*param1.*u9.*uh1+nl2.*param1.*u11.*uh4.*2.0-nl2.*param1.*u14.*uh1+nl3.*param1.*u16.*uh4.*2.0-nl3.*param1.*u19.*uh1);zero;one.*t5.*(nl1.*uh1.*2.0-nl1.*param1.*uh1.*2.0).*(-1.0./2.0);one.*t5.*(nl2.*uh1.*2.0-nl2.*param1.*uh1.*2.0).*(-1.0./2.0);one.*t5.*(nl3.*uh1.*2.0-nl3.*param1.*uh1.*2.0).*(-1.0./2.0);t6.*t9.*(-param3.*param6.*t8.*uh1+nl1.*param1.*param3.*t8.*uh2+nl2.*param1.*param3.*t8.*uh3+nl3.*param1.*param3.*t8.*uh4)-t6.*t9.*t13.*(nl1.*param1.*u6.*uh1+nl2.*param1.*u11.*uh1+nl3.*param1.*u16.*uh1)];
end
fh = reshape(fh,ng,nch);
fh_udg = reshape(fh_udg,ng,nch,nc);
fh_uh = reshape(fh_uh,ng,nch,nch);
