void flux_mhd3d(double *f, double *f_udg, double *pg, double *udg, double *param, double time, int ng, int nc, int ncu, int nd, int ncd)
{
	double param1 = param[0];
	double param2 = param[1];

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double x3 = pg[2*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];

		double t2 = u2*u2;
		double t3 = 1.0/(u1*u1);
		double t4 = u6*u6;
		double t5 = t4*(1.0/2.0);
		double t6 = u7*u7;
		double t7 = t6*(1.0/2.0);
		double t8 = u8*u8;
		double t9 = t8*(1.0/2.0);
		double t10 = 1.0/u1;
		double t11 = param1-1.0;
		double t12 = t2*t3*(1.0/2.0);
		double t13 = u3*u3;
		double t14 = t3*t13*(1.0/2.0);
		double t15 = u4*u4;
		double t16 = t3*t15*(1.0/2.0);
		double t17 = t12+t14+t16;
		double t18 = t17*u1;
		double t19 = t5+t7+t9+t18-u5;
		double t20 = t10*u2*u3;
		double t21 = t20-u6*u7;
		double t22 = t5+t7+t9;
		double t23 = t10*t22;
		double t24 = t10*u5;
		double t36 = t10*t11*t19;
		double t25 = t23+t24-t36;
		double t26 = t10*u2*u6;
		double t27 = t10*u3*u7;
		double t28 = t10*u4*u8;
		double t29 = t26+t27+t28;
		double t30 = t10*u3*u6;
		double t31 = param2*param2;
		double t32 = t10*u2*u4;
		double t33 = t32-u6*u8;
		double t34 = t10*u3*u4;
		double t35 = t34-u7*u8;
		double t37 = t10*u4*u6;
		double t38 = t10*u4*u7;
		f[0*ng+i] = u2;
		f[1*ng+i] = -t5+t7+t9+t2*t10-t11*t19;
		f[2*ng+i] = t21;
		f[3*ng+i] = t33;
		f[4*ng+i] = t25*u2-t29*u6;
		f[5*ng+i] = u9;
		f[6*ng+i] = t30-t10*u2*u7;
		f[7*ng+i] = t37-t10*u2*u8;
		f[8*ng+i] = t31*u6;
		f[9*ng+i] = u3;
		f[10*ng+i] = t21;
		f[11*ng+i] = t5-t7+t9+t10*t13-t11*t19;
		f[12*ng+i] = t35;
		f[13*ng+i] = t25*u3-t29*u7;
		f[14*ng+i] = -t30+t10*u2*u7;
		f[15*ng+i] = u9;
		f[16*ng+i] = t38-t10*u3*u8;
		f[17*ng+i] = t31*u7;
		f[18*ng+i] = u4;
		f[19*ng+i] = t33;
		f[20*ng+i] = t35;
		f[21*ng+i] = t5+t7-t9+t10*t15-t11*t19;
		f[22*ng+i] = t25*u4-t29*u8;
		f[23*ng+i] = -t37+t10*u2*u8;
		f[24*ng+i] = -t38+t10*u3*u8;
		f[25*ng+i] = u9;
		f[26*ng+i] = t31*u8;

	}

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double x3 = pg[2*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];

		double t2 = 1.0/(u1*u1);
		double t3 = u2*u2;
		double t4 = 1.0/(u1*u1*u1);
		double t5 = u3*u3;
		double t6 = u4*u4;
		double t7 = param1-1.0;
		double t8 = t2*t3*(1.0/2.0);
		double t9 = t2*t5*(1.0/2.0);
		double t10 = t2*t6*(1.0/2.0);
		double t11 = u6*u6;
		double t12 = t11*(1.0/2.0);
		double t13 = u7*u7;
		double t14 = t13*(1.0/2.0);
		double t15 = u8*u8;
		double t16 = t15*(1.0/2.0);
		double t17 = t3*t4;
		double t18 = t4*t5;
		double t19 = t4*t6;
		double t20 = t17+t18+t19;
		double t22 = t20*u1;
		double t21 = t8+t9+t10-t22;
		double t23 = t2*u2*u6;
		double t24 = t2*u3*u7;
		double t25 = t2*u4*u8;
		double t26 = t23+t24+t25;
		double t27 = t12+t14+t16;
		double t28 = t2*t27;
		double t29 = t2*u5;
		double t30 = t8+t9+t10;
		double t31 = t30*u1;
		double t32 = t12+t14+t16+t31-u5;
		double t33 = 1.0/u1;
		double t34 = t7*t21*t33;
		double t37 = t2*t7*t32;
		double t35 = t28+t29+t34-t37;
		double t36 = t2*u2*u7;
		double t38 = t2*u2*u8;
		double t39 = t2*u3*u8;
		double t40 = t33*u3;
		double t41 = t33*u4;
		double t42 = -t33*u6*u7-t2*t7*u2*u3;
		double t43 = t33*u2;
		double t44 = t27*t33;
		double t45 = t33*u5;
		double t46 = t33*u6;
		double t47 = t33*u8;
		double t48 = -t33*u6*u8-t2*t7*u2*u4;
		double t49 = -t33*u7*u8-t2*t7*u3*u4;
		double t50 = t33*u7;
		double t51 = t7*t33;
		double t52 = t33+t51;
		double t55 = t7*t33*u6;
		double t53 = t46-t55;
		double t54 = u6-t7*u6;
		double t59 = t7*t33*u7;
		double t56 = t50-t59;
		double t57 = param2*param2;
		double t58 = u7-t7*u7;
		double t62 = t7*u8;
		double t60 = -t62+u8;
		double t63 = t7*t33*u8;
		double t61 = t47-t63;
		f_udg[0*ng+i] = 0.0;
		f_udg[1*ng+i] = -t2*t3-t7*t21;
		f_udg[2*ng+i] = -t2*u2*u3;
		f_udg[3*ng+i] = -t2*u2*u4;
		f_udg[4*ng+i] = t26*u6-t35*u2;
		f_udg[5*ng+i] = 0.0;
		f_udg[6*ng+i] = t36-t2*u3*u6;
		f_udg[7*ng+i] = t38-t2*u4*u6;
		f_udg[8*ng+i] = 0.0;
		f_udg[9*ng+i] = 0.0;
		f_udg[10*ng+i] = -t2*u2*u3;
		f_udg[11*ng+i] = -t2*t5-t7*t21;
		f_udg[12*ng+i] = -t2*u3*u4;
		f_udg[13*ng+i] = t26*u7-t35*u3;
		f_udg[14*ng+i] = -t36+t2*u3*u6;
		f_udg[15*ng+i] = 0.0;
		f_udg[16*ng+i] = t39-t2*u4*u7;
		f_udg[17*ng+i] = 0.0;
		f_udg[18*ng+i] = 0.0;
		f_udg[19*ng+i] = -t2*u2*u4;
		f_udg[20*ng+i] = -t2*u3*u4;
		f_udg[21*ng+i] = -t2*t6-t7*t21;
		f_udg[22*ng+i] = t26*u8-t35*u4;
		f_udg[23*ng+i] = -t38+t2*u4*u6;
		f_udg[24*ng+i] = -t39+t2*u4*u7;
		f_udg[25*ng+i] = 0.0;
		f_udg[26*ng+i] = 0.0;
		f_udg[27*ng+i] = 1.0;
		f_udg[28*ng+i] = t33*u2*2.0-t7*t33*u2;
		f_udg[29*ng+i] = t40;
		f_udg[30*ng+i] = t41;
		f_udg[31*ng+i] = t44+t45-t11*t33-t2*t3*t7-t7*t32*t33;
		f_udg[32*ng+i] = 0.0;
		f_udg[33*ng+i] = -t33*u7;
		f_udg[34*ng+i] = -t33*u8;
		f_udg[35*ng+i] = 0.0;
		f_udg[36*ng+i] = 0.0;
		f_udg[37*ng+i] = t40;
		f_udg[38*ng+i] = -t7*t33*u2;
		f_udg[39*ng+i] = 0.0;
		f_udg[40*ng+i] = t42;
		f_udg[41*ng+i] = t50;
		f_udg[42*ng+i] = 0.0;
		f_udg[43*ng+i] = 0.0;
		f_udg[44*ng+i] = 0.0;
		f_udg[45*ng+i] = 0.0;
		f_udg[46*ng+i] = t41;
		f_udg[47*ng+i] = 0.0;
		f_udg[48*ng+i] = -t7*t33*u2;
		f_udg[49*ng+i] = t48;
		f_udg[50*ng+i] = t47;
		f_udg[51*ng+i] = 0.0;
		f_udg[52*ng+i] = 0.0;
		f_udg[53*ng+i] = 0.0;
		f_udg[54*ng+i] = 0.0;
		f_udg[55*ng+i] = -t7*t33*u3;
		f_udg[56*ng+i] = t43;
		f_udg[57*ng+i] = 0.0;
		f_udg[58*ng+i] = t42;
		f_udg[59*ng+i] = 0.0;
		f_udg[60*ng+i] = t46;
		f_udg[61*ng+i] = 0.0;
		f_udg[62*ng+i] = 0.0;
		f_udg[63*ng+i] = 1.0;
		f_udg[64*ng+i] = t43;
		f_udg[65*ng+i] = t33*u3*2.0-t7*t33*u3;
		f_udg[66*ng+i] = t41;
		f_udg[67*ng+i] = t44+t45-t13*t33-t2*t5*t7-t7*t32*t33;
		f_udg[68*ng+i] = -t46;
		f_udg[69*ng+i] = 0.0;
		f_udg[70*ng+i] = -t47;
		f_udg[71*ng+i] = 0.0;
		f_udg[72*ng+i] = 0.0;
		f_udg[73*ng+i] = 0.0;
		f_udg[74*ng+i] = t41;
		f_udg[75*ng+i] = -t7*t33*u3;
		f_udg[76*ng+i] = t49;
		f_udg[77*ng+i] = 0.0;
		f_udg[78*ng+i] = t47;
		f_udg[79*ng+i] = 0.0;
		f_udg[80*ng+i] = 0.0;
		f_udg[81*ng+i] = 0.0;
		f_udg[82*ng+i] = -t7*t33*u4;
		f_udg[83*ng+i] = 0.0;
		f_udg[84*ng+i] = t43;
		f_udg[85*ng+i] = t48;
		f_udg[86*ng+i] = 0.0;
		f_udg[87*ng+i] = 0.0;
		f_udg[88*ng+i] = t46;
		f_udg[89*ng+i] = 0.0;
		f_udg[90*ng+i] = 0.0;
		f_udg[91*ng+i] = 0.0;
		f_udg[92*ng+i] = -t7*t33*u4;
		f_udg[93*ng+i] = t40;
		f_udg[94*ng+i] = t49;
		f_udg[95*ng+i] = 0.0;
		f_udg[96*ng+i] = 0.0;
		f_udg[97*ng+i] = t50;
		f_udg[98*ng+i] = 0.0;
		f_udg[99*ng+i] = 1.0;
		f_udg[100*ng+i] = t43;
		f_udg[101*ng+i] = t40;
		f_udg[102*ng+i] = t33*u4*2.0-t7*t33*u4;
		f_udg[103*ng+i] = t44+t45-t15*t33-t2*t6*t7-t7*t32*t33;
		f_udg[104*ng+i] = -t46;
		f_udg[105*ng+i] = -t50;
		f_udg[106*ng+i] = 0.0;
		f_udg[107*ng+i] = 0.0;
		f_udg[108*ng+i] = 0.0;
		f_udg[109*ng+i] = t7;
		f_udg[110*ng+i] = 0.0;
		f_udg[111*ng+i] = 0.0;
		f_udg[112*ng+i] = t52*u2;
		f_udg[113*ng+i] = 0.0;
		f_udg[114*ng+i] = 0.0;
		f_udg[115*ng+i] = 0.0;
		f_udg[116*ng+i] = 0.0;
		f_udg[117*ng+i] = 0.0;
		f_udg[118*ng+i] = 0.0;
		f_udg[119*ng+i] = t7;
		f_udg[120*ng+i] = 0.0;
		f_udg[121*ng+i] = t52*u3;
		f_udg[122*ng+i] = 0.0;
		f_udg[123*ng+i] = 0.0;
		f_udg[124*ng+i] = 0.0;
		f_udg[125*ng+i] = 0.0;
		f_udg[126*ng+i] = 0.0;
		f_udg[127*ng+i] = 0.0;
		f_udg[128*ng+i] = 0.0;
		f_udg[129*ng+i] = t7;
		f_udg[130*ng+i] = t52*u4;
		f_udg[131*ng+i] = 0.0;
		f_udg[132*ng+i] = 0.0;
		f_udg[133*ng+i] = 0.0;
		f_udg[134*ng+i] = 0.0;
		f_udg[135*ng+i] = 0.0;
		f_udg[136*ng+i] = -u6-t7*u6;
		f_udg[137*ng+i] = -u7;
		f_udg[138*ng+i] = -u8;
		f_udg[139*ng+i] = t53*u2-t33*u2*u6*2.0-t33*u3*u7-t33*u4*u8;
		f_udg[140*ng+i] = 0.0;
		f_udg[141*ng+i] = t40;
		f_udg[142*ng+i] = t41;
		f_udg[143*ng+i] = t57;
		f_udg[144*ng+i] = 0.0;
		f_udg[145*ng+i] = -u7;
		f_udg[146*ng+i] = t54;
		f_udg[147*ng+i] = 0.0;
		f_udg[148*ng+i] = t53*u3-t33*u2*u7;
		f_udg[149*ng+i] = -t40;
		f_udg[150*ng+i] = 0.0;
		f_udg[151*ng+i] = 0.0;
		f_udg[152*ng+i] = 0.0;
		f_udg[153*ng+i] = 0.0;
		f_udg[154*ng+i] = -u8;
		f_udg[155*ng+i] = 0.0;
		f_udg[156*ng+i] = t54;
		f_udg[157*ng+i] = t53*u4-t33*u2*u8;
		f_udg[158*ng+i] = -t41;
		f_udg[159*ng+i] = 0.0;
		f_udg[160*ng+i] = 0.0;
		f_udg[161*ng+i] = 0.0;
		f_udg[162*ng+i] = 0.0;
		f_udg[163*ng+i] = t58;
		f_udg[164*ng+i] = -u6;
		f_udg[165*ng+i] = 0.0;
		f_udg[166*ng+i] = t56*u2-t33*u3*u6;
		f_udg[167*ng+i] = 0.0;
		f_udg[168*ng+i] = -t43;
		f_udg[169*ng+i] = 0.0;
		f_udg[170*ng+i] = 0.0;
		f_udg[171*ng+i] = 0.0;
		f_udg[172*ng+i] = -u6;
		f_udg[173*ng+i] = -u7-t7*u7;
		f_udg[174*ng+i] = -u8;
		f_udg[175*ng+i] = t56*u3-t33*u2*u6-t33*u3*u7*2.0-t33*u4*u8;
		f_udg[176*ng+i] = t43;
		f_udg[177*ng+i] = 0.0;
		f_udg[178*ng+i] = t41;
		f_udg[179*ng+i] = t57;
		f_udg[180*ng+i] = 0.0;
		f_udg[181*ng+i] = 0.0;
		f_udg[182*ng+i] = -u8;
		f_udg[183*ng+i] = t58;
		f_udg[184*ng+i] = t56*u4-t33*u3*u8;
		f_udg[185*ng+i] = 0.0;
		f_udg[186*ng+i] = -t41;
		f_udg[187*ng+i] = 0.0;
		f_udg[188*ng+i] = 0.0;
		f_udg[189*ng+i] = 0.0;
		f_udg[190*ng+i] = t60;
		f_udg[191*ng+i] = 0.0;
		f_udg[192*ng+i] = -u6;
		f_udg[193*ng+i] = t61*u2-t33*u4*u6;
		f_udg[194*ng+i] = 0.0;
		f_udg[195*ng+i] = 0.0;
		f_udg[196*ng+i] = -t43;
		f_udg[197*ng+i] = 0.0;
		f_udg[198*ng+i] = 0.0;
		f_udg[199*ng+i] = 0.0;
		f_udg[200*ng+i] = t60;
		f_udg[201*ng+i] = -u7;
		f_udg[202*ng+i] = t61*u3-t33*u4*u7;
		f_udg[203*ng+i] = 0.0;
		f_udg[204*ng+i] = 0.0;
		f_udg[205*ng+i] = -t40;
		f_udg[206*ng+i] = 0.0;
		f_udg[207*ng+i] = 0.0;
		f_udg[208*ng+i] = -u6;
		f_udg[209*ng+i] = -u7;
		f_udg[210*ng+i] = -t62-u8;
		f_udg[211*ng+i] = t61*u4-t33*u2*u6-t33*u3*u7-t33*u4*u8*2.0;
		f_udg[212*ng+i] = t43;
		f_udg[213*ng+i] = t40;
		f_udg[214*ng+i] = 0.0;
		f_udg[215*ng+i] = t57;
		f_udg[216*ng+i] = 0.0;
		f_udg[217*ng+i] = 0.0;
		f_udg[218*ng+i] = 0.0;
		f_udg[219*ng+i] = 0.0;
		f_udg[220*ng+i] = 0.0;
		f_udg[221*ng+i] = 1.0;
		f_udg[222*ng+i] = 0.0;
		f_udg[223*ng+i] = 0.0;
		f_udg[224*ng+i] = 0.0;
		f_udg[225*ng+i] = 0.0;
		f_udg[226*ng+i] = 0.0;
		f_udg[227*ng+i] = 0.0;
		f_udg[228*ng+i] = 0.0;
		f_udg[229*ng+i] = 0.0;
		f_udg[230*ng+i] = 0.0;
		f_udg[231*ng+i] = 1.0;
		f_udg[232*ng+i] = 0.0;
		f_udg[233*ng+i] = 0.0;
		f_udg[234*ng+i] = 0.0;
		f_udg[235*ng+i] = 0.0;
		f_udg[236*ng+i] = 0.0;
		f_udg[237*ng+i] = 0.0;
		f_udg[238*ng+i] = 0.0;
		f_udg[239*ng+i] = 0.0;
		f_udg[240*ng+i] = 0.0;
		f_udg[241*ng+i] = 1.0;

	}
}

void fluxonly_mhd3d(double *f, double *pg, double *udg, double *param, double time, int ng, int nc, int ncu, int nd, int ncd)
{
	double param1 = param[0];
	double param2 = param[1];

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double x3 = pg[2*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];
		double u8 = udg[7*ng+i];
		double u9 = udg[8*ng+i];

		double t2 = u2*u2;
		double t3 = 1.0/(u1*u1);
		double t4 = u6*u6;
		double t5 = t4*(1.0/2.0);
		double t6 = u7*u7;
		double t7 = t6*(1.0/2.0);
		double t8 = u8*u8;
		double t9 = t8*(1.0/2.0);
		double t10 = 1.0/u1;
		double t11 = param1-1.0;
		double t12 = t2*t3*(1.0/2.0);
		double t13 = u3*u3;
		double t14 = t3*t13*(1.0/2.0);
		double t15 = u4*u4;
		double t16 = t3*t15*(1.0/2.0);
		double t17 = t12+t14+t16;
		double t18 = t17*u1;
		double t19 = t5+t7+t9+t18-u5;
		double t20 = t10*u2*u3;
		double t21 = t20-u6*u7;
		double t22 = t5+t7+t9;
		double t23 = t10*t22;
		double t24 = t10*u5;
		double t36 = t10*t11*t19;
		double t25 = t23+t24-t36;
		double t26 = t10*u2*u6;
		double t27 = t10*u3*u7;
		double t28 = t10*u4*u8;
		double t29 = t26+t27+t28;
		double t30 = t10*u3*u6;
		double t31 = param2*param2;
		double t32 = t10*u2*u4;
		double t33 = t32-u6*u8;
		double t34 = t10*u3*u4;
		double t35 = t34-u7*u8;
		double t37 = t10*u4*u6;
		double t38 = t10*u4*u7;
		f[0*ng+i] = u2;
		f[1*ng+i] = -t5+t7+t9+t2*t10-t11*t19;
		f[2*ng+i] = t21;
		f[3*ng+i] = t33;
		f[4*ng+i] = t25*u2-t29*u6;
		f[5*ng+i] = u9;
		f[6*ng+i] = t30-t10*u2*u7;
		f[7*ng+i] = t37-t10*u2*u8;
		f[8*ng+i] = t31*u6;
		f[9*ng+i] = u3;
		f[10*ng+i] = t21;
		f[11*ng+i] = t5-t7+t9+t10*t13-t11*t19;
		f[12*ng+i] = t35;
		f[13*ng+i] = t25*u3-t29*u7;
		f[14*ng+i] = -t30+t10*u2*u7;
		f[15*ng+i] = u9;
		f[16*ng+i] = t38-t10*u3*u8;
		f[17*ng+i] = t31*u7;
		f[18*ng+i] = u4;
		f[19*ng+i] = t33;
		f[20*ng+i] = t35;
		f[21*ng+i] = t5+t7-t9+t10*t15-t11*t19;
		f[22*ng+i] = t25*u4-t29*u8;
		f[23*ng+i] = -t37+t10*u2*u8;
		f[24*ng+i] = -t38+t10*u3*u8;
		f[25*ng+i] = u9;
		f[26*ng+i] = t31*u8;

	}
}

