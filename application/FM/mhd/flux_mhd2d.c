void flux_mhd2d(double *f, double *f_udg, double *pg, double *udg, double *param, double time, int ng, int nc, int ncu, int nd, int ncd)
{
	double param1 = param[0];
	double param2 = param[1];

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];

		double t2 = u2*u2;
		double t3 = 1.0/(u1*u1);
		double t4 = u5*u5;
		double t5 = t4*(1.0/2.0);
		double t6 = u6*u6;
		double t7 = t6*(1.0/2.0);
		double t8 = 1.0/u1;
		double t9 = param1-1.0;
		double t10 = t2*t3*(1.0/2.0);
		double t11 = u3*u3;
		double t12 = t3*t11*(1.0/2.0);
		double t13 = t10+t12;
		double t14 = t13*u1;
		double t15 = t5+t7+t14-u4;
		double t16 = t8*u2*u3;
		double t17 = t16-u5*u6;
		double t18 = t8*u2*u5;
		double t19 = t8*u3*u6;
		double t20 = t18+t19;
		double t21 = t8*u4;
		double t22 = t5+t7;
		double t23 = t8*t22;
		double t24 = t21+t23-t8*t9*t15;
		double t25 = t8*u2*u6;
		double t26 = param2*param2;
		f[0*ng+i] = u2;
		f[1*ng+i] = -t5+t7+t2*t8-t9*t15;
		f[2*ng+i] = t17;
		f[3*ng+i] = -t20*u5+t24*u2;
		f[4*ng+i] = u7;
		f[5*ng+i] = t25-t8*u3*u5;
		f[6*ng+i] = t26*u5;
		f[7*ng+i] = u3;
		f[8*ng+i] = t17;
		f[9*ng+i] = t5-t7+t8*t11-t9*t15;
		f[10*ng+i] = -t20*u6+t24*u3;
		f[11*ng+i] = -t25+t8*u3*u5;
		f[12*ng+i] = u7;
		f[13*ng+i] = t26*u6;

	}

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];

		double t2 = 1.0/(u1*u1);
		double t3 = u2*u2;
		double t4 = 1.0/(u1*u1*u1);
		double t5 = u3*u3;
		double t6 = param1-1.0;
		double t7 = t2*t3*(1.0/2.0);
		double t8 = t2*t5*(1.0/2.0);
		double t9 = t3*t4;
		double t10 = t4*t5;
		double t11 = t9+t10;
		double t17 = t11*u1;
		double t12 = t7+t8-t17;
		double t13 = u5*u5;
		double t14 = t13*(1.0/2.0);
		double t15 = u6*u6;
		double t16 = t15*(1.0/2.0);
		double t18 = t2*u2*u5;
		double t19 = t2*u3*u6;
		double t20 = t18+t19;
		double t21 = t2*u4;
		double t22 = t14+t16;
		double t23 = t2*t22;
		double t24 = 1.0/u1;
		double t25 = t6*t12*t24;
		double t26 = t7+t8;
		double t27 = t26*u1;
		double t28 = t14+t16+t27-u4;
		double t29 = t21+t23+t25-t2*t6*t28;
		double t30 = t2*u3*u5;
		double t31 = t24*u3;
		double t32 = t24*u6;
		double t33 = -t24*u5*u6-t2*t6*u2*u3;
		double t34 = t24*u2;
		double t35 = t24*u4;
		double t36 = t22*t24;
		double t37 = t6*t24;
		double t38 = t24+t37;
		double t39 = t24*u5;
		double t40 = t39-t6*t24*u5;
		double t41 = t32-t6*t24*u6;
		double t42 = param2*param2;
		f_udg[0*ng+i] = 0.0;
		f_udg[1*ng+i] = -t2*t3-t6*t12;
		f_udg[2*ng+i] = -t2*u2*u3;
		f_udg[3*ng+i] = t20*u5-t29*u2;
		f_udg[4*ng+i] = 0.0;
		f_udg[5*ng+i] = t30-t2*u2*u6;
		f_udg[6*ng+i] = 0.0;
		f_udg[7*ng+i] = 0.0;
		f_udg[8*ng+i] = -t2*u2*u3;
		f_udg[9*ng+i] = -t2*t5-t6*t12;
		f_udg[10*ng+i] = t20*u6-t29*u3;
		f_udg[11*ng+i] = -t30+t2*u2*u6;
		f_udg[12*ng+i] = 0.0;
		f_udg[13*ng+i] = 0.0;
		f_udg[14*ng+i] = 1.0;
		f_udg[15*ng+i] = t24*u2*2.0-t6*t24*u2;
		f_udg[16*ng+i] = t31;
		f_udg[17*ng+i] = t35+t36-t13*t24-t2*t3*t6-t6*t24*t28;
		f_udg[18*ng+i] = 0.0;
		f_udg[19*ng+i] = t32;
		f_udg[20*ng+i] = 0.0;
		f_udg[21*ng+i] = 0.0;
		f_udg[22*ng+i] = t31;
		f_udg[23*ng+i] = -t6*t24*u2;
		f_udg[24*ng+i] = t33;
		f_udg[25*ng+i] = -t32;
		f_udg[26*ng+i] = 0.0;
		f_udg[27*ng+i] = 0.0;
		f_udg[28*ng+i] = 0.0;
		f_udg[29*ng+i] = -t6*t24*u3;
		f_udg[30*ng+i] = t34;
		f_udg[31*ng+i] = t33;
		f_udg[32*ng+i] = 0.0;
		f_udg[33*ng+i] = -t24*u5;
		f_udg[34*ng+i] = 0.0;
		f_udg[35*ng+i] = 1.0;
		f_udg[36*ng+i] = t34;
		f_udg[37*ng+i] = t24*u3*2.0-t6*t24*u3;
		f_udg[38*ng+i] = t35+t36-t15*t24-t2*t5*t6-t6*t24*t28;
		f_udg[39*ng+i] = t39;
		f_udg[40*ng+i] = 0.0;
		f_udg[41*ng+i] = 0.0;
		f_udg[42*ng+i] = 0.0;
		f_udg[43*ng+i] = t6;
		f_udg[44*ng+i] = 0.0;
		f_udg[45*ng+i] = t38*u2;
		f_udg[46*ng+i] = 0.0;
		f_udg[47*ng+i] = 0.0;
		f_udg[48*ng+i] = 0.0;
		f_udg[49*ng+i] = 0.0;
		f_udg[50*ng+i] = 0.0;
		f_udg[51*ng+i] = t6;
		f_udg[52*ng+i] = t38*u3;
		f_udg[53*ng+i] = 0.0;
		f_udg[54*ng+i] = 0.0;
		f_udg[55*ng+i] = 0.0;
		f_udg[56*ng+i] = 0.0;
		f_udg[57*ng+i] = -u5-t6*u5;
		f_udg[58*ng+i] = -u6;
		f_udg[59*ng+i] = t40*u2-t24*u2*u5*2.0-t24*u3*u6;
		f_udg[60*ng+i] = 0.0;
		f_udg[61*ng+i] = -t31;
		f_udg[62*ng+i] = t42;
		f_udg[63*ng+i] = 0.0;
		f_udg[64*ng+i] = -u6;
		f_udg[65*ng+i] = u5-t6*u5;
		f_udg[66*ng+i] = t40*u3-t24*u2*u6;
		f_udg[67*ng+i] = t31;
		f_udg[68*ng+i] = 0.0;
		f_udg[69*ng+i] = 0.0;
		f_udg[70*ng+i] = 0.0;
		f_udg[71*ng+i] = u6-t6*u6;
		f_udg[72*ng+i] = -u5;
		f_udg[73*ng+i] = t41*u2-t24*u3*u5;
		f_udg[74*ng+i] = 0.0;
		f_udg[75*ng+i] = t34;
		f_udg[76*ng+i] = 0.0;
		f_udg[77*ng+i] = 0.0;
		f_udg[78*ng+i] = -u5;
		f_udg[79*ng+i] = -u6-t6*u6;
		f_udg[80*ng+i] = t41*u3-t24*u2*u5-t24*u3*u6*2.0;
		f_udg[81*ng+i] = -t34;
		f_udg[82*ng+i] = 0.0;
		f_udg[83*ng+i] = t42;
		f_udg[84*ng+i] = 0.0;
		f_udg[85*ng+i] = 0.0;
		f_udg[86*ng+i] = 0.0;
		f_udg[87*ng+i] = 0.0;
		f_udg[88*ng+i] = 1.0;
		f_udg[89*ng+i] = 0.0;
		f_udg[90*ng+i] = 0.0;
		f_udg[91*ng+i] = 0.0;
		f_udg[92*ng+i] = 0.0;
		f_udg[93*ng+i] = 0.0;
		f_udg[94*ng+i] = 0.0;
		f_udg[95*ng+i] = 0.0;
		f_udg[96*ng+i] = 1.0;

	}
}

void fluxonly_mhd2d(double *f, double *pg, double *udg, double *param, double time, int ng, int nc, int ncu, int nd, int ncd)
{
	double param1 = param[0];
	double param2 = param[1];

	for (int i = 0; i <ng; i++) {
		double x1 = pg[0*ng+i];
		double x2 = pg[1*ng+i];
		double u1 = udg[0*ng+i];
		double u2 = udg[1*ng+i];
		double u3 = udg[2*ng+i];
		double u4 = udg[3*ng+i];
		double u5 = udg[4*ng+i];
		double u6 = udg[5*ng+i];
		double u7 = udg[6*ng+i];

		double t2 = u2*u2;
		double t3 = 1.0/(u1*u1);
		double t4 = u5*u5;
		double t5 = t4*(1.0/2.0);
		double t6 = u6*u6;
		double t7 = t6*(1.0/2.0);
		double t8 = 1.0/u1;
		double t9 = param1-1.0;
		double t10 = t2*t3*(1.0/2.0);
		double t11 = u3*u3;
		double t12 = t3*t11*(1.0/2.0);
		double t13 = t10+t12;
		double t14 = t13*u1;
		double t15 = t5+t7+t14-u4;
		double t16 = t8*u2*u3;
		double t17 = t16-u5*u6;
		double t18 = t8*u2*u5;
		double t19 = t8*u3*u6;
		double t20 = t18+t19;
		double t21 = t8*u4;
		double t22 = t5+t7;
		double t23 = t8*t22;
		double t24 = t21+t23-t8*t9*t15;
		double t25 = t8*u2*u6;
		double t26 = param2*param2;
		f[0*ng+i] = u2;
		f[1*ng+i] = -t5+t7+t2*t8-t9*t15;
		f[2*ng+i] = t17;
		f[3*ng+i] = -t20*u5+t24*u2;
		f[4*ng+i] = u7;
		f[5*ng+i] = t25-t8*u3*u5;
		f[6*ng+i] = t26*u5;
		f[7*ng+i] = u3;
		f[8*ng+i] = t17;
		f[9*ng+i] = t5-t7+t8*t11-t9*t15;
		f[10*ng+i] = -t20*u6+t24*u3;
		f[11*ng+i] = -t25+t8*u3*u5;
		f[12*ng+i] = u7;
		f[13*ng+i] = t26*u6;

	}
}

